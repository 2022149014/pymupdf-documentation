<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF is a high-performance Python library for data extraction, analysis, conversion &amp; manipulation of PDF (and other) documents." name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="About these documents" href="about.html" /><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="DocumentWriter" href="document-writer-class.html" /><link rel="prev" title="DisplayList" href="displaylist.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Document - PyMuPDF 1.25.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=74643500" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.3 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.3 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">Features Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#performance">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#license-and-copyright">License and Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">The Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF, LLM &amp; RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">Opening Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">Drawing and Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">Stories</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">Journalling</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">Multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - Optical Character Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">Optional Content Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">Low-Level Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">Common Issues and their Solutions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="module.html">Command line interface</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="classes.html">Classes</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">Operator Algebra for Geometry Objects</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">Low Level Functions and Classes</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Low Level Functions and Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">Working together: DisplayList and TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">Constants and Enumerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">Color Database</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app1.html">Appendix 1: Details on Text Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">Appendix 2: Considerations on Embedded Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">Appendix 3: Assorted Technical Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">Appendix 4: Performance Comparison Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">Deprecated Names</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/document.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <style>

    #languageToggle {
        width:25%;
        margin:8px 10px 0;
    }

    #button-select-en {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 10px 0 0 10px;
        font-size: 14px;
    }

    #button-select-ja {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 0px 10px 10px 0;
        border-left: 0;
        font-size: 14px;
    }

    #button-select-en , #button-select-ja, #button-select-en:hover , #button-select-ja:hover  {
        color: #fff;
        text-decoration: none;
    }

    /* small screens */
    @media all and (max-width : 768px)  {
        #languageToggle {
            width:50%;
        }
    }

    @media all and (max-width : 400px)  {
        #languageToggle {
            width:70%;
        }
    }

    @media all and (max-width : 375px)  {
        #button-select-en , #button-select-ja {
            font-size: 11px;
        }
    }

</style>

<div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
    <div id="languageToggle"><span><a id="button-select-en" href="javaScript:changeLanguage('en')">English</a></span><span><a id="button-select-ja" href="javaScript:changeLanguage('ja')">日本語</a></span></div>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

    <div class="feedbackLink"><a id="feedbackLinkTop" target=_blank>Do you have any feedback on this page?</b></a></div>
</div>

<script>
    // highlightSelectedLanguage

    if (document.getElementsByTagName('html')[0].getAttribute('lang')=="ja") {
        document.getElementById("button-select-ja").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-en").style.color = "#000";
    } else {
        document.getElementById("button-select-en").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-ja").style.color = "#000";
    }


    var url_string = window.location.href;
    var a = document.getElementById('feedbackLinkTop');
    a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=header-link&url="+url_string);

    function changeLanguage(lang) {
        var new_url;

        if (lang == "en") {
            new_url = url_string.replace("/ja/", "/en/");
        } else {
            new_url = url_string.replace("/en/", "/ja/");
        }

        window.location.replace(new_url);
    }

</script><section id="document">
<span id="id1"></span><h1>Document<a class="headerlink" href="#document" title="Link to this heading">¶</a></h1>
<p>This class represents a document. It can be constructed from a file or from memory.</p>
<p>There exists the alias <em>open</em> for this class, i.e. <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.Document(...)</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.open(...)</span></code> do exactly the same thing.</p>
<p>For details on <strong>embedded files</strong> refer to Appendix 3.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Starting with v1.17.0, a new page addressing mechanism for <strong>EPUB files only</strong> is supported. This document type is internally organized in chapters such that pages can most efficiently be found by their so-called “location”. The location is a tuple <em>(chapter, pno)</em> consisting of the chapter number and the page number <strong>in that chapter</strong>. Both numbers are zero-based.</p>
<p>While it is still possible to locate a page via its (absolute) number, doing so may mean that the complete EPUB document must be laid out before the page can be addressed. This may have a significant performance impact if the document is very large. Using the page’s <em>(chapter, pno)</em> prevents this from happening.</p>
<p>To maintain a consistent API, PyMuPDF supports the page <em>location</em> syntax for <strong>all file types</strong> – documents without this feature simply have just one chapter. <a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a> and the equivalent index access now also support a <em>location</em> argument.</p>
<p>There are a number of methods for converting between page numbers and locations, for determining the chapter count, the page count per chapter, for computing the next and the previous locations, and the last page location of a document.</p>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Method / Attribute</strong></p></th>
<th class="head"><p><strong>Short Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.add_layer" title="Document.add_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.add_layer()</span></code></a></p></td>
<td><p>PDF only: make new optional content configuration</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.add_ocg" title="Document.add_ocg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.add_ocg()</span></code></a></p></td>
<td><p>PDF only: add new optional content group</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.authenticate" title="Document.authenticate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.authenticate()</span></code></a></p></td>
<td><p>gain access to an encrypted document</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.bake" title="Document.bake"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.bake()</span></code></a></p></td>
<td><p>PDF only: make annotations / fields permanent content</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.can_save_incrementally" title="Document.can_save_incrementally"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a></p></td>
<td><p>check if incremental save is possible</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.chapter_page_count" title="Document.chapter_page_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.chapter_page_count()</span></code></a></p></td>
<td><p>number of pages in chapter</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.close" title="Document.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.close()</span></code></a></p></td>
<td><p>close the document</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.convert_to_pdf" title="Document.convert_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a></p></td>
<td><p>write a PDF version to memory</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a></p></td>
<td><p>PDF only: copy a page reference</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.del_toc_item" title="Document.del_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.del_toc_item()</span></code></a></p></td>
<td><p>PDF only: remove a single TOC item</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a></p></td>
<td><p>PDF only: delete a page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.delete_pages" title="Document.delete_pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a></p></td>
<td><p>PDF only: delete multiple pages</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a></p></td>
<td><p>PDF only: add a new embedded file from buffer</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_count" title="Document.embfile_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_count()</span></code></a></p></td>
<td><p>PDF only: number of embedded files</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_del" title="Document.embfile_del"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_del()</span></code></a></p></td>
<td><p>PDF only: delete an embedded file entry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_get" title="Document.embfile_get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_get()</span></code></a></p></td>
<td><p>PDF only: extract an embedded file buffer</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_info" title="Document.embfile_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_info()</span></code></a></p></td>
<td><p>PDF only: metadata of an embedded file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_names" title="Document.embfile_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_names()</span></code></a></p></td>
<td><p>PDF only: list of embedded files</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_upd" title="Document.embfile_upd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_upd()</span></code></a></p></td>
<td><p>PDF only: change an embedded file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.extract_font" title="Document.extract_font"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extract_font()</span></code></a></p></td>
<td><p>PDF only: extract a font by <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.extract_image" title="Document.extract_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extract_image()</span></code></a></p></td>
<td><p>PDF only: extract an embedded image by <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.ez_save" title="Document.ez_save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.ez_save()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> with different defaults</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.find_bookmark" title="Document.find_bookmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.find_bookmark()</span></code></a></p></td>
<td><p>retrieve page location after laid out document</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.fullcopy_page" title="Document.fullcopy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.fullcopy_page()</span></code></a></p></td>
<td><p>PDF only: duplicate a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_layer" title="Document.get_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_layer()</span></code></a></p></td>
<td><p>PDF only: lists of OCGs in ON, OFF, RBGroups</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_layers" title="Document.get_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_layers()</span></code></a></p></td>
<td><p>PDF only: list of optional content configurations</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_oc" title="Document.get_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_oc()</span></code></a></p></td>
<td><p>PDF only: get OCG /OCMD xref of image / form xobject</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_ocgs" title="Document.get_ocgs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_ocgs()</span></code></a></p></td>
<td><p>PDF only: info on all optional content groups</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_ocmd" title="Document.get_ocmd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_ocmd()</span></code></a></p></td>
<td><p>PDF only: retrieve definition of an <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_fonts" title="Document.get_page_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_fonts()</span></code></a></p></td>
<td><p>PDF only: list of fonts referenced by a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a></p></td>
<td><p>PDF only: list of images referenced by a page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_labels" title="Document.get_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_labels()</span></code></a></p></td>
<td><p>PDF only: list of page label definitions</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_numbers" title="Document.get_page_numbers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_numbers()</span></code></a></p></td>
<td><p>PDF only: get page numbers having a given label</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_pixmap" title="Document.get_page_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_pixmap()</span></code></a></p></td>
<td><p>create a pixmap of a page by page number</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_text" title="Document.get_page_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_text()</span></code></a></p></td>
<td><p>extract the text of a page by page number</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_xobjects" title="Document.get_page_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a></p></td>
<td><p>PDF only: list of XObjects referenced by a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_sigflags" title="Document.get_sigflags"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_sigflags()</span></code></a></p></td>
<td><p>PDF only: determine signature state</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a></p></td>
<td><p>extract the table of contents</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_xml_metadata" title="Document.get_xml_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_xml_metadata()</span></code></a></p></td>
<td><p>PDF only: read the XML metadata</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.has_annots" title="Document.has_annots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.has_annots()</span></code></a></p></td>
<td><p>PDF only: check if PDF contains any annots</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.has_links" title="Document.has_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.has_links()</span></code></a></p></td>
<td><p>PDF only: check if PDF contains any links</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a></p></td>
<td><p>PDF only: insert a new page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a></p></td>
<td><p>PDF only: insert pages from another PDF</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.insert_file" title="Document.insert_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a></p></td>
<td><p>PDF only: insert pages from arbitrary document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_can_do" title="Document.journal_can_do"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_can_do()</span></code></a></p></td>
<td><p>PDF only: which journal actions are possible</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_enable" title="Document.journal_enable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_enable()</span></code></a></p></td>
<td><p>PDF only: enables journalling for the document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_load" title="Document.journal_load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_load()</span></code></a></p></td>
<td><p>PDF only: load journal from a file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_op_name" title="Document.journal_op_name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_op_name()</span></code></a></p></td>
<td><p>PDF only: return name of a journalling step</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_position" title="Document.journal_position"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_position()</span></code></a></p></td>
<td><p>PDF only: return journalling status</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_redo" title="Document.journal_redo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_redo()</span></code></a></p></td>
<td><p>PDF only: redo current operation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_save" title="Document.journal_save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_save()</span></code></a></p></td>
<td><p>PDF only: save journal to a file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_start_op" title="Document.journal_start_op"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_start_op()</span></code></a></p></td>
<td><p>PDF only: start an “operation” giving it a name</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_stop_op" title="Document.journal_stop_op"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_stop_op()</span></code></a></p></td>
<td><p>PDF only: end current operation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_undo" title="Document.journal_undo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_undo()</span></code></a></p></td>
<td><p>PDF only: undo current operation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.layer_ui_configs" title="Document.layer_ui_configs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layer_ui_configs()</span></code></a></p></td>
<td><p>PDF only: list of optional content intents</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.layout" title="Document.layout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layout()</span></code></a></p></td>
<td><p>re-paginate the document (if supported)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a></p></td>
<td><p>read a page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.make_bookmark" title="Document.make_bookmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.make_bookmark()</span></code></a></p></td>
<td><p>create a page pointer in reflowable documents</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.move_page" title="Document.move_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.move_page()</span></code></a></p></td>
<td><p>PDF only: move a page to different location in doc</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.need_appearances" title="Document.need_appearances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.need_appearances()</span></code></a></p></td>
<td><p>PDF only: get/set <code class="xref any docutils literal notranslate"><span class="pre">/NeedAppearances</span></code> property</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.new_page" title="Document.new_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a></p></td>
<td><p>PDF only: insert a new empty page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.next_location" title="Document.next_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.next_location()</span></code></a></p></td>
<td><p>return (chapter, pno) of following page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.outline_xref" title="Document.outline_xref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.outline_xref()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> a TOC item</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.page_cropbox" title="Document.page_cropbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.page_cropbox()</span></code></a></p></td>
<td><p>PDF only: the unrotated page rectangle</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.page_xref" title="Document.page_xref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.page_xref()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of a page number</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.pages" title="Document.pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pages()</span></code></a></p></td>
<td><p>iterator over a page range</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.pdf_catalog" title="Document.pdf_catalog"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pdf_catalog()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of catalog (root)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.pdf_trailer" title="Document.pdf_trailer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pdf_trailer()</span></code></a></p></td>
<td><p>PDF only: trailer source</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.prev_location" title="Document.prev_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.prev_location()</span></code></a></p></td>
<td><p>return (chapter, pno) of preceding page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.reload_page" title="Document.reload_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.reload_page()</span></code></a></p></td>
<td><p>PDF only: provide a new copy of a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.resolve_names" title="Document.resolve_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.resolve_names()</span></code></a></p></td>
<td><p>PDF only: Convert destination names into a Python dict</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a></p></td>
<td><p>PDF only: save the document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.saveIncr" title="Document.saveIncr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.saveIncr()</span></code></a></p></td>
<td><p>PDF only: save the document incrementally</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.scrub" title="Document.scrub"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.scrub()</span></code></a></p></td>
<td><p>PDF only: remove sensitive data</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.search_page_for" title="Document.search_page_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.search_page_for()</span></code></a></p></td>
<td><p>search for a string on a page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a></p></td>
<td><p>PDF only: select a subset of pages</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_layer_ui_config" title="Document.set_layer_ui_config"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_layer_ui_config()</span></code></a></p></td>
<td><p>PDF only: set OCG visibility temporarily</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_layer" title="Document.set_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_layer()</span></code></a></p></td>
<td><p>PDF only: mass changing OCG states</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_markinfo" title="Document.set_markinfo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_markinfo()</span></code></a></p></td>
<td><p>PDF only: set the MarkInfo values</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_metadata" title="Document.set_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_metadata()</span></code></a></p></td>
<td><p>PDF only: set the metadata</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_oc" title="Document.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_oc()</span></code></a></p></td>
<td><p>PDF only: attach OCG/OCMD to image / form xobject</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_ocmd" title="Document.set_ocmd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_ocmd()</span></code></a></p></td>
<td><p>PDF only: create or update an <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_page_labels" title="Document.set_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a></p></td>
<td><p>PDF only: add/update page label definitions</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_pagemode" title="Document.set_pagemode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_pagemode()</span></code></a></p></td>
<td><p>PDF only: set the PageMode</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_pagelayout" title="Document.set_pagelayout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_pagelayout()</span></code></a></p></td>
<td><p>PDF only: set the PageLayout</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_toc_item" title="Document.set_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_toc_item()</span></code></a></p></td>
<td><p>PDF only: change a single TOC item</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_toc" title="Document.set_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_toc()</span></code></a></p></td>
<td><p>PDF only: set the table of contents (TOC)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_xml_metadata" title="Document.set_xml_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_xml_metadata()</span></code></a></p></td>
<td><p>PDF only: create or update document XML metadata</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.subset_fonts" title="Document.subset_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.subset_fonts()</span></code></a></p></td>
<td><p>PDF only: create font subsets</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.switch_layer" title="Document.switch_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.switch_layer()</span></code></a></p></td>
<td><p>PDF only: activate OC configuration</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a></p></td>
<td><p>PDF only: writes document to memory</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.xref_copy" title="Document.xref_copy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_copy()</span></code></a></p></td>
<td><p>PDF only: copy a PDF dictionary to another <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.xref_get_key" title="Document.xref_get_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_key()</span></code></a></p></td>
<td><p>PDF only: get the value of a dictionary key</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.xref_get_keys" title="Document.xref_get_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_keys()</span></code></a></p></td>
<td><p>PDF only: list the keys of object at <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a></p></td>
<td><p>PDF only: get the definition source of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.xref_set_key" title="Document.xref_set_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_set_key()</span></code></a></p></td>
<td><p>PDF only: set the value of a dictionary key</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.xref_stream_raw" title="Document.xref_stream_raw"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_stream_raw()</span></code></a></p></td>
<td><p>PDF only: raw stream source at <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.xref_xml_metadata" title="Document.xref_xml_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_xml_metadata()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of XML metadata</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.chapter_count" title="Document.chapter_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.chapter_count</span></code></a></p></td>
<td><p>number of chapters</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.FormFonts" title="Document.FormFonts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.FormFonts</span></code></a></p></td>
<td><p>PDF only: list of global widget fonts</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.is_closed" title="Document.is_closed"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_closed</span></code></a></p></td>
<td><p>has document been closed?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.is_dirty" title="Document.is_dirty"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_dirty</span></code></a></p></td>
<td><p>PDF only: has document been changed yet?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.is_encrypted" title="Document.is_encrypted"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_encrypted</span></code></a></p></td>
<td><p>document (still) encrypted?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.is_fast_webaccess" title="Document.is_fast_webaccess"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_fast_webaccess</span></code></a></p></td>
<td><p>is PDF linearized?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.is_form_pdf" title="Document.is_form_pdf"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_form_pdf</span></code></a></p></td>
<td><p>is this a Form PDF?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.is_pdf" title="Document.is_pdf"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_pdf</span></code></a></p></td>
<td><p>is this a PDF?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.is_reflowable" title="Document.is_reflowable"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_reflowable</span></code></a></p></td>
<td><p>is this a reflowable document?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.is_repaired" title="Document.is_repaired"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_repaired</span></code></a></p></td>
<td><p>PDF only: has this PDF been repaired during open?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.last_location" title="Document.last_location"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.last_location</span></code></a></p></td>
<td><p>(chapter, pno) of last page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.metadata" title="Document.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.metadata</span></code></a></p></td>
<td><p>metadata</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.markinfo" title="Document.markinfo"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.markinfo</span></code></a></p></td>
<td><p>PDF MarkInfo value</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.name" title="Document.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.name</span></code></a></p></td>
<td><p>filename of document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.needs_pass" title="Document.needs_pass"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.needs_pass</span></code></a></p></td>
<td><p>require password to access data?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.outline" title="Document.outline"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.outline</span></code></a></p></td>
<td><p>first <a class="reference internal" href="outline.html#outline"><span class="std std-ref">Outline</span></a> item</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.page_count</span></code></a></p></td>
<td><p>number of pages</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.permissions" title="Document.permissions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.permissions</span></code></a></p></td>
<td><p>permissions to access the document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.pagemode" title="Document.pagemode"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.pagemode</span></code></a></p></td>
<td><p>PDF PageMode value</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.pagelayout" title="Document.pagelayout"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.pagelayout</span></code></a></p></td>
<td><p>PDF PageLayout value</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.version_count" title="Document.version_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.version_count</span></code></a></p></td>
<td><p>PDF count of versions</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Class API</strong></p>
<dl class="py class">
<dt class="sig sig-object py" id="Document">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Document</span></span><a class="headerlink" href="#Document" title="Link to this definition">¶</a></dt>
<dd><dl class="py method" id="index-0">
<dt class="sig sig-object py" id="Document.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.__init__" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Changed in v1.14.13: support <code class="xref any docutils literal notranslate"><span class="pre">io.BytesIO</span></code> for memory documents.</p></li>
<li><p>Changed in v1.19.6: Clearer, shorter and more consistent exception messages. File type “pdf” is always assumed if not specified. Empty files and memory areas will always lead to exceptions.</p></li>
</ul>
<p>Creates a <em>Document</em> object.</p>
<ul class="simple">
<li><p>With default parameters, a <strong>new empty PDF</strong> document will be created.</p></li>
<li><p>If <em>stream</em> is given, then the document is created from memory and, if not a PDF, either <em>filename</em> or <em>filetype</em> must indicate its type.</p></li>
<li><p>If <em>stream</em> is <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>, then a document is created from the file given by <em>filename</em>. Its type is inferred from the extension. This can be overruled by <em>filetype.</em></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>,</em><em>pathlib</em>) – A UTF-8 string or <em>pathlib</em> object containing a file path. The document type is inferred from the filename extension. If not present or not matching <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">a supported type</span></a>, a PDF document is assumed. For memory documents, this argument may be used instead of <code class="xref any docutils literal notranslate"><span class="pre">filetype</span></code>, see below.</p></li>
<li><p><strong>stream</strong> (<em>bytes</em><em>,</em><em>bytearray</em><em>,</em><em>BytesIO</em>) – A memory area containing a supported document. If not a PDF, its type <strong>must</strong> be specified by either <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code> or <code class="xref any docutils literal notranslate"><span class="pre">filetype</span></code>.</p></li>
<li><p><strong>filetype</strong> (<em>str</em>) – A string specifying the type of document. This may be anything looking like a filename (e.g. “x.pdf”), in which case MuPDF uses the extension to determine the type, or a mime type like <em>application/pdf</em>. Just using strings like “pdf”  or “.pdf” will also work. May be omitted for PDF documents, otherwise must match <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">a supported document type</span></a>.</p></li>
<li><p><strong>rect</strong> (<em>rect_like</em>) – a rectangle specifying the desired page size. This parameter is only meaningful for documents with a variable page layout (“reflowable” documents), like e-books or HTML, and ignored otherwise. If specified, it must be a non-empty, finite rectangle with top-left coordinates (0, 0). Together with parameter <em>fontsize</em>, each page will be accordingly laid out and hence also determine the number of pages.</p></li>
<li><p><strong>width</strong> (<em>float</em>) – may used together with <em>height</em> as an alternative to <em>rect</em> to specify layout information.</p></li>
<li><p><strong>height</strong> (<em>float</em>) – may used together with <em>width</em> as an alternative to <em>rect</em> to specify layout information.</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – the default <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a> for reflowable document types. This parameter is ignored if none of the parameters <em>rect</em> or <em>width</em> and <em>height</em> are specified. Will be used to calculate the page layout.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – if the <em>type</em> of any parameter does not conform.</p></li>
<li><p><strong>FileNotFoundError</strong> – if the file / path cannot be found. Re-implemented as subclass of <code class="xref any docutils literal notranslate"><span class="pre">RuntimeError</span></code>.</p></li>
<li><p><strong>EmptyFileError</strong> – if the file / path is empty or the <code class="xref any docutils literal notranslate"><span class="pre">bytes</span></code> object in memory has zero length. A subclass of <code class="xref any docutils literal notranslate"><span class="pre">FileDataError</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">RuntimeError</span></code>.</p></li>
<li><p><strong>ValueError</strong> – if an unknown file type is explicitly specified.</p></li>
<li><p><strong>FileDataError</strong> – if the document has an invalid structure for the given type – or is no file at all (but e.g. a folder). A subclass of <code class="xref any docutils literal notranslate"><span class="pre">RuntimeError</span></code>.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A document object. If the document cannot be created, an exception is raised in the above sequence. Note that PyMuPDF-specific exceptions, <code class="xref any docutils literal notranslate"><span class="pre">FileNotFoundError</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">EmptyFileError</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">FileDataError</span></code> are intercepted if you check for <code class="xref any docutils literal notranslate"><span class="pre">RuntimeError</span></code>.</p>
<p>In case of problems you can see more detail in the internal messages store: <code class="xref any docutils literal notranslate"><span class="pre">print(pymupdf.TOOLS.mupdf_warnings())</span></code> (which will be emptied by this call, but you can also prevent this – consult <a class="reference internal" href="tools.html#Tools.mupdf_warnings" title="Tools.mupdf_warnings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Tools.mupdf_warnings()</span></code></a>).</p>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not all document types are checked for valid formats already at open time. Raster images for example will raise exceptions only later, when trying to access the content. Other types (notably with non-binary content) may also be opened (and sometimes <strong>accessed</strong>) successfully – sometimes even when having invalid content for the format:</p>
<ul class="simple">
<li><p>HTM, HTML, XHTML: <strong>always</strong> opened, <code class="xref any docutils literal notranslate"><span class="pre">metadata[&quot;format&quot;]</span></code> is “HTML5”, resp. “XHTML”.</p></li>
<li><p>XML, FB2: <strong>always</strong> opened, <code class="xref any docutils literal notranslate"><span class="pre">metadata[&quot;format&quot;]</span></code> is “FictionBook2”.</p></li>
</ul>
</div>
<p>Overview of possible forms, note: <code class="xref any docutils literal notranslate"><span class="pre">open</span></code> is a synonym of <a class="reference internal" href="#document"><span class="std std-ref">Document</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># from a file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.xps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># handle wrong extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.file&quot;</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;xps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># from memory, filetype is required if not a PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;xps&quot;</span><span class="p">,</span> <span class="n">mem_area</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">mem_area</span><span class="p">,</span> <span class="s2">&quot;xps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">mem_area</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;xps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># new empty PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Raster images with a wrong (but supported) file extension <strong>are no problem</strong>. MuPDF will determine the correct image type when file <strong>content</strong> is actually accessed and will process it without complaint. So <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.open(&quot;file.jpg&quot;)</span></code> will work even for a PNG image.</p>
</div>
<p>The Document class can be also be used as a <strong>context manager</strong>. On exit, the document will automatically be closed.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="k">as</span> <span class="n">doc</span><span class="p">:</span>
<span class="go">        for page in doc: print(&quot;page %i&quot; % page.number)</span>
<span class="go">page 0</span>
<span class="go">page 1</span>
<span class="go">page 2</span>
<span class="go">page 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">is_closed</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_oc">
<span class="sig-name descname"><span class="pre">get_oc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_oc" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.4</p></li>
</ul>
<p>Return the cross reference number of an <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> or <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> attached to an image or form xobject.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of an image or form xobject. Valid such cross reference numbers are returned by <a class="reference internal" href="#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a>, resp. <a class="reference internal" href="#Document.get_page_xobjects" title="Document.get_page_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a>. For invalid numbers, an exception is raised.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the cross reference number of an optional contents object or zero if there is none.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_oc">
<span class="sig-name descname"><span class="pre">set_oc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocxref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_oc" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.4</p></li>
</ul>
<p>If <em>xref</em> represents an image or form xobject, set or remove the cross reference number <em>ocxref</em> of an optional contents object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of an image or form xobject <a class="footnote-reference brackets" href="#f5" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>. Valid such cross reference numbers are returned by <a class="reference internal" href="#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a>, resp. <a class="reference internal" href="#Document.get_page_xobjects" title="Document.get_page_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a>. For invalid numbers, an exception is raised.</p></li>
<li><p><strong>ocxref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number of an <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> / <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a>. If not zero, an invalid reference raises an exception. If zero, any OC reference is removed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_layers">
<span class="sig-name descname"><span class="pre">get_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_layers" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.3</p></li>
</ul>
<p>Show optional layer configurations. There always is a standard one, which is not included in the response.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_layers</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="go">{&#39;number&#39;: 0, &#39;name&#39;: &#39;my-config&#39;, &#39;creator&#39;: &#39;&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use &#39;number&#39; as config identifier in add_ocg</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.add_layer">
<span class="sig-name descname"><span class="pre">add_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">creator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.add_layer" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.3</p></li>
</ul>
<p>Add an optional content configuration. Layers serve as a collection of ON / OFF states for optional content groups and allow fast visibility switches between different views on the same document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – arbitrary name.</p></li>
<li><p><strong>creator</strong> (<em>str</em>) – (optional) creating software.</p></li>
<li><p><strong>on</strong> (<em>sequ</em>) – a sequence of OCG <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> numbers which should be set to ON when this layer gets activated. All OCGs not listed here will be set to OFF.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.switch_layer">
<span class="sig-name descname"><span class="pre">switch_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.switch_layer" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.3</p></li>
</ul>
<p>Switch to a document view as defined by the optional layer’s configuration number. This is temporary, except if established as default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number</strong> (<em>int</em>) – config number as returned by <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layer_configs()</span></code>.</p></li>
<li><p><strong>as_default</strong> (<em>bool</em>) – make this the default configuration.</p></li>
</ul>
</dd>
</dl>
<p>Activates the ON / OFF states of OCGs as defined in the identified layer. If <em>as_default=True</em>, then additionally all layers, including the standard one, are merged and the result is written back to the standard layer, and <strong>all optional layers are deleted</strong>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.add_ocg">
<span class="sig-name descname"><span class="pre">add_ocg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'View'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Artwork'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.add_ocg" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.3</p></li>
</ul>
<p>Add an optional content group. An OCG is the most important unit of information to determine object visibility. For a PDF, in order to be regarded as having optional content, at least one OCG must exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – arbitrary name. Will show up in supporting PDF viewers.</p></li>
<li><p><strong>config</strong> (<em>int</em>) – layer configuration number. Default -1 is the standard configuration.</p></li>
<li><p><strong>on</strong> (<em>bool</em>) – standard visibility status for objects pointing to this OCG.</p></li>
<li><p><strong>intent</strong> (<em>str</em><em>,</em><em>list</em>) – a string or list of strings declaring the visibility intents. There are two PDF standard values to choose from: “View” and “Design”. Default is “View”. Correct <strong>spelling is important</strong>.</p></li>
<li><p><strong>usage</strong> (<em>str</em>) – another influencer for OCG visibility. This will become part of the OCG’s <code class="xref any docutils literal notranslate"><span class="pre">/Usage</span></code> key. There are two PDF standard values to choose from: “Artwork” and “Technical”. Default is “Artwork”. Please only change when required.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the created OCG. Use as entry for <code class="xref any docutils literal notranslate"><span class="pre">oc</span></code> parameter in supporting objects.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multiple OCGs with identical parameters may be created. This will not cause problems. Garbage option 3 of <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> will get rid of any duplicates.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_ocmd">
<span class="sig-name descname"><span class="pre">set_ocmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'AnyOn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_ocmd" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.4</p></li>
</ul>
<p>Create or update an <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a>, <strong>Optional Content Membership Dictionary.</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the OCMD to be updated, or 0 for a new OCMD.</p></li>
<li><p><strong>ocgs</strong> (<em>list</em>) – a sequence of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> numbers of existing <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> PDF objects.</p></li>
<li><p><strong>policy</strong> (<em>str</em>) – one of “AnyOn” (default), “AnyOff”, “AllOn”, “AllOff” (mixed or lower case).</p></li>
<li><p><strong>ve</strong> (<em>list</em>) – a “visibility expression”. This is a list of arbitrarily nested other lists – see explanation below. Use as an alternative to the combination <em>ocgs</em> / <em>policy</em> if you need to formulate more complex conditions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the OCMD. Use as <code class="xref any docutils literal notranslate"><span class="pre">oc=xref</span></code> parameter in supporting objects, and respectively in <a class="reference internal" href="#Document.set_oc" title="Document.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_oc()</span></code></a> or <a class="reference internal" href="annot.html#Annot.set_oc" title="Annot.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_oc()</span></code></a>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Like an OCG, an OCMD has a visibility state ON or OFF, and it can be used like an OCG. In contrast to an OCG, the OCMD state is determined by evaluating the state of one or more OCGs via special forms of <strong>boolean expressions.</strong> If the expression evaluates to true, the OCMD state is ON and OFF for false.</p>
<p>There are two ways to formulate OCMD visibility:</p>
<ol class="arabic simple">
<li><p>Use the combination of <em>ocgs</em> and <em>policy</em>: The <em>policy</em> value is interpreted as follows:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>AnyOn – (default) true if at least one OCG is ON.</p></li>
<li><p>AnyOff – true if at least one OCG is OFF.</p></li>
<li><p>AllOn – true if all OCGs are ON.</p></li>
<li><p>AllOff – true if all OCGs are OFF.</p></li>
</ul>
<p>Suppose you want two PDF objects be displayed exactly one at a time (if one is ON, then the other one must be OFF):</p>
<p>Solution: use an <strong>OCG</strong> for object 1 and an <strong>OCMD</strong> for object 2. Create the OCMD via <code class="xref any docutils literal notranslate"><span class="pre">set_ocmd(ocgs=[xref],</span> <span class="pre">policy=&quot;AllOff&quot;)</span></code>, with the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the OCG.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Use the <strong>visibility expression</strong> <em>ve</em>: This is a list of two or more items. The <strong>first item</strong> is a logical keyword: one of the strings <strong>“and”</strong>, <strong>“or”</strong>, or <strong>“not”</strong>. The <strong>second</strong> and all subsequent items must either be an integer or another list. An integer must be the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number of an OCG. A list must again have at least two items starting with one of the boolean keywords. This syntax is a bit awkward, but quite powerful:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Each list must start with a logical keyword.</p></li>
<li><p>If the keyword is a <strong>“not”</strong>, then the list must have exactly two items. If it is <strong>“and”</strong> or <strong>“or”</strong>, any number of other items may follow.</p></li>
<li><p>Items following the logical keyword may be either integers or again a list. An <em>integer</em> must be the xref of an OCG. A <em>list</em> must conform to the previous rules.</p></li>
</ul>
<p><strong>Examples:</strong></p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">set_ocmd(ve=[&quot;or&quot;,</span> <span class="pre">4,</span> <span class="pre">[&quot;not&quot;,</span> <span class="pre">5],</span> <span class="pre">[&quot;and&quot;,</span> <span class="pre">6,</span> <span class="pre">7]])</span></code>. This delivers ON if the following is true: <strong>“4 is ON, or 5 is OFF, or 6 and 7 are both ON”</strong>.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">set_ocmd(ve=[&quot;not&quot;,</span> <span class="pre">xref])</span></code>. This has the same effect as the OCMD example created under 1.</p></li>
</ul>
<p>For more details and examples see page 224 of <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>. Also do have a look at example scripts <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/optional-content">here</a>.</p>
<p>Visibility expressions, <code class="xref any docutils literal notranslate"><span class="pre">/VE</span></code>, are part of PDF specification version 1.6. So not all PDF viewers / readers may already support this feature and hence will react in some standard way for those cases.</p>
</div></blockquote>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_ocmd">
<span class="sig-name descname"><span class="pre">get_ocmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_ocmd" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.4</p></li>
</ul>
<p>Retrieve the definition of an <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the OCMD.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dictionary with the keys <em>xref</em>, <em>ocgs</em>, <em>policy</em> and <em>ve</em>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_layer">
<span class="sig-name descname"><span class="pre">get_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_layer" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.3</p></li>
</ul>
<p>List of optional content groups by status in the specified configuration. This is a dictionary with lists of cross reference numbers for OCGs that occur in the arrays <code class="xref any docutils literal notranslate"><span class="pre">/ON</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">/OFF</span></code> or in some radio button group (<code class="xref any docutils literal notranslate"><span class="pre">/RBGroups</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>int</em>) – the configuration layer (default is the standard config layer).</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">get_layer</span><span class="p">())</span>
<span class="go">{&#39;off&#39;: [8, 9, 10], &#39;on&#39;: [5, 6, 7], &#39;rbgroups&#39;: [[7, 10]]}</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_layer">
<span class="sig-name descname"><span class="pre">set_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">off</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basestate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbgroups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_layer" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.3</p></li>
<li><p>Changed in v1.22.5: Support list of <em>locked</em> OCGs.</p></li>
</ul>
<p>Mass status changes of optional content groups. <strong>Permanently</strong> sets the status of OCGs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>int</em>) – desired configuration layer, choose -1 for the default one.</p></li>
<li><p><strong>on</strong> (<em>list</em>) – list of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of OCGs to set ON. Replaces previous values. An empty list will cause no OCG being set to ON anymore. Should be specified if <code class="xref any docutils literal notranslate"><span class="pre">basestate=&quot;ON&quot;</span></code> is used.</p></li>
<li><p><strong>off</strong> (<em>list</em>) – list of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of OCGs to set OFF. Replaces previous values. An empty list will cause no OCG being set to OFF anymore. Should be specified if <code class="xref any docutils literal notranslate"><span class="pre">basestate=&quot;OFF&quot;</span></code> is used.</p></li>
<li><p><strong>basestate</strong> (<em>str</em>) – state of OCGs that are not mentioned in <em>on</em> or <em>off</em>. Possible values are “ON”, “OFF” or “Unchanged”. Upper / lower case possible.</p></li>
<li><p><strong>rbgroups</strong> (<em>list</em>) – a list of lists. Replaces previous values. Each sublist should contain two or more OCG xrefs. OCGs in the same sublist are handled like buttons in a radio button group: setting one to ON automatically sets all other group members to OFF.</p></li>
<li><p><strong>locked</strong> (<em>list</em>) – a list of OCG xref number that cannot be changed by the user interface.</p></li>
</ul>
</dd>
</dl>
<p>Values <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> will not change the corresponding PDF array.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_layer</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">basestate</span><span class="o">=</span><span class="s2">&quot;OFF&quot;</span><span class="p">)</span>  <span class="c1"># only changes the base state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">get_layer</span><span class="p">())</span>
<span class="go">{&#39;basestate&#39;: &#39;OFF&#39;, &#39;off&#39;: [8, 9, 10], &#39;on&#39;: [5, 6, 7], &#39;rbgroups&#39;: [[7, 10]]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_ocgs">
<span class="sig-name descname"><span class="pre">get_ocgs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_ocgs" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.3</p></li>
</ul>
<p>Details of all optional content groups. This is a dictionary of dictionaries like this (key is the OCG’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">get_ocgs</span><span class="p">())</span>
<span class="go">{13: {&#39;on&#39;: True,</span>
<span class="go">      &#39;intent&#39;: [&#39;View&#39;, &#39;Design&#39;],</span>
<span class="go">      &#39;name&#39;: &#39;Circle&#39;,</span>
<span class="go">      &#39;usage&#39;: &#39;Artwork&#39;},</span>
<span class="go">14: {&#39;on&#39;: True,</span>
<span class="go">      &#39;intent&#39;: [&#39;View&#39;, &#39;Design&#39;],</span>
<span class="go">      &#39;name&#39;: &#39;Square&#39;,</span>
<span class="go">      &#39;usage&#39;: &#39;Artwork&#39;},</span>
<span class="go">15: {&#39;on&#39;: False, &#39;intent&#39;: [&#39;View&#39;], &#39;name&#39;: &#39;Square&#39;, &#39;usage&#39;: &#39;Artwork&#39;}}</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.layer_ui_configs">
<span class="sig-name descname"><span class="pre">layer_ui_configs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.layer_ui_configs" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.3</p></li>
</ul>
<p>Show the visibility status of optional content that is modifiable by the user interface of supporting PDF viewers.</p>
<blockquote>
<div><ul class="simple">
<li><p>Only reports items contained in the currently selected layer configuration.</p></li>
<li><dl class="simple">
<dt>The meaning of the dictionary keys is as follows:</dt><dd><ul>
<li><p><em>depth:</em> item’s nesting level in the <code class="xref any docutils literal notranslate"><span class="pre">/Order</span></code> array</p></li>
<li><p><em>locked:</em> true if cannot be changed via user interfaces</p></li>
<li><p><em>number:</em> running sequence number</p></li>
<li><p><em>on:</em> item state</p></li>
<li><p><em>text:</em> text string or name field of the originating OCG</p></li>
<li><p><em>type:</em> one of “label” (set by a text string), “checkbox” (set by a single OCG) or “radiobox” (set by a set of connected OCGs)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_layer_ui_config">
<span class="sig-name descname"><span class="pre">set_layer_ui_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_layer_ui_config" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.3</p></li>
</ul>
<p>Modify OC visibility status of content groups. This is analog to what supporting PDF viewers would offer.</p>
<blockquote>
<div><p>Please note that visibility is <strong>not</strong> a property stored with the OCG. It is not even information necessarily present in the PDF document at all. Instead, the current visibility is <strong>temporarily</strong> set using the user interface of some supporting PDF consumer software. The same type of functionality is offered by this method.</p>
<p>To make <strong>permanent</strong> changes, use <a class="reference internal" href="#Document.set_layer" title="Document.set_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_layer()</span></code></a>.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number</strong> (<em>int</em><em>,</em><em>str</em>) – either the sequence number of the item in list <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layer_configs()</span></code> or the “text” of one of these items.</p></li>
<li><p><strong>action</strong> (<em>int</em>) – <code class="xref any docutils literal notranslate"><span class="pre">PDF_OC_ON</span></code> = set on (default), <code class="xref any docutils literal notranslate"><span class="pre">PDF_OC_TOGGLE</span></code> = toggle on/off, <code class="xref any docutils literal notranslate"><span class="pre">PDF_OC_OFF</span></code> = set off.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.authenticate">
<span class="sig-name descname"><span class="pre">authenticate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">password</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.authenticate" title="Link to this definition">¶</a></dt>
<dd><p>Decrypts the document with the string <em>password</em>. If successful, document data can be accessed. For PDF documents, the “owner” and the “user” have different privileges, and hence different passwords may exist for these authorization levels. The method will automatically establish the appropriate (owner or user) access rights for the provided password.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>password</strong> (<em>str</em>) – owner or user password.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>a positive value if successful, zero otherwise (the string does not match either password). If positive, the indicator <a class="reference internal" href="#Document.is_encrypted" title="Document.is_encrypted"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_encrypted</span></code></a> is set to <em>False</em>. <strong>Positive</strong> return codes carry the following information detail:</p>
<ul class="simple">
<li><p>1 =&gt; authenticated, but the PDF has neither owner nor user passwords.</p></li>
<li><p>2 =&gt; authenticated with the <strong>user</strong> password.</p></li>
<li><p>4 =&gt; authenticated with the <strong>owner</strong> password.</p></li>
<li><p>6 =&gt; authenticated and both passwords are equal – probably a rare situation.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The document may be protected by an owner, but <strong>not</strong> by a user password. Detect this situation via <code class="xref any docutils literal notranslate"><span class="pre">doc.authenticate(&quot;&quot;)</span> <span class="pre">==</span> <span class="pre">2</span></code>. This allows opening and reading the document without authentication, but, depending on the <a class="reference internal" href="#Document.permissions" title="Document.permissions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.permissions</span></code></a> value, other actions may be prohibited. PyMuPDF (like MuPDF) in this case <strong>ignores those restrictions</strong>. So, – in contrast to any PDF viewers – you can for example extract text and add or modify content, even if the respective permission flags <code class="xref any docutils literal notranslate"><span class="pre">PDF_PERM_COPY</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">PDF_PERM_MODIFY</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">PDF_PERM_ANNOTATE</span></code>, etc. are set off! It is your responsibility building a legally compliant application where applicable.</p>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_numbers">
<span class="sig-name descname"><span class="pre">get_page_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_numbers" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v 1.18.6</p></li>
</ul>
<p>PDF only: Return a list of page numbers that have the specified label – note that labels may not be unique in a PDF. This implies a sequential search through <strong>all page numbers</strong> to compare their labels.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Implementation detail – pages are <strong>not loaded</strong> for this purpose.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – the label to look for, e.g. “vii” (Roman number 7).</p></li>
<li><p><strong>only_one</strong> (<em>bool</em>) – stop after first hit. Useful e.g. if labelling is known to be unique, or there are many pages, etc. The default will check every page number.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of page numbers that have this label. Empty if none found, no labels defined, etc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_labels">
<span class="sig-name descname"><span class="pre">get_page_labels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_labels" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.7</p></li>
</ul>
<p>PDF only: Extract the list of page label definitions. Typically used for modifications before feeding it into <a class="reference internal" href="#Document.set_page_labels" title="Document.set_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of dictionaries as defined in <a class="reference internal" href="#Document.set_page_labels" title="Document.set_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_page_labels">
<span class="sig-name descname"><span class="pre">set_page_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_page_labels" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.6</p></li>
</ul>
<p>PDF only: Add or update the page label definitions of the PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>labels</strong> (<em>list</em>) – <p>a list of dictionaries. Each dictionary defines a label building rule and a 0-based “start” page number. That start page is the first for which the label definition is valid. Each dictionary has up to 4 items and looks like <code class="xref any docutils literal notranslate"><span class="pre">{'startpage':</span> <span class="pre">int,</span> <span class="pre">'prefix':</span> <span class="pre">str,</span> <span class="pre">'style':</span> <span class="pre">str,</span> <span class="pre">'firstpagenum':</span> <span class="pre">int}</span></code> and has the following items.</p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">startpage</span></code>: (int) the first page number (0-based) to apply the label rule. This key <strong>must be present</strong>. The rule is applied to all subsequent pages until either end of document or superseded by the rule with the next larger page number.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">prefix</span></code>: (str) an arbitrary string to start the label with, e.g. “A-”. Default is “”.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">style</span></code>: (str) the numbering style. Available are “D” (decimal), “r”/”R” (Roman numbers, lower / upper case), and “a”/”A” (lower / upper case alphabetical numbering: “a” through “z”, then “aa” through “zz”, etc.). Default is “”. If “”, no numbering will take place and the pages in that range will receive the same label consisting of the <code class="xref any docutils literal notranslate"><span class="pre">prefix</span></code> value. If prefix is also omitted, then the label will be “”.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">firstpagenum</span></code>: (int) start numbering with this value. Default is 1, smaller values are ignored.</p></li>
</ul>
</p>
</dd>
</dl>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;startpage&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;A-&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;firstpagenum&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;startpage&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;firstpagenum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}]</span>
</pre></div>
</div>
<p>will generate the labels “A-10”, “A-11”, “A-12”, “A-13”, “1”, “2”, “3”, … for pages 6, 7 and so on until end of document. Pages 0 through 5 will have the label “”.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.make_bookmark">
<span class="sig-name descname"><span class="pre">make_bookmark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.make_bookmark" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v.1.17.3</p></li>
</ul>
<p>Return a page pointer in a reflowable document. After re-layouting the document, the result of this method can be used to find the new location of the page.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do not confuse with items of a table of contents, TOC.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>loc</strong> (<em>list</em><em>,</em><em>tuple</em>) – page location. Must be a valid <em>(chapter, pno)</em>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pointer</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a long integer in pointer format. To be used for finding the new location of the page after re-layouting the document. Do not touch or re-assign.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.find_bookmark">
<span class="sig-name descname"><span class="pre">find_bookmark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bookmark</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.find_bookmark" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v.1.17.3</p></li>
</ul>
<p>Return the new page location after re-layouting the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bookmark</strong> (<em>pointer</em>) – created by <a class="reference internal" href="#Document.make_bookmark" title="Document.make_bookmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.make_bookmark()</span></code></a>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the new (chapter, pno) of the page.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.chapter_page_count">
<span class="sig-name descname"><span class="pre">chapter_page_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chapter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.chapter_page_count" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v.1.17.0</p></li>
</ul>
<p>Return the number of pages of a chapter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chapter</strong> (<em>int</em>) – the 0-based chapter number.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>number of pages in chapter. Relevant only for document types with chapter support (EPUB currently).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.next_location">
<span class="sig-name descname"><span class="pre">next_location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.next_location" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v.1.17.0</p></li>
</ul>
<p>Return the location of the following page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>page_id</strong> (<em>tuple</em>) – the current page id. This must be a tuple <em>(chapter, pno)</em> identifying an existing page.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The tuple of the following page, i.e. either <em>(chapter, pno + 1)</em> or <em>(chapter + 1, 0)</em>, <strong>or</strong> the empty tuple <em>()</em> if the argument was the last page. Relevant only for document types with chapter support (EPUB currently).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.prev_location">
<span class="sig-name descname"><span class="pre">prev_location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.prev_location" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v.1.17.0</p></li>
</ul>
<p>Return the locator of the preceding page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>page_id</strong> (<em>tuple</em>) – the current page id. This must be a tuple <em>(chapter, pno)</em> identifying an existing page.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The tuple of the preceding page, i.e. either <em>(chapter, pno - 1)</em> or the last page of the preceding chapter, <strong>or</strong> the empty tuple <em>()</em> if the argument was the first page. Relevant only for document types with chapter support (EPUB currently).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.load_page">
<span class="sig-name descname"><span class="pre">load_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.load_page" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Changed in v1.17.0: For document types supporting a so-called “chapter structure” (like EPUB), pages can also be loaded via the combination of chapter number and relative page number, instead of the absolute page number. This should <strong>significantly speed up access</strong> for large documents.</p></li>
</ul>
<p>Create a <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> object for further processing (like rendering, text searching, etc.).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>page_id</strong> (<em>int</em><em>,</em><em>tuple</em>) – <p><em>(Changed in v1.17.0)</em></p>
<p>Either a 0-based page number, or a tuple <em>(chapter, pno)</em>. For an <strong>integer</strong>, any <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">page_id</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code> is acceptable. While page_id is negative, <a class="reference internal" href="#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">page_count</span></code></a> will be added to it. For example: to load the last page, you can use <em>doc.load_page(-1)</em>. After this you have page.number = doc.page_count - 1.</p>
<p>For a tuple, <em>chapter</em> must be in range <a class="reference internal" href="#Document.chapter_count" title="Document.chapter_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.chapter_count</span></code></a>, and <em>pno</em> must be in range <a class="reference internal" href="#Document.chapter_page_count" title="Document.chapter_page_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.chapter_page_count()</span></code></a> of that chapter. Both values are 0-based. Using this notation, <a class="reference internal" href="page.html#Page.number" title="Page.number"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.number</span></code></a> will equal the given tuple. Relevant only for document types with chapter support (EPUB currently).</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a></p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Documents also follow the Python sequence protocol with page numbers as indices: <em>doc.load_page(n) == doc[n]</em>.</p>
<p>For <strong>absolute page numbers</strong> only, expressions like <em>“for page in doc: …”</em> and <em>“for page in reversed(doc): …”</em> will successively yield the document’s pages. Refer to <a class="reference internal" href="#Document.pages" title="Document.pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pages()</span></code></a> which allows processing pages as with slicing.</p>
<p>You can also use index notation with the new chapter-based page identification: use <em>page = doc[(5, 2)]</em> to load the third page of the sixth chapter.</p>
<p>To maintain a consistent API, for document types not supporting a chapter structure (like PDFs), <a class="reference internal" href="#Document.chapter_count" title="Document.chapter_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.chapter_count</span></code></a> is 1, and pages can also be loaded via tuples <em>(0, pno)</em>. See this <a class="footnote-reference brackets" href="#f3" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> footnote for comments on performance improvements.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="Document.reload_page">
<span class="sig-name descname"><span class="pre">reload_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.reload_page" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.16.10</p></li>
</ul>
<p>PDF only: Provide a new copy of a page after finishing and updating all pending changes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>page</strong> (<a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a>) – page object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>a new copy of the same page. All pending updates (e.g. to annotations or widgets) will be finalized and a fresh copy of the page will be loaded.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In a typical use case, a page <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> should be taken after annotations / widgets have been added or changed. To force all those changes being reflected in the page structure, this method re-instates a fresh copy while keeping the object hierarchy “document -&gt; page -&gt; annotations/widgets” intact.</p>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.resolve_names">
<span class="sig-name descname"><span class="pre">resolve_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.resolve_names" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Convert destination names into a Python dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A dictionary with the following layout:</p>
<ul class="simple">
<li><p><em>key</em>: (str) the name.</p></li>
<li><dl class="simple">
<dt><em>value</em>: (dict) with the following layout:</dt><dd><ul>
<li><p>”page”:  target page number (0-based). If no page number found -1.</p></li>
<li><p>”to”: (x, y) target point on page. Currently in PDF coordinates,
i.e. point (0,0) is the bottom-left of the page.</p></li>
<li><p>”zoom”: (float) the zoom factor.</p></li>
<li><p>”dest”: (str) only present if the target location on the page has
not been provided as “/XYZ” or if no page number was found.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;__bookmark_1&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;page&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">541.0</span><span class="p">),</span> <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
    <span class="s1">&#39;__bookmark_2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;page&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">481.45</span><span class="p">),</span> <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;21154a7c20684ceb91f9c9adc3b677c40&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;page&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dest&#39;</span><span class="p">:</span> <span class="s1">&#39;/XYZ 15.75 1486 0&#39;</span><span class="p">},</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</dd>
</dl>
<p>All names found in the catalog under keys “/Dests” and “/Names/Dests” are
included.</p>
<ul class="simple">
<li><p>New in v1.23.6</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.page_cropbox">
<span class="sig-name descname"><span class="pre">page_cropbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.page_cropbox" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.17.7</p></li>
</ul>
<p>PDF only: Return the unrotated page rectangle – <strong>without loading the page</strong> (via <a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a>). This is meant for internal purpose requiring best possible performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – 0-based page number.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> of the page like <a class="reference internal" href="page.html#Page.rect" title="Page.rect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.rect()</span></code></a>, but ignoring any rotation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.page_xref">
<span class="sig-name descname"><span class="pre">page_xref</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.page_xref" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.17.7</p></li>
</ul>
<p>PDF only: Return the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the page – <strong>without loading the page</strong> (via <a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a>). This is meant for internal purpose requiring best possible performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – 0-based page number.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the page like <a class="reference internal" href="page.html#Page.xref" title="Page.xref"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.xref</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.pages">
<span class="sig-name descname"><span class="pre">pages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start=None</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">stop=None</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">step=None</span></span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.pages" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.16.4</p></li>
</ul>
<p>A generator for a range of pages. Parameters have the same meaning as in the built-in function <em>range()</em>. Intended for expressions of the form <em>“for page in doc.pages(start, stop, step): …”</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>int</em>) – start iteration with this page number. Default is zero, allowed values are <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">start</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>. While this is negative, <a class="reference internal" href="#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">page_count</span></code></a> is added <strong>before</strong> starting the iteration.</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – stop iteration at this page number. Default is <a class="reference internal" href="#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">page_count</span></code></a>, possible are <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">stop</span> <span class="pre">&lt;=</span> <span class="pre">page_count</span></code>. Larger values are <strong>silently replaced</strong> by the default. Negative values will cyclically emit the pages in reversed order. As with the built-in <em>range()</em>, this is the first page <strong>not</strong> returned.</p></li>
<li><p><strong>step</strong> (<em>int</em>) – stepping value. Defaults are 1 if start &lt; stop and -1 if start &gt; stop. Zero is not allowed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>a generator iterator over the document’s pages. Some examples:</p>
<ul class="simple">
<li><p>”doc.pages()” emits all pages.</p></li>
<li><p>”doc.pages(4, 9, 2)” emits pages 4, 6, 8.</p></li>
<li><p>”doc.pages(0, None, 2)” emits all pages with even numbers.</p></li>
<li><p>”doc.pages(-2)” emits the last two pages.</p></li>
<li><p>”doc.pages(-1, -1)” emits all pages in reversed order.</p></li>
<li><p>”doc.pages(-1, -10)” always emits 10 pages in reversed order, starting with the last page – <strong>repeatedly</strong> if the document has less than 10 pages. So for a 4-page document the following page numbers are emitted: 3, 2, 1, 0, 3, 2, 1, 0, 3, 2, 1, 0, 3.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method" id="index-1">
<dt class="sig sig-object py" id="Document.convert_to_pdf">
<span class="sig-name descname"><span class="pre">convert_to_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.convert_to_pdf" title="Link to this definition">¶</a></dt>
<dd><p>Create a PDF version of the current document and write it to memory. <strong>All document types</strong> are supported. The parameters have the same meaning as in <a class="reference internal" href="#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code></a>. In essence, you can restrict the conversion to a page subset, specify page rotation, and revert page sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_page</strong> (<em>int</em>) – first page to copy (0-based). Default is first page.</p></li>
<li><p><strong>to_page</strong> (<em>int</em>) – last page to copy (0-based). Default is last page.</p></li>
<li><p><strong>rotate</strong> (<em>int</em>) – rotation angle. Default is 0 (no rotation). Should be <em>n * 90</em> with an integer n (not checked).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>a Python <em>bytes</em> object containing a PDF file image. It is created by internally using <code class="xref any docutils literal notranslate"><span class="pre">tobytes(garbage=4,</span> <span class="pre">deflate=True)</span></code>. See <a class="reference internal" href="#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tobytes()</span></code></a>. You can output it directly to disk or open it as a PDF. Here are some examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># convert an XPS file to PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xps</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.xps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdfbytes</span> <span class="o">=</span> <span class="n">xps</span><span class="o">.</span><span class="n">convert_to_pdf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># either do this --&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">pdfbytes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;some.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or this --&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdfout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;some.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdfout</span><span class="o">.</span><span class="n">tobytes</span><span class="p">(</span><span class="n">pdfbytes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdfout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># copy image files to PDF pages</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># each page will have image dimensions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>                     <span class="c1"># new PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imglist</span> <span class="o">=</span> <span class="p">[</span> <span class="o">...</span> <span class="n">image</span> <span class="n">file</span> <span class="n">names</span> <span class="o">...</span><span class="p">]</span> <span class="c1"># e.g. a directory listing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">imglist</span><span class="p">:</span>
<span class="go">        imgdoc=pymupdf.open(img)           # open image as a document</span>
<span class="go">        pdfbytes=imgdoc.convert_to_pdf()  # make a 1-page PDF of it</span>
<span class="go">        imgpdf=pymupdf.open(&quot;pdf&quot;, pdfbytes)</span>
<span class="go">        doc.insert_pdf(imgpdf)             # insert the image PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;allmyimages.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method uses the same logic as the <em>mutool convert</em> CLI. This works very well in most cases – however, beware of the following limitations.</p>
<ul class="simple">
<li><p>Image files: perfect, no issues detected. However, image transparency is ignored. If you need that (like for a watermark), use <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> instead. Otherwise, this method is recommended for its much better performance.</p></li>
<li><p>XPS: appearance very good. Links work fine, outlines (bookmarks) are lost, but can easily be recovered <a class="footnote-reference brackets" href="#f2" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p></li>
<li><p>EPUB, CBZ, FB2: similar to XPS.</p></li>
<li><p>SVG: medium. Roughly comparable to <a class="reference external" href="https://github.com/deeplook/svglib">svglib</a>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_toc">
<span class="sig-name descname"><span class="pre">get_toc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_toc" title="Link to this definition">¶</a></dt>
<dd><p>Creates a table of contents (TOC) out of the document’s outline chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simple</strong> (<em>bool</em>) – Indicates whether a simple or a detailed TOC is required. If <em>False</em>, each item of the list also contains a dictionary with <a class="reference internal" href="linkdest.html#linkdest"><span class="std std-ref">linkDest</span></a> details for each outline entry.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>a list of lists. Each entry has the form <em>[lvl, title, page, dest]</em>. Its entries have the following meanings:</p>
<ul class="simple">
<li><p><em>lvl</em> – hierarchy level (positive <em>int</em>). The first entry is always 1. Entries in a row are either <strong>equal</strong>, <strong>increase</strong> by 1, or <strong>decrease</strong> by any number.</p></li>
<li><p><em>title</em> – title (<em>str</em>)</p></li>
<li><p><em>page</em> – 1-based source page number (<em>int</em>). <code class="xref any docutils literal notranslate"><span class="pre">-1</span></code> if no destination or outside document.</p></li>
<li><p><em>dest</em> – (<em>dict</em>) included only if <em>simple=False</em>. Contains details of the TOC item as follows:</p>
<ul>
<li><p>kind: destination kind, see <a class="reference internal" href="vars.html#linkdest-kinds"><span class="std std-ref">Link Destination Kinds</span></a>.</p></li>
<li><p>file: filename if kind is <a class="reference internal" href="vars.html#LINK_GOTOR" title="LINK_GOTOR"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTOR</span></code></a> or <a class="reference internal" href="vars.html#LINK_LAUNCH" title="LINK_LAUNCH"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_LAUNCH</span></code></a>.</p></li>
<li><p>page: target page, 0-based, <a class="reference internal" href="vars.html#LINK_GOTOR" title="LINK_GOTOR"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTOR</span></code></a> or <a class="reference internal" href="vars.html#LINK_GOTO" title="LINK_GOTO"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTO</span></code></a> only.</p></li>
<li><p>to: position on target page (<a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a>).</p></li>
<li><p>zoom: (float) zoom factor on target page.</p></li>
<li><p>xref: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the item (0 if no PDF).</p></li>
<li><p>color: item color in PDF RGB format <code class="xref any docutils literal notranslate"><span class="pre">(red,</span> <span class="pre">green,</span> <span class="pre">blue)</span></code>, or omitted (always omitted if no PDF).</p></li>
<li><p>bold: true if bold item text or omitted. PDF only.</p></li>
<li><p>italic: true if italic item text, or omitted. PDF only.</p></li>
<li><p>collapse: true if sub-items are folded, or omitted. PDF only.</p></li>
<li><p>nameddest: target name if kind=4. PDF only. (New in 1.23.7.)</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_get_keys">
<span class="sig-name descname"><span class="pre">xref_get_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_get_keys" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.7</p></li>
</ul>
<p>PDF only: Return the PDF dictionary keys of the <a class="reference internal" href="glossary.html#dictionary" title="dictionary"><code class="xref py py-data docutils literal notranslate"><span class="pre">dictionary</span></code></a> object provided by its xref number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>. <em>(Changed in v1.18.10)</em> Use <code class="xref any docutils literal notranslate"><span class="pre">-1</span></code> to access the special dictionary “PDF trailer”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>a tuple of dictionary keys present in object <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>. Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">=</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pymupdf.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xref</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">page_xref</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># xref of page 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="n">xref</span><span class="p">))</span>  <span class="c1"># primary level keys of a page</span>
<span class="go">(&#39;Type&#39;, &#39;Contents&#39;, &#39;Resources&#39;, &#39;MediaBox&#39;, &#39;Parent&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># primary level keys of the trailer</span>
<span class="go">(&#39;Type&#39;, &#39;Index&#39;, &#39;Size&#39;, &#39;W&#39;, &#39;Root&#39;, &#39;Info&#39;, &#39;ID&#39;, &#39;Length&#39;, &#39;Filter&#39;)</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_get_key">
<span class="sig-name descname"><span class="pre">xref_get_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_get_key" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.7</p></li>
</ul>
<p>PDF only: Return type and value of a PDF dictionary key of a <a class="reference internal" href="glossary.html#dictionary" title="dictionary"><code class="xref py py-data docutils literal notranslate"><span class="pre">dictionary</span></code></a> object given by its xref.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>. <em>Changed in v1.18.10:</em> Use <code class="xref any docutils literal notranslate"><span class="pre">-1</span></code> to access the special dictionary “PDF trailer”.</p></li>
<li><p><strong>key</strong> (<em>str</em>) – the desired PDF key. Must <strong>exactly</strong> match (case-sensitive) one of the keys contained in <a class="reference internal" href="#Document.xref_get_keys" title="Document.xref_get_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_keys()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple (type, value) of strings, where type is one of “xref”, “array”, “dict”, “int”, “float”, “null”, “bool”, “name”, “string” or “unknown” (should not occur). Independent of “type”, the value of the key is <strong>always</strong> formatted as a string – see the following example – and (almost always) a faithful reflection of what is stored in the PDF. In most cases, the format of the value string also gives a clue about the key type:</p>
</dd>
</dl>
<ul>
<li><p>A “name” always starts with a “/” slash.</p></li>
<li><p>An “xref” always ends with “ 0 R”.</p></li>
<li><p>An “array” is always enclosed in “[…]” brackets.</p></li>
<li><p>A “dict” is always enclosed in “&lt;&lt;…&gt;&gt;” brackets.</p></li>
<li><p>A “bool”, resp. “null” always equal either “true”, “false”, resp. “null”.</p></li>
<li><p>“float” and “int” are represented by their string format – and are thus not always distinguishable.</p></li>
<li><p>A “string” is converted to UTF-8 and may therefore deviate from what is stored in the PDF. For example, the PDF key “Author” may have a value of “&lt;FEFF004A006F0072006A00200058002E0020004D0063004B00690065&gt;” in the file, but the method will return <code class="xref any docutils literal notranslate"><span class="pre">('string',</span> <span class="pre">'Jorj</span> <span class="pre">X.</span> <span class="pre">McKie')</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="n">xref</span><span class="p">):</span>
<span class="go">        print(key, &quot;=&quot; , doc.xref_get_key(xref, key))</span>
<span class="go">Type = (&#39;name&#39;, &#39;/Page&#39;)</span>
<span class="go">Contents = (&#39;xref&#39;, &#39;1297 0 R&#39;)</span>
<span class="go">Resources = (&#39;xref&#39;, &#39;1296 0 R&#39;)</span>
<span class="go">MediaBox = (&#39;array&#39;, &#39;[0 0 612 792]&#39;)</span>
<span class="go">Parent = (&#39;xref&#39;, &#39;1301 0 R&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now same thing for the PDF trailer.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># It has no xref, so -1 must be used instead.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="go">        print(key, &quot;=&quot;, doc.xref_get_key(-1, key))</span>
<span class="go">Type = (&#39;name&#39;, &#39;/XRef&#39;)</span>
<span class="go">Index = (&#39;array&#39;, &#39;[0 8802]&#39;)</span>
<span class="go">Size = (&#39;int&#39;, &#39;8802&#39;)</span>
<span class="go">W = (&#39;array&#39;, &#39;[1 3 1]&#39;)</span>
<span class="go">Root = (&#39;xref&#39;, &#39;8799 0 R&#39;)</span>
<span class="go">Info = (&#39;xref&#39;, &#39;8800 0 R&#39;)</span>
<span class="go">ID = (&#39;array&#39;, &#39;[&lt;DC9D56A6277EFFD82084E64F9441E18C&gt;&lt;DC9D56A6277EFFD82084E64F9441E18C&gt;]&#39;)</span>
<span class="go">Length = (&#39;int&#39;, &#39;21111&#39;)</span>
<span class="go">Filter = (&#39;name&#39;, &#39;/FlateDecode&#39;)</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_set_key">
<span class="sig-name descname"><span class="pre">xref_set_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_set_key" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.7, changed in v 1.18.13</p></li>
<li><p>Changed in v1.19.4: remove a key “physically” if set to “null”.</p></li>
</ul>
<p>PDF only: Set (add, update, delete) the value of a PDF key for the <a class="reference internal" href="glossary.html#dictionary" title="dictionary"><code class="xref py py-data docutils literal notranslate"><span class="pre">dictionary</span></code></a> object given by its xref.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>This is an expert function: if you do not know what you are doing, there is a high risk to render (parts of) the PDF unusable. Please do consult <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a> about object specification formats (page 18) and the structure of special dictionary types like page objects.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>. <em>Changed in v1.18.13:</em> To update the PDF trailer, specify -1.</p></li>
<li><p><strong>key</strong> (<em>str</em>) – the desired PDF key (without leading “/”). Must not be empty. Any valid PDF key – whether already present in the object (which will be overwritten) – or new. It is possible to use PDF path notation like <code class="xref any docutils literal notranslate"><span class="pre">&quot;Resources/ExtGState&quot;</span></code> – which sets the value for key <code class="xref any docutils literal notranslate"><span class="pre">&quot;/ExtGState&quot;</span></code> as a sub-object of <code class="xref any docutils literal notranslate"><span class="pre">&quot;/Resources&quot;</span></code>.</p></li>
<li><p><strong>value</strong> (<em>str</em>) – the value for the key. It must be a non-empty string and, depending on the desired PDF object type, the following rules must be observed. There is some syntax checking, but <strong>no type checking</strong> and no checking if it makes sense PDF-wise, i.e. <strong>no semantics checking</strong>. Upper / lower case is important!</p></li>
</ul>
</dd>
</dl>
<ul>
<li><p><strong>xref</strong> – must be provided as <code class="xref any docutils literal notranslate"><span class="pre">&quot;nnn</span> <span class="pre">0</span> <span class="pre">R&quot;</span></code> with a valid <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number nnn of the PDF. The suffix “<code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">R</span></code>” is required to be recognizable as an xref by PDF applications.</p></li>
<li><p><strong>array</strong> – a string like <code class="xref any docutils literal notranslate"><span class="pre">&quot;[a</span> <span class="pre">b</span> <span class="pre">c</span> <span class="pre">d</span> <span class="pre">e</span> <span class="pre">f]&quot;</span></code>. The brackets are required. Array items must be separated by at least one space (not commas like in Python). An empty array <code class="xref any docutils literal notranslate"><span class="pre">&quot;[]&quot;</span></code> is possible and <em>equivalent</em> to removing the key. Array items may be any PDF objects, like dictionaries, xrefs, other arrays, etc. Like in Python, array items may be of different types.</p></li>
<li><p><strong>dict</strong> – a string like <code class="xref any docutils literal notranslate"><span class="pre">&quot;&lt;&lt;</span> <span class="pre">...</span> <span class="pre">&gt;&gt;&quot;</span></code>. The brackets are required and must enclose a valid PDF dictionary definition. The empty dictionary <code class="xref any docutils literal notranslate"><span class="pre">&quot;&lt;&lt;&gt;&gt;&quot;</span></code> is possible and <em>equivalent</em> to removing the key.</p></li>
<li><p><strong>int</strong> – an integer formatted <strong>as a string</strong>.</p></li>
<li><p><strong>float</strong> – a float formatted <strong>as a string</strong>. Scientific notation (with exponents) is <strong>not allowed by PDF</strong>.</p></li>
<li><p><strong>null</strong> – the string <code class="xref any docutils literal notranslate"><span class="pre">&quot;null&quot;</span></code>. This is the PDF equivalent to Python’s <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> and causes the key to be ignored – however not necessarily removed, resp. removed on saves with garbage collection. <em>Changed in v1.19.4:</em> If the key is no path hierarchy (i.e. contains no slash “/”), then it will be completely removed.</p></li>
<li><p><strong>bool</strong> – one of the strings <code class="xref any docutils literal notranslate"><span class="pre">&quot;true&quot;</span></code> or <code class="xref any docutils literal notranslate"><span class="pre">&quot;false&quot;</span></code>.</p></li>
<li><p><strong>name</strong> – a valid PDF name with a leading slash like this: <code class="xref any docutils literal notranslate"><span class="pre">&quot;/PageLayout&quot;</span></code>. See page 16 of the <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>.</p></li>
<li><p><strong>string</strong> – a valid PDF string. <strong>All PDF strings must be enclosed by brackets</strong>. Denote the empty string as <code class="xref any docutils literal notranslate"><span class="pre">&quot;()&quot;</span></code>. Depending on its content, the possible brackets are</p>
<ul>
<li><p>“(…)” for ASCII-only text. Reserved PDF characters must be backslash-escaped and non-ASCII characters must be provided as 3-digit backslash-escaped octals – including leading zeros. Example: 12 = 0x0C must be encoded as <code class="xref any docutils literal notranslate"><span class="pre">014</span></code>.</p></li>
<li><p>“&lt;…&gt;” for hex-encoded text. Every character must be represented by two hex-digits (lower or upper case).</p></li>
<li><p>If in doubt, we <strong>strongly recommend</strong> to use <a class="reference internal" href="functions.html#get_pdf_str" title="get_pdf_str"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_pdf_str()</span></code></a>! This function automatically generates the right brackets, escapes, and overall format. It will for example do conversions like these:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># because of the € symbol, the following yields UTF-16BE BOM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pymupdf</span><span class="o">.</span><span class="n">get_pdf_str</span><span class="p">(</span><span class="s2">&quot;Pay in $ or €.&quot;</span><span class="p">)</span>
<span class="go">&#39;&lt;feff00500061007900200069006e002000240020006f0072002020ac002e&gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># escapes for brackets and non-ASCII</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pymupdf</span><span class="o">.</span><span class="n">get_pdf_str</span><span class="p">(</span><span class="s2">&quot;Prices in EUR (USD also accepted). Areas are in m².&quot;</span><span class="p">)</span>
<span class="go">&#39;(Prices in EUR \\(USD also accepted\\). Areas are in m\\262.)&#39;</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_pixmap">
<span class="sig-name descname"><span class="pre">get_page_pixmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">matrix_like</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">Identity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorspace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="colorspace.html#Colorspace" title="Colorspace"><span class="pre">Colorspace</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">csRGB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">rect_like</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_pixmap" title="Link to this definition">¶</a></dt>
<dd><p>Creates a pixmap from page <em>pno</em> (zero-based). Invokes <a class="reference internal" href="page.html#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a>.</p>
<p>All parameters except <code class="xref any docutils literal notranslate"><span class="pre">pno</span></code> are <em>keyword-only.</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – page number, 0-based in <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_xobjects">
<span class="sig-name descname"><span class="pre">get_page_xobjects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_xobjects" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.16.13</p></li>
<li><p>Changed in v1.18.11</p></li>
</ul>
<p>PDF only: Return a list of all XObjects referenced by a page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – page number, 0-based, <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>a list of (non-image) XObjects. These objects typically represent pages <em>embedded</em> (not copied) from other PDFs. For example, <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> will create this type of object. An item of this list has the following layout: <code class="xref any docutils literal notranslate"><span class="pre">(xref,</span> <span class="pre">name,</span> <span class="pre">invoker,</span> <span class="pre">bbox)</span></code>, where</p>
<ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) is the XObject’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>.</p></li>
<li><p><strong>name</strong> (<em>str</em>) is the symbolic name to reference the XObject.</p></li>
<li><p><strong>invoker</strong> (<em>int</em>) the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the invoking XObject or zero if the page directly invokes it.</p></li>
<li><p><strong>bbox</strong> (<a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>) the boundary box of the XObject’s location on the page <strong>in untransformed coordinates</strong>. To get actual, non-rotated page coordinates, multiply with the page’s transformation matrix <a class="reference internal" href="page.html#Page.transformation_matrix" title="Page.transformation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.transformation_matrix</span></code></a>. <em>Changed in v.18.11:</em> the bbox is now formatted as <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_images">
<span class="sig-name descname"><span class="pre">get_page_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_images" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Return a list of all images (directly or indirectly) referenced by the page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – page number, 0-based, <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>.</p></li>
<li><p><strong>full</strong> (<em>bool</em>) – whether to also include the referencer’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> (which is zero if this is the page).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>a list of images <strong>referenced</strong> by this page. Each item looks like</p>
<p><code class="xref any docutils literal notranslate"><span class="pre">(xref,</span> <span class="pre">smask,</span> <span class="pre">width,</span> <span class="pre">height,</span> <span class="pre">bpc,</span> <span class="pre">colorspace,</span> <span class="pre">alt_colorspace,</span> <span class="pre">name,</span> <span class="pre">filter,</span> <span class="pre">referencer)</span></code></p>
<p>Where</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) is the image object number</p></li>
<li><p><strong>smask</strong> (<em>int</em>) is the object number of its soft-mask image</p></li>
<li><p><strong>width</strong> (<em>int</em>) is the image width</p></li>
<li><p><strong>height</strong> (<em>int</em>) is the image height</p></li>
<li><p><strong>bpc</strong> (<em>int</em>) denotes the number of bits per component (normally 8)</p></li>
<li><p><strong>colorspace</strong> (<em>str</em>) a string naming the colorspace (like <strong>DeviceRGB</strong>)</p></li>
<li><p><strong>alt_colorspace</strong> (<em>str</em>) is any alternate colorspace depending on the value of <strong>colorspace</strong></p></li>
<li><p><strong>name</strong> (<em>str</em>) is the symbolic name by which the image is referenced</p></li>
<li><p><strong>filter</strong> (<em>str</em>) is the decode filter of the image (<a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>, pp. 22).</p></li>
<li><p><strong>referencer</strong> (<em>int</em>) the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the referencer. Zero if directly referenced by the page. Only present if <em>full=True</em>.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In general, this is not the list of images that are <strong>actually displayed</strong>. This method only parses several PDF objects to collect references to embedded images. It does not analyse the page’s <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a>, where all the actual image display commands are defined. To get this information, please use <a class="reference internal" href="page.html#Page.get_image_info" title="Page.get_image_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_info()</span></code></a>. Also have a look at the discussion in section <a class="reference internal" href="textpage.html#textpagedict"><span class="std std-ref">Structure of Dictionary Outputs</span></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_fonts">
<span class="sig-name descname"><span class="pre">get_page_fonts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_fonts" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Return a list of all fonts (directly or indirectly) referenced by the page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – page number, 0-based, <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>.</p></li>
<li><p><strong>full</strong> (<em>bool</em>) – whether to also include the referencer’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>. If <em>True</em>, the returned items are one entry longer. Use this option if you need to know, whether the page directly references the font. In this case the last entry is 0. If the font is referenced by an <code class="xref any docutils literal notranslate"><span class="pre">/XObject</span></code> of the page, you will find its <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> here.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of fonts referenced by this page. Each entry looks like</p>
</dd>
</dl>
<p><strong>(xref, ext, type, basefont, name, encoding, referencer)</strong>,</p>
<p>where</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) is the font object number (may be zero if the PDF uses one of the builtin fonts directly)</p></li>
<li><p><strong>ext</strong> (<em>str</em>) font file extension (e.g. “ttf”, see <a class="reference internal" href="vars.html#fontextensions"><span class="std std-ref">Font File Extensions</span></a>)</p></li>
<li><p><strong>type</strong> (<em>str</em>) is the font type (like “Type1” or “TrueType” etc.)</p></li>
<li><p><strong>basefont</strong> (<em>str</em>) is the base font name,</p></li>
<li><p><strong>name</strong> (<em>str</em>) is the symbolic name, by which the font is referenced</p></li>
<li><p><strong>encoding</strong> (<em>str</em>) the font’s character encoding if different from its built-in encoding (<a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>, p. 254):</p></li>
<li><p><strong>referencer</strong> (<em>int</em> optional) the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the referencer. Zero if directly referenced by the page, otherwise the xref of an XObject. Only present if <em>full=True</em>.</p></li>
</ul>
</div></blockquote>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">get_page_fonts</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">[(12, &#39;ttf&#39;, &#39;TrueType&#39;, &#39;FNUUTH+Calibri-Bold&#39;, &#39;R8&#39;, &#39;&#39;),</span>
<span class="go"> (13, &#39;ttf&#39;, &#39;TrueType&#39;, &#39;DOKBTG+Calibri&#39;, &#39;R10&#39;, &#39;&#39;),</span>
<span class="go"> (14, &#39;ttf&#39;, &#39;TrueType&#39;, &#39;NOHSJV+Calibri-Light&#39;, &#39;R12&#39;, &#39;&#39;),</span>
<span class="go"> (15, &#39;ttf&#39;, &#39;TrueType&#39;, &#39;NZNDCL+CourierNewPSMT&#39;, &#39;R14&#39;, &#39;&#39;),</span>
<span class="go"> (16, &#39;ttf&#39;, &#39;Type0&#39;, &#39;MNCSJY+SymbolMT&#39;, &#39;R17&#39;, &#39;Identity-H&#39;),</span>
<span class="go"> (17, &#39;cff&#39;, &#39;Type1&#39;, &#39;UAEUYH+Helvetica&#39;, &#39;R20&#39;, &#39;WinAnsiEncoding&#39;),</span>
<span class="go"> (18, &#39;ttf&#39;, &#39;Type0&#39;, &#39;ECPLRU+Calibri&#39;, &#39;R23&#39;, &#39;Identity-H&#39;),</span>
<span class="go"> (19, &#39;ttf&#39;, &#39;Type0&#39;, &#39;TONAYT+CourierNewPSMT&#39;, &#39;R27&#39;, &#39;Identity-H&#39;)]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This list has no duplicate entries: the combination of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>, <em>name</em> and <em>referencer</em> is unique.</p></li>
<li><p>In general, this is a superset of the fonts actually in use by this page. The PDF creator may e.g. have specified some global list, of which each page only makes partial use.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_text">
<span class="sig-name descname"><span class="pre">get_page_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">textpage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_text" title="Link to this definition">¶</a></dt>
<dd><p>Extracts the text of a page given its page number <em>pno</em> (zero-based). Invokes <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – page number, 0-based, any value <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>.</p>
</dd>
</dl>
<p>For other parameter refer to the page method.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method" id="index-2">
<dt class="sig sig-object py" id="Document.layout">
<span class="sig-name descname"><span class="pre">layout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.layout" title="Link to this definition">¶</a></dt>
<dd><p>Re-paginate (“reflow”) the document based on the given page dimension and fontsize. This only affects some document types like e-books and HTML. Ignored if not supported. Supported documents have <em>True</em> in property <a class="reference internal" href="#Document.is_reflowable" title="Document.is_reflowable"><code class="xref py py-attr docutils literal notranslate"><span class="pre">is_reflowable</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect_like</em>) – desired page size. Must be finite, not empty and start at point (0, 0).</p></li>
<li><p><strong>width</strong> (<em>float</em>) – use it together with <em>height</em> as alternative to <em>rect</em>.</p></li>
<li><p><strong>height</strong> (<em>float</em>) – use it together with <em>width</em> as alternative to <em>rect</em>.</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – the desired default fontsize.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.select" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Keeps only those pages of the document whose numbers occur in the list. Empty sequences or elements outside <code class="xref any docutils literal notranslate"><span class="pre">range(doc.page_count)</span></code> will cause a <em>ValueError</em>. For more details see remarks at the bottom or this chapter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> (<em>sequence</em>) – The sequence (see <a class="reference internal" href="app3.html#sequencetypes"><span class="std std-ref">Using Python Sequences as Arguments in PyMuPDF</span></a>) of page numbers (zero-based) to be included. Pages not in the sequence will be deleted (from memory) and become unavailable until the document is reopened. <strong>Page numbers can occur multiple times and in any order:</strong> the resulting document will reflect the sequence exactly as specified.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Page numbers in the sequence need not be unique nor be in any particular order. This makes the method a versatile utility to e.g. select only the even or the odd pages or meeting some other criteria and so forth.</p></li>
<li><p>On a technical level, the method will always create a new <a class="reference internal" href="glossary.html#pagetree" title="pagetree"><code class="xref py py-data docutils literal notranslate"><span class="pre">pagetree</span></code></a>.</p></li>
<li><p>When dealing with only a few pages, methods <a class="reference internal" href="#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_page()</span></code></a>, <a class="reference internal" href="#Document.move_page" title="Document.move_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">move_page()</span></code></a>, <a class="reference internal" href="#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_page()</span></code></a> are easier to use. In fact, they are also <strong>much faster</strong> – by at least one order of magnitude when the document has many pages.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_metadata">
<span class="sig-name descname"><span class="pre">set_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_metadata" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Sets or updates the metadata of the document as specified in <em>m</em>, a Python dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m</strong> (<em>dict</em>) – A dictionary with the same keys as <em>metadata</em> (see below). All keys are optional. A PDF’s format and encryption method cannot be set or changed and will be ignored. If any value should not contain data, do not specify its key or set the value to <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>. If you use <em>{}</em> all metadata information will be cleared to the string <em>“none”</em>. If you want to selectively change only some values, modify a copy of <em>doc.metadata</em> and use it as the argument. Arbitrary unicode values are possible if specified as UTF-8-encoded.</p>
</dd>
</dl>
<p><em>(Changed in v1.18.4)</em> Empty values or “none” are no longer written, but completely omitted.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_xml_metadata">
<span class="sig-name descname"><span class="pre">get_xml_metadata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_xml_metadata" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Get the document XML metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>XML metadata of the document. Empty string if not present or not a PDF.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_xml_metadata">
<span class="sig-name descname"><span class="pre">set_xml_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_xml_metadata" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Sets or updates XML metadata of the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xml</strong> (<em>str</em>) – the new XML metadata. Should be XML syntax, however no checking is done by this method and any string is accepted.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_pagelayout">
<span class="sig-name descname"><span class="pre">set_pagelayout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_pagelayout" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.22.2</p></li>
</ul>
<p>PDF only: Set the <code class="xref any docutils literal notranslate"><span class="pre">/PageLayout</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>str</em>) – one of the strings “SinglePage”, “OneColumn”, “TwoColumnLeft”, “TwoColumnRight”, “TwoPageLeft”, “TwoPageRight”. Lower case is supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_pagemode">
<span class="sig-name descname"><span class="pre">set_pagemode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_pagemode" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.22.2</p></li>
</ul>
<p>PDF only: Set the <code class="xref any docutils literal notranslate"><span class="pre">/PageMode</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>str</em>) – one of the strings “UseNone”, “UseOutlines”, “UseThumbs”, “FullScreen”, “UseOC”, “UseAttachments”. Lower case is supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_markinfo">
<span class="sig-name descname"><span class="pre">set_markinfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_markinfo" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.22.2</p></li>
</ul>
<p>PDF only: Set the <code class="xref any docutils literal notranslate"><span class="pre">/MarkInfo</span></code> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>dict</em>) – a dictionary like this one: <code class="xref any docutils literal notranslate"><span class="pre">{&quot;Marked&quot;:</span> <span class="pre">False,</span> <span class="pre">&quot;UserProperties&quot;:</span> <span class="pre">False,</span> <span class="pre">&quot;Suspects&quot;:</span> <span class="pre">False}</span></code>. This dictionary contains information about the usage of Tagged PDF conventions. For details please see the <a class="reference external" href="https://opensource.adobe.com/dc-acrobat-sdk-docs/standards/pdfstandards/pdf/PDF32000_2008.pdf">PDF specifications</a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_toc">
<span class="sig-name descname"><span class="pre">set_toc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_toc" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Replaces the <strong>complete current outline</strong> tree (table of contents) with the one provided as the argument. After successful execution, the new outline tree can be accessed as usual via <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> or via <a class="reference internal" href="#Document.outline" title="Document.outline"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.outline</span></code></a>. Like with other output-oriented methods, changes become permanent only via <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> (incremental save supported). Internally, this method consists of the following two steps. For a demonstration see example below.</p>
<ul class="simple">
<li><p>Step 1 deletes all existing bookmarks.</p></li>
<li><p>Step 2 creates a new TOC from the entries contained in <em>toc</em>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>toc</strong> (<em>sequence</em>) – <p>A list / tuple with <strong>all bookmark entries</strong> that should form the new table of contents. Output variants of <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_toc()</span></code></a> are acceptable. To completely remove the table of contents specify an empty sequence or None. Each item must be a list with the following format.</p>
<ul>
<li><p>[lvl, title, page [, dest]] where</p>
<ul>
<li><p><strong>lvl</strong> is the hierarchy level (int &gt; 0) of the item, which <strong>must be 1</strong> for the first item and at most 1 larger than the previous one.</p></li>
<li><p><strong>title</strong> (str) is the title to be displayed. It is assumed to be UTF-8-encoded (relevant for multibyte code points only).</p></li>
<li><p><strong>page</strong> (int) is the target page number <strong>(attention: 1-based)</strong>. Must be in valid range if positive. Set it to -1 if there is no target, or the target is external.</p></li>
<li><p><strong>dest</strong> (optional) is a dictionary or a number. If a number, it will be interpreted as the desired height (in points) this entry should point to on the page. Use a dictionary (like the one given as output by <code class="xref any docutils literal notranslate"><span class="pre">get_toc(False)</span></code>) for a detailed control of the bookmark’s properties, see <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> for a description.</p></li>
</ul>
</li>
</ul>
</p></li>
<li><p><strong>collapse</strong> (<em>int</em>) – <em>(new in v1.16.9)</em> controls the hierarchy level beyond which outline entries should initially show up collapsed. The default 1 will hence only display level 1, higher levels must be unfolded using the PDF viewer. To unfold everything, specify either a large integer, 0 or None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the number of inserted, resp. deleted items.</p>
</dd>
</dl>
<p>Changed in v1.23.8: Destination ‘to’ coordinates should now be in the
same coordinate system as those returned by <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_toc()</span></code></a> (internally they
are now transformed with <code class="xref any docutils literal notranslate"><span class="pre">page.cropbox</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">page.rotation_matrix</span></code>). So
for example <code class="xref any docutils literal notranslate"><span class="pre">set_toc(get_toc())</span></code> now gives unchanged destination ‘to’
coordinates.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.outline_xref">
<span class="sig-name descname"><span class="pre">outline_xref</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.outline_xref" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.17.7</p></li>
</ul>
<p>PDF only: Return the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the outline item. This is mainly used for internal purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em>) – index of the item in list <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.del_toc_item">
<span class="sig-name descname"><span class="pre">del_toc_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.del_toc_item" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.17.7</p></li>
<li><p>Changed in v1.18.14: no longer remove the item’s text, but show it grayed-out.</p></li>
</ul>
<p>PDF only: Remove this TOC item. This is a high-speed method, which <strong>disables</strong> the respective item, but leaves the overall TOC structure intact. Physically, the item still exists in the TOC tree, but is shown grayed-out and will no longer point to any destination.</p>
<p>This also implies that you can reassign the item to a new destination using <a class="reference internal" href="#Document.set_toc_item" title="Document.set_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_toc_item()</span></code></a>, when required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em>) – the index of the item in list <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_toc_item">
<span class="sig-name descname"><span class="pre">set_toc_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_toc_item" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.17.7</p></li>
<li><p>Changed in v1.18.6</p></li>
</ul>
<p>PDF only: Changes the TOC item identified by its index. Change the item <strong>title</strong>, <strong>destination</strong>, <strong>appearance</strong> (color, bold, italic) or collapsing sub-items – or to remove the item altogether.</p>
<p>Use this method if you need specific changes for selected entries only and want to avoid replacing the complete TOC. This is beneficial especially when dealing with large table of contents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – the index of the entry in the list created by <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a>.</p></li>
<li><p><strong>dest_dict</strong> (<em>dict</em>) – the new destination. A dictionary like the last entry of an item in <code class="xref any docutils literal notranslate"><span class="pre">doc.get_toc(False)</span></code>. Using this as a template is recommended. When given, <strong>all other parameters are ignored</strong> – except title.</p></li>
<li><p><strong>kind</strong> (<em>int</em>) – the link kind, see <a class="reference internal" href="vars.html#linkdest-kinds"><span class="std std-ref">Link Destination Kinds</span></a>. If <a class="reference internal" href="vars.html#LINK_NONE" title="LINK_NONE"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_NONE</span></code></a>, then all remaining parameter will be ignored, and the TOC item will be removed – same as <a class="reference internal" href="#Document.del_toc_item" title="Document.del_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.del_toc_item()</span></code></a>. If None, then only the title is modified and the remaining parameters are ignored. All other values will lead to making a new destination dictionary using the subsequent arguments.</p></li>
<li><p><strong>pno</strong> (<em>int</em>) – the 1-based page number, i.e. a value 1 &lt;= pno &lt;= doc.page_count. Required for LINK_GOTO.</p></li>
<li><p><strong>uri</strong> (<em>str</em>) – the URL text. Required for LINK_URI.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – the desired new title. None if no change.</p></li>
<li><p><strong>to</strong> (<em>point_like</em>) – (optional) points to a coordinate on the target page. Relevant for LINK_GOTO. If omitted, a point near the page’s top is chosen.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – required for LINK_GOTOR and LINK_LAUNCH.</p></li>
<li><p><strong>zoom</strong> (<em>float</em>) – use this zoom factor when showing the target page.</p></li>
</ul>
</dd>
</dl>
<p><strong>Example use:</strong> Change the TOC of the SWIG manual to achieve this:</p>
<p>Collapse everything below top level and show the chapter on Python support in red, bold and italic:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">=</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;SWIGDocumentation.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># we need the detailed TOC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># list of level 1 indices and their titles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lvl1</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">toc</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">lvl1</span><span class="p">:</span>
<span class="go">        d = toc[i][3]  # get the destination dict</span>
<span class="go">        d[&quot;collapse&quot;] = True  # collapse items underneath</span>
<span class="go">        if &quot;Python&quot; in title:  # show the &#39;Python&#39; chapter</span>
<span class="go">            d[&quot;color&quot;] = (1, 0, 0)  # in red,</span>
<span class="go">            d[&quot;bold&quot;] = True  # bold and</span>
<span class="go">            d[&quot;italic&quot;] = True  # italic</span>
<span class="go">        doc.set_toc_item(i, dest_dict=d)  # update this toc item</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;NEWSWIG.pdf&quot;</span><span class="p">,</span><span class="n">garbage</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>In the previous example, we have changed only 42 of the 1240 TOC items of the file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.bake">
<span class="sig-name descname"><span class="pre">bake</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">annots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">widgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.bake" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Convert annotations and / or widgets to become permanent parts of the pages. The PDF <strong>will be changed</strong> by this method. If <a class="reference internal" href="page.html#Page.widgets" title="Page.widgets"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">widgets</span></code></a> is <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>, the document will also no longer be a “Form PDF”.</p>
<p>All pages will look the same, but will no longer have annotations, respectively fields. The visible parts will be converted to standard text, vector graphics or images as required.</p>
<p>The method may thus be a viable <strong>alternative for PDF-to-PDF conversions</strong> using <a class="reference internal" href="#Document.convert_to_pdf" title="Document.convert_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a>.</p>
<p>Please consider that annotations are complex objects and may consist of more data “underneath” their visual appearance. Examples are “Text” and “FileAttachment” annotations. When “baking in” annotations / widgets with this method, all this underlying information (attached files, comments, associated PopUp annotations, etc.) will be lost and be removed on next garbage collection.</p>
<p>Use this feature for instance for <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> (which supports neither annotations nor widgets) when the source pages should look exactly the same in the target.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>annots</strong> (<em>bool</em>) – convert annotations.</p></li>
<li><p><strong>widgets</strong> (<em>bool</em>) – convert fields / widgets. After execution, the document will no longer be a “Form PDF”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.can_save_incrementally">
<span class="sig-name descname"><span class="pre">can_save_incrementally</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.can_save_incrementally" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.16.0</p></li>
</ul>
<p>Check whether the document can be saved incrementally. Use it to choose the right option without encountering exceptions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.scrub">
<span class="sig-name descname"><span class="pre">scrub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attached_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean_pages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedded_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">javascript</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redactions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redact_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_links</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_responses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thumbnails</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xml_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.scrub" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.16.14</p></li>
</ul>
<p>PDF only: Remove potentially sensitive data from the PDF. This function is inspired by the similar “Sanitize” function in Adobe Acrobat products. The process is configurable by a number of options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attached_files</strong> (<em>bool</em>) – Search for ‘FileAttachment’ annotations and remove the file content.</p></li>
<li><p><strong>clean_pages</strong> (<em>bool</em>) – Remove any comments from page painting sources. If this option is set to <em>False</em>, then this is also done for <em>hidden_text</em> and <em>redactions</em>.</p></li>
<li><p><strong>embedded_files</strong> (<em>bool</em>) – Remove embedded files.</p></li>
<li><p><strong>hidden_text</strong> (<em>bool</em>) – Remove OCRed text and invisible text <a class="footnote-reference brackets" href="#f7" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a>.</p></li>
<li><p><strong>javascript</strong> (<em>bool</em>) – Remove JavaScript sources.</p></li>
<li><p><strong>metadata</strong> (<em>bool</em>) – Remove PDF standard metadata.</p></li>
<li><p><strong>redactions</strong> (<em>bool</em>) – Apply redaction annotations.</p></li>
<li><p><strong>redact_images</strong> (<em>int</em>) – how to handle images if applying redactions. One of 0 (ignore), 1 (blank out overlaps) or 2 (remove).</p></li>
<li><p><strong>remove_links</strong> (<em>bool</em>) – Remove all links.</p></li>
<li><p><strong>reset_fields</strong> (<em>bool</em>) – Reset all form fields to their defaults.</p></li>
<li><p><strong>reset_responses</strong> (<em>bool</em>) – Remove all responses from all annotations.</p></li>
<li><p><strong>thumbnails</strong> (<em>bool</em>) – Remove thumbnail images from pages.</p></li>
<li><p><strong>xml_metadata</strong> (<em>bool</em>) – Remove XML metadata.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">garbage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflate_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflate_fonts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incremental</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_new_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encryption</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PDF_ENCRYPT_NONE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner_pw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_pw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_objstms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.save" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Changed in v1.18.7</p></li>
<li><p>Changed in v1.19.0</p></li>
<li><p>Changed in v1.24.1</p></li>
</ul>
<p>PDF only: Saves the document in its <strong>current state</strong>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outfile</strong> (<em>str</em><em>,</em><em>Path</em><em>,</em><em>fp</em>) – The file path, <code class="xref any docutils literal notranslate"><span class="pre">pathlib.Path</span></code> or file object to save to. A file object must have been created before via <code class="xref any docutils literal notranslate"><span class="pre">open(...)</span></code> or <code class="xref any docutils literal notranslate"><span class="pre">io.BytesIO()</span></code>. Choosing <code class="xref any docutils literal notranslate"><span class="pre">io.BytesIO()</span></code> is similar to <a class="reference internal" href="#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a> below, which equals the <code class="xref any docutils literal notranslate"><span class="pre">getvalue()</span></code> output of an internally created <code class="xref any docutils literal notranslate"><span class="pre">io.BytesIO()</span></code>.</p></li>
<li><p><strong>garbage</strong> (<em>int</em>) – <p>Do garbage collection. Positive values exclude “incremental”.</p>
<ul>
<li><p>0 = none</p></li>
<li><p>1 = remove unused (unreferenced) objects.</p></li>
<li><p>2 = in addition to 1, compact the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> table.</p></li>
<li><p>3 = in addition to 2, merge duplicate objects.</p></li>
<li><p>4 = in addition to 3, check <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a> objects for duplication. This may be slow because such data are typically large.</p></li>
</ul>
</p></li>
<li><p><strong>clean</strong> (<em>bool</em>) – Clean and sanitize content streams <a class="footnote-reference brackets" href="#f1" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. Corresponds to “mutool clean -sc”.</p></li>
<li><p><strong>deflate</strong> (<em>bool</em>) – Deflate (compress) uncompressed streams.</p></li>
<li><p><strong>deflate_images</strong> (<em>bool</em>) – <em>(new in v1.18.3)</em> Deflate (compress) uncompressed image streams <a class="footnote-reference brackets" href="#f4" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p></li>
<li><p><strong>deflate_fonts</strong> (<em>bool</em>) – <em>(new in v1.18.3)</em> Deflate (compress) uncompressed fontfile streams <a class="footnote-reference brackets" href="#f4" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p></li>
<li><p><strong>incremental</strong> (<em>bool</em>) – Only save changes to the PDF. Excludes “garbage” and “linear”. Can only be used if <em>outfile</em> is a string or a <code class="xref any docutils literal notranslate"><span class="pre">pathlib.Path</span></code> and equal to <a class="reference internal" href="#Document.name" title="Document.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.name</span></code></a>. Cannot be used for files that are decrypted or repaired and also in some other cases. To be sure, check <a class="reference internal" href="#Document.can_save_incrementally" title="Document.can_save_incrementally"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a>. If this is false, saving to a new file is required.</p></li>
<li><p><strong>ascii</strong> (<em>bool</em>) – convert binary data to ASCII.</p></li>
<li><p><strong>expand</strong> (<em>int</em>) – <p>Decompress objects. Generates versions that can be better read by some other programs and will lead to larger files.</p>
<ul>
<li><p>0 = none</p></li>
<li><p>1 = images</p></li>
<li><p>2 = fonts</p></li>
<li><p>255 = all</p></li>
</ul>
</p></li>
<li><p><strong>linear</strong> (<em>bool</em>) – Save a linearised version of the document. This option creates a file format for improved performance for Internet access. Excludes “incremental” and “use_objstms”.</p></li>
<li><p><strong>pretty</strong> (<em>bool</em>) – Prettify the document source for better readability. PDF objects will be reformatted to look like the default output of <a class="reference internal" href="#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a>.</p></li>
<li><p><strong>no_new_id</strong> (<em>bool</em>) – Suppress the update of the file’s <code class="xref any docutils literal notranslate"><span class="pre">/ID</span></code> field. If the file happens to have no such field at all, also suppress creation of a new one. Default is <code class="xref any docutils literal notranslate"><span class="pre">False</span></code>, so every save will lead to an updated file identification.</p></li>
<li><p><strong>permissions</strong> (<em>int</em>) – <em>(new in v1.16.0)</em> Set the desired permission levels. See <a class="reference internal" href="vars.html#permissioncodes"><span class="std std-ref">Document Permissions</span></a> for possible values. Default is granting all.</p></li>
<li><p><strong>encryption</strong> (<em>int</em>) – <em>(new in v1.16.0)</em> set the desired encryption method. See <a class="reference internal" href="vars.html#encryptionmethods"><span class="std std-ref">PDF encryption method codes</span></a> for possible values.</p></li>
<li><p><strong>owner_pw</strong> (<em>str</em>) – <em>(new in v1.16.0)</em> set the document’s owner password. <em>(Changed in v1.18.3)</em> If not provided, the user password is taken if provided. The string length must not exceed 40 characters.</p></li>
<li><p><strong>user_pw</strong> (<em>str</em>) – <em>(new in v1.16.0)</em> set the document’s user password. The string length must not exceed 40 characters.</p></li>
<li><p><strong>use_objstms</strong> (<em>int</em>) – <em>(new in v1.24.0)</em> compression option that converts eligible PDF object definitions to information that is stored in some other object’s <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a> data. Depending on the <code class="xref any docutils literal notranslate"><span class="pre">deflate</span></code> parameter value, the converted object definitions will be compressed – which can lead to very significant file size reductions.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The method does not check, whether a file of that name already exists, will hence not ask for confirmation, and overwrite the file. It is your responsibility as a programmer to handle this.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>File size reduction</strong></p>
<p>1. Use the save options like <code class="xref any docutils literal notranslate"><span class="pre">garbage=3|4,</span> <span class="pre">deflate=True,</span> <span class="pre">use_objstms=True|1</span></code>. Do not touch the default values <code class="xref any docutils literal notranslate"><span class="pre">expand=False|0,</span> <span class="pre">clean=False|0,</span> <span class="pre">incremental=False|0,</span> <span class="pre">linear=False|0</span></code>.
This is a “lossless” file size reduction. There is a convenience version of this method with these values set by default, <a class="reference internal" href="#Document.ez_save" title="Document.ez_save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.ez_save()</span></code></a> – please see below.</p>
<ol class="arabic simple" start="2">
<li><p>“Lossy” file size reduction in essence must give up something with respect to images, like (a) remove all images (b) replace images by their grayscale versions (c) reduce image resolutions. Find examples in the <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/replace-image">PyMuPDF Utilities “replace-image” folder</a>.</p></li>
</ol>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.ez_save">
<span class="sig-name descname"><span class="pre">ez_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.ez_save" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.11</p></li>
</ul>
<p>PDF only: The same as <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> but with changed defaults <code class="xref any docutils literal notranslate"><span class="pre">deflate=True,</span> <span class="pre">garbage=3,</span> <span class="pre">use_objstms=1</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.saveIncr">
<span class="sig-name descname"><span class="pre">saveIncr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.saveIncr" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: saves the document incrementally. This is a convenience abbreviation for <em>doc.save(doc.name, incremental=True, encryption=PDF_ENCRYPT_KEEP)</em>.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Saving incrementally may be required if the document contains verified signatures which would be invalidated by saving to a new file.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="Document.tobytes">
<span class="sig-name descname"><span class="pre">tobytes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">garbage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflate_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflate_fonts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_new_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encryption</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PDF_ENCRYPT_NONE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner_pw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_pw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_objstms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.tobytes" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Changed in v1.18.7</p></li>
<li><p>Changed in v1.19.0</p></li>
<li><p>Changed in v1.24.1</p></li>
</ul>
<p>PDF only: Writes the <strong>current content of the document</strong> to a bytes object instead of to a file. Obviously, you should be wary about memory requirements. The meanings of the parameters exactly equal those in <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a>. Chapter <a class="reference internal" href="faq.html#faq"><span class="std std-ref">FAQ</span></a> contains an example for using this method as a pre-processor to <a class="reference external" href="https://pypi.python.org/pypi/pdfrw/0.3">pdfrw</a>.</p>
<p><em>(Changed in v1.16.0)</em> for extended encryption support.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bytes</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a bytes object containing the complete document.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.search_page_for">
<span class="sig-name descname"><span class="pre">search_page_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.search_page_for" title="Link to this definition">¶</a></dt>
<dd><p>Search for “text” on page number “pno”. Works exactly like the corresponding <a class="reference internal" href="page.html#Page.search_for" title="Page.search_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.search_for()</span></code></a>. Any integer <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code> is acceptable.</p>
</dd></dl>

<dl class="py method" id="index-3">
<dt class="sig sig-object py" id="Document.insert_pdf">
<span class="sig-name descname"><span class="pre">insert_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">docsrc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_at</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">links</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">widgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join_duplicates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.insert_pdf" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Copy the page range <strong>[from_page, to_page]</strong> (including both) of PDF document <em>docsrc</em> into the current one. Inserts will start with page number <em>start_at</em>. Value -1 indicates default values. All pages thus copied will be rotated as specified. Links, annotations and widgets can be excluded in the target, see below. All page numbers are 0-based.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>docsrc</strong> (<em>Document</em>) – An opened PDF <em>Document</em> which must not be the current document. However, it may refer to the same underlying file.</p></li>
<li><p><strong>from_page</strong> (<em>int</em>) – First page number in <em>docsrc</em>. Default is zero.</p></li>
<li><p><strong>to_page</strong> (<em>int</em>) – Last page number in <em>docsrc</em> to copy. Defaults to last page.</p></li>
<li><p><strong>start_at</strong> (<em>int</em>) – First copied page, will become page number <em>start_at</em> in the target. Default -1 appends the page range to the end. If zero, the page range will be inserted before current first page.</p></li>
<li><p><strong>rotate</strong> (<em>int</em>) – All copied pages will be rotated by the provided value (degrees, integer multiple of 90).</p></li>
<li><p><strong>links</strong> (<em>bool</em>) – Choose whether (internal and external) links should be included in the copy. Default is <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>. <em>Named</em> links (<a class="reference internal" href="vars.html#LINK_NAMED" title="LINK_NAMED"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_NAMED</span></code></a>) and internal links to outside the copied page range are <strong>always excluded</strong>.</p></li>
<li><p><strong>annots</strong> (<em>bool</em>) – choose whether annotations should be included in the copy.</p></li>
<li><p><strong>widgets</strong> (<em>bool</em>) – choose whether annotations should be included in the copy. If <code class="xref any docutils literal notranslate"><span class="pre">True</span></code> and at least one of the source pages contains form fields, the target PDF will be turned into a Form PDF (if not already being one).</p></li>
<li><p><strong>join_duplicates</strong> (<em>bool</em>) – <p><em>(New in version 1.25.5)</em> Choose how to handle duplicate root field names in the source pages. This parameter is ignored if <code class="xref any docutils literal notranslate"><span class="pre">widgets=False</span></code>.</p>
<p>Default is <code class="docutils literal notranslate"><span class="pre">False</span></code> which will add unifying strings to the name of those source root fields which have a duplicate in the target. For instance, if “name” already occurs in the target, the source widget’s name will be changed to “name [text]” with a suitably chosen string “text”.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, root fields with duplicate names in source and target will be converted to so-called “Kids” of a “Parent” object (which lists all kid widgets in a PDF array). This will effectively turn those kids into instances of the “same” widget: if e.g. one of the kids is changed, then all its instances will automatically inherit this change – no matter on which page they happen to be displayed.</p>
</p></li>
<li><p><strong>show_progress</strong> (<em>int</em>) – <em>(new in v1.17.7)</em> specify an interval size greater zero to see progress messages on <code class="xref any docutils literal notranslate"><span class="pre">sys.stdout</span></code>. After each interval, a message like <code class="xref any docutils literal notranslate"><span class="pre">Inserted</span> <span class="pre">30</span> <span class="pre">of</span> <span class="pre">47</span> <span class="pre">pages.</span></code> will be printed.</p></li>
<li><p><strong>final</strong> (<em>int</em>) – <em>(new in v1.18.0)</em> controls whether the list of already copied objects should be <strong>dropped</strong> after this method, default <em>True</em>. Set it to 0 except for the last one of multiple insertions from the same source PDF. This saves target file size and speeds up execution considerably.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>This is a page-based method. Document-level information of source documents is therefore mostly ignored. Examples include Optional Content, Embedded Files, <code class="xref any docutils literal notranslate"><span class="pre">StructureElem</span></code>, table of contents, page labels, metadata, named destinations (and other named entries) and some more.</p></li>
<li><p>If <code class="xref any docutils literal notranslate"><span class="pre">from_page</span> <span class="pre">&gt;</span> <span class="pre">to_page</span></code>, pages will be <strong>copied in reverse order</strong>. If <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">from_page</span> <span class="pre">==</span> <span class="pre">to_page</span></code>, then one page will be copied.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">docsrc</span></code> TOC entries <strong>will not be copied</strong>. It is easy however, to recover a table of contents for the resulting document. Look at the examples below and at program <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py">join.py</a> in the <em>examples</em> directory: it can join PDF documents and at the same time piece together respective parts of the tables of contents.</p></li>
</ol>
</div>
<dl class="py method" id="index-4">
<dt class="sig sig-object py" id="Document.insert_file">
<span class="sig-name descname"><span class="pre">insert_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_at</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">links</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.insert_file" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.22.0</p></li>
</ul>
<p>PDF only: Add an arbitrary supported document to the current PDF. Opens “infile” as a document, converts it to a PDF and then invokes <a class="reference internal" href="#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a>. Parameters are the same as for that method. Among other things, this features an easy way to append images as full pages to an output PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>multiple</em>) – the input document to insert. May be a filename specification as is valid for creating a <a class="reference internal" href="#document"><span class="std std-ref">Document</span></a> or a <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method" id="index-5">
<dt class="sig sig-object py" id="Document.new_page">
<span class="sig-name descname"><span class="pre">new_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">595</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">842</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.new_page" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Insert an empty page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – page number in front of which the new page should be inserted. Must be in <em>1 &lt; pno &lt;= page_count</em>. Special values -1 and <em>doc.page_count</em> insert <strong>after</strong> the last page.</p></li>
<li><p><strong>width</strong> (<em>float</em>) – page width.</p></li>
<li><p><strong>height</strong> (<em>float</em>) – page height.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the created page object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method" id="index-6">
<dt class="sig sig-object py" id="Document.insert_page">
<span class="sig-name descname"><span class="pre">insert_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">595</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">842</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'helv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.insert_page" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Insert a new page and insert some text. Convenience function which combines <a class="reference internal" href="#Document.new_page" title="Document.new_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a> and (parts of) <a class="reference internal" href="page.html#Page.insert_text" title="Page.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_text()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – <p>page number (0-based) <strong>in front of which</strong> to insert. Must be in <code class="xref any docutils literal notranslate"><span class="pre">range(-1,</span> <span class="pre">doc.page_count</span> <span class="pre">+</span> <span class="pre">1)</span></code>. Special values -1 and <code class="xref any docutils literal notranslate"><span class="pre">doc.page_count</span></code> insert <strong>after</strong> the last page.</p>
<dl class="simple">
<dt>Changed in v1.14.12</dt><dd><p>This is now a positional parameter</p>
</dd>
</dl>
</p>
</dd>
</dl>
<p>For the other parameters, please consult the aforementioned methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the result of <a class="reference internal" href="page.html#Page.insert_text" title="Page.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_text()</span></code></a> (number of successfully inserted lines).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.delete_page">
<span class="sig-name descname"><span class="pre">delete_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.delete_page" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Delete a page given by its 0-based number in <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span> <span class="pre">-</span> <span class="pre">1</span></code>.</p>
<ul class="simple">
<li><p>Changed in v1.18.14: support Python’s <code class="xref any docutils literal notranslate"><span class="pre">del</span></code> statement.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – the page to be deleted. Negative number count backwards from the end of the document (like with indices). Default is the last page.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.delete_pages">
<span class="sig-name descname"><span class="pre">delete_pages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.delete_pages" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Changed in v1.18.13: more flexibility specifying pages to delete.</p></li>
<li><p>Changed in v1.18.14: support Python’s <code class="xref any docutils literal notranslate"><span class="pre">del</span></code> statement.</p></li>
</ul>
<p>PDF only: Delete multiple pages given as 0-based numbers.</p>
<dl class="simple">
<dt><strong>Format 1:</strong> Use keywords. Represents the old format. A contiguous range of pages is removed.</dt><dd><ul class="simple">
<li><p>“from_page”: first page to delete. Zero if omitted.</p></li>
<li><p>“to_page”: last page to delete. Last page in document if omitted. Must not be less then “from_page”.</p></li>
</ul>
</dd>
</dl>
<p><strong>Format 2:</strong> Two page numbers as positional parameters. Handled like Format 1.</p>
<p><strong>Format 3:</strong> One positional integer parameter. Equivalent to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.delete_page()</span></code>.</p>
<p><strong>Format 4:</strong> One positional parameter of type <em>list</em>, <em>tuple</em> or <em>range()</em> of page numbers. The items of this sequence may be in any order and may contain duplicates.</p>
<p><strong>Format 5:</strong> <em>(New in v1.18.14)</em> Using the Python <code class="xref any docutils literal notranslate"><span class="pre">del</span></code> statement and index / slice notation is now possible.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>(Changed in v1.14.17, optimized in v1.17.7)</em> In an effort to maintain a valid PDF structure, this method and <a class="reference internal" href="#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_page()</span></code></a> will also deactivate items in the table of contents which point to deleted pages. “Deactivation” here means, that the bookmark will point to nowhere and the title will be shown grayed-out by supporting PDF viewers. The overall TOC structure is left intact.</p>
<p>It will also remove any <strong>links on remaining pages</strong> which point to a deleted one. This action may have an extended response time for documents with many pages.</p>
<p>Following examples will all delete pages 500 through 519:</p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">doc.delete_pages(500,</span> <span class="pre">519)</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">doc.delete_pages(from_page=500,</span> <span class="pre">to_page=519)</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">doc.delete_pages((500,</span> <span class="pre">501,</span> <span class="pre">502,</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">519))</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">doc.delete_pages(range(500,</span> <span class="pre">520))</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">del</span> <span class="pre">doc[500:520]</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">del</span> <span class="pre">doc[(500,</span> <span class="pre">501,</span> <span class="pre">502,</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">519)]</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">del</span> <span class="pre">doc[range(500,</span> <span class="pre">520)]</span></code></p></li>
</ul>
<p>For the <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a> the above takes about 0.6 seconds, because the remaining 1290 pages must be cleaned from invalid links.</p>
<p>In general, the performance of this method is dependent on the number of remaining pages – <strong>not</strong> on the number of deleted pages: in the above example, <strong>deleting all pages except</strong> those 20, will need much less time.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.copy_page">
<span class="sig-name descname"><span class="pre">copy_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.copy_page" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Copy a page reference within the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – the page to be copied. Must be in range <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>.</p></li>
<li><p><strong>to</strong> (<em>int</em>) – the page number in front of which to copy. The default inserts <strong>after</strong> the last page.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only a new <strong>reference</strong> to the page object will be created – not a new page object, all copied pages will have identical attribute values, including the <a class="reference internal" href="page.html#Page.xref" title="Page.xref"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.xref</span></code></a>. This implies that any changes to one of these copies will appear on all of them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.fullcopy_page">
<span class="sig-name descname"><span class="pre">fullcopy_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.fullcopy_page" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.14.17</p></li>
</ul>
<p>PDF only: Make a full copy (duplicate) of a page.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – the page to be duplicated. Must be in range <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>.</p></li>
<li><p><strong>to</strong> (<em>int</em>) – the page number in front of which to copy. The default inserts <strong>after</strong> the last page.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>In contrast to <a class="reference internal" href="#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_page()</span></code></a>, this method creates a new page object (with a new <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>), which can be changed independently from the original.</p></li>
<li><p>Any Popup and “IRT” (“in response to”) annotations are <strong>not copied</strong> to avoid potentially incorrect situations.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.move_page">
<span class="sig-name descname"><span class="pre">move_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.move_page" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Move (copy and then delete original) a page within the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – the page to be moved. Must be in range <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>.</p></li>
<li><p><strong>to</strong> (<em>int</em>) – the page number in front of which to insert the moved page. The default moves <strong>after</strong> the last page.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.need_appearances">
<span class="sig-name descname"><span class="pre">need_appearances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.need_appearances" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.17.4</p></li>
</ul>
<p>PDF only: Get or set the <em>/NeedAppearances</em> property of Form PDFs. Quote: <em>“(Optional) A flag specifying whether to construct appearance streams and appearance dictionaries for all widget annotations in the document … Default value: false.”</em> This may help controlling the behavior of some readers / viewers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>bool</em>) – set the property to this value. If omitted or <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>, inquire the current value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>None: not a Form PDF, or property not defined.</p></li>
<li><p>True / False: the value of the property (either just set or existing for inquiries). Has no effect if no Form PDF.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_sigflags">
<span class="sig-name descname"><span class="pre">get_sigflags</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_sigflags" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Return whether the document contains signature fields. This is an optional PDF property: if not present (return value -1), no conclusions can be drawn – the PDF creator may just not have bothered using it.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>-1: not a Form PDF / no signature fields recorded / no <em>SigFlags</em> found.</p></li>
<li><p>1: at least one signature field exists.</p></li>
<li><p>3:  contains signatures that may be invalidated if the file is saved (written) in a way that alters its previous contents, as opposed to an incremental update.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method" id="index-7">
<dt class="sig sig-object py" id="Document.embfile_add">
<span class="sig-name descname"><span class="pre">embfile_add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ufilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_add" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Changed in v1.14.16: The sequence of positional parameters “name” and “buffer” has been changed to comply with the call pattern of other functions.</p></li>
</ul>
<p>PDF only: Embed a new file. All string parameters except the name may be unicode (in previous versions, only ASCII worked correctly). File contents will be compressed (where beneficial).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – entry identifier, <strong>must not already exist</strong>.</p></li>
<li><p><strong>buffer</strong> (<em>bytes</em><em>,</em><em>bytearray</em><em>,</em><em>BytesIO</em>) – <p>file contents.</p>
<p><em>(Changed in v1.14.13)</em> <em>io.BytesIO</em> is now also supported.</p>
</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – optional filename. Documentation only, will be set to <em>name</em> if <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>ufilename</strong> (<em>str</em>) – optional unicode filename. Documentation only, will be set to <em>filename</em> if <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>desc</strong> (<em>str</em>) – optional description. Documentation only, will be set to <em>name</em> if <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>(Changed in v1.18.13)</em> The method now returns the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the inserted file. In addition, the file object now will be automatically given the PDF keys <code class="xref any docutils literal notranslate"><span class="pre">/CreationDate</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">/ModDate</span></code> based on the current date-time.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.embfile_count">
<span class="sig-name descname"><span class="pre">embfile_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_count" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Changed in v1.14.16: This is now a method. In previous versions, this was a property.</p></li>
</ul>
<p>PDF only: Return the number of embedded files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.embfile_get">
<span class="sig-name descname"><span class="pre">embfile_get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_get" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Retrieve the content of embedded file by its entry number or name. If the document is not a PDF, or entry cannot be found, an exception is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>item</strong> (<em>int</em><em>,</em><em>str</em>) – index or name of entry. An integer must be in <code class="xref any docutils literal notranslate"><span class="pre">range(embfile_count())</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.embfile_del">
<span class="sig-name descname"><span class="pre">embfile_del</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_del" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Changed in v1.14.16: Items can now be deleted by index, too.</p></li>
</ul>
<p>PDF only: Remove an entry from <code class="xref any docutils literal notranslate"><span class="pre">/EmbeddedFiles</span></code>. As always, physical deletion of the embedded file content (and file space regain) will occur only when the document is saved to a new file with a suitable garbage option.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>item</strong> (<em>int/str</em>) – index or name of entry.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When specifying an entry name, this function will only <strong>delete the first item</strong> with that name. Be aware that PDFs not created with PyMuPDF may contain duplicate names. So you may want to take appropriate precautions.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.embfile_info">
<span class="sig-name descname"><span class="pre">embfile_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_info" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Changed in v1.18.13</p></li>
</ul>
<p>PDF only: Retrieve information of an embedded file given by its number or by its name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>item</strong> (<em>int/str</em>) – index or name of entry. An integer must be in <code class="xref any docutils literal notranslate"><span class="pre">range(embfile_count())</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>a dictionary with the following keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> – (<em>str</em>) name under which this entry is stored</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filename</span></code> – (<em>str</em>) filename</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ufilename</span></code> – (<em>unicode</em>) filename</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> – (<em>str</em>) description</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code> – (<em>int</em>) original file size</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">length</span></code> – (<em>int</em>) compressed file length</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">creationDate</span></code> – (<em>str</em>) date-time of item creation in PDF format</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modDate</span></code> – (<em>str</em>) date-time of last change in PDF format</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">collection</span></code> – (<em>int</em>) <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the associated PDF portfolio item if any, else zero.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">checksum</span></code> – (<em>str</em>) a hashcode of the stored file content as a hexadecimal string. Should be MD5 according to PDF specifications, but be prepared to see other hashing algorithms.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.embfile_names">
<span class="sig-name descname"><span class="pre">embfile_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_names" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Return a list of embedded file names. The sequence of the names equals the physical sequence in the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method" id="index-8">
<dt class="sig sig-object py" id="Document.embfile_upd">
<span class="sig-name descname"><span class="pre">embfile_upd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ufilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_upd" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Change an embedded file given its entry number or name. All parameters are optional. Letting them default leads to a no-operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item</strong> (<em>int/str</em>) – index or name of entry. An integer must be in <code class="xref any docutils literal notranslate"><span class="pre">range(embfile_count())</span></code>.</p></li>
<li><p><strong>buffer</strong> (<em>bytes</em><em>,</em><em>bytearray</em><em>,</em><em>BytesIO</em>) – <p>the new file content.</p>
<p><em>(Changed in v1.14.13)</em> <em>io.BytesIO</em> is now also supported.</p>
</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – the new filename.</p></li>
<li><p><strong>ufilename</strong> (<em>str</em>) – the new unicode filename.</p></li>
<li><p><strong>desc</strong> (<em>str</em>) – the new description.</p></li>
</ul>
</dd>
</dl>
<p><em>(Changed in v1.18.13)</em>  The method now returns the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the file object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>xref of the file object. Automatically, its <code class="xref any docutils literal notranslate"><span class="pre">/ModDate</span></code> PDF key will be updated with the current date-time.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.close" title="Link to this definition">¶</a></dt>
<dd><p>Release objects and space allocations associated with the document. If created from a file, also closes <em>filename</em> (releasing control to the OS). Explicitly closing a document is equivalent to deleting it, <code class="xref any docutils literal notranslate"><span class="pre">del</span> <span class="pre">doc</span></code>, or assigning it to something else like <code class="xref any docutils literal notranslate"><span class="pre">doc</span> <span class="pre">=</span> <span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_object">
<span class="sig-name descname"><span class="pre">xref_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compressed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_object" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.16.8</p></li>
<li><p>Changed in v1.18.10</p></li>
</ul>
<p>PDF only: Return the definition source of a PDF object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – the object’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>. <em>Changed in v1.18.10:</em> A value of <code class="xref any docutils literal notranslate"><span class="pre">-1</span></code> returns the PDF trailer source.</p></li>
<li><p><strong>compressed</strong> (<em>bool</em>) – whether to generate a compact output with no line breaks or spaces.</p></li>
<li><p><strong>ascii</strong> (<em>bool</em>) – whether to ASCII-encode binary data.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The object definition source.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.pdf_catalog">
<span class="sig-name descname"><span class="pre">pdf_catalog</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.pdf_catalog" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.16.8</p></li>
</ul>
<p>PDF only: Return the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number of the PDF catalog (or root) object. Use that number with <a class="reference internal" href="#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a> to see its source.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.pdf_trailer">
<span class="sig-name descname"><span class="pre">pdf_trailer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compressed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.pdf_trailer" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.16.8</p></li>
</ul>
<p>PDF only: Return the trailer source of the PDF,  which is usually located at the PDF file’s end. This is <a class="reference internal" href="#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a> with an <em>xref</em> argument of -1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_stream">
<span class="sig-name descname"><span class="pre">xref_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_stream" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.16.8</p></li>
</ul>
<p>PDF only: Return the <strong>decompressed</strong> contents of the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> stream object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the (decompressed) stream of the object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_stream_raw">
<span class="sig-name descname"><span class="pre">xref_stream_raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_stream_raw" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.16.8</p></li>
</ul>
<p>PDF only: Return the <strong>unmodified</strong> (esp. <strong>not decompressed</strong>) contents of the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> stream object. Otherwise equal to <a class="reference internal" href="#Document.xref_stream" title="Document.xref_stream"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_stream()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bytes</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the (original, unmodified) stream of the object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.update_object">
<span class="sig-name descname"><span class="pre">update_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.update_object" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.16.8</p></li>
</ul>
<p>PDF only: Replace object definition of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> with the provided string. The xref may also be new, in which case this instruction completes the object definition. If a page object is also given, its links and annotations will be reloaded afterwards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number.</p></li>
<li><p><strong>obj_str</strong> (<em>str</em>) – a string containing a valid PDF object definition.</p></li>
<li><p><strong>page</strong> (<a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a>) – a page object. If provided, indicates, that annotations of this page should be refreshed (reloaded) to reflect changes incurred with links and / or annotations.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>zero if successful, otherwise an exception will be raised.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.update_stream">
<span class="sig-name descname"><span class="pre">update_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.update_stream" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v.1.16.8</p></li>
<li><p>Changed in v1.19.2: added parameter “compress”</p></li>
<li><p>Changed in v1.19.6: deprecated parameter “new”. Now confirms that the object is a PDF dictionary object.</p></li>
</ul>
<p>Replace the stream of an object identified by <em>xref</em>, which must be a PDF dictionary. If the object is no <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a>, it will be turned into one. The function automatically performs a compress operation (“deflate”) where beneficial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number.</p></li>
<li><p><strong>stream</strong> (<em>bytes</em><em>|</em><em>bytearray</em><em>|</em><em>BytesIO</em>) – <p>the new content of the stream.</p>
<p><em>(Changed in v1.14.13:)</em> <em>io.BytesIO</em> objects are now also supported.</p>
</p></li>
<li><p><strong>new</strong> (<em>bool</em>) – <em>deprecated</em> and ignored. Will be removed some time after v1.20.0.</p></li>
<li><p><strong>compress</strong> (<em>bool</em>) – whether to compress the inserted stream. If <code class="xref any docutils literal notranslate"><span class="pre">True</span></code> (default), the stream will be inserted using <code class="xref any docutils literal notranslate"><span class="pre">/FlateDecode</span></code> compression (if beneficial), otherwise the stream will inserted as is.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <em>xref</em> does not represent a PDF <code class="xref py py-data docutils literal notranslate"><span class="pre">dict</span></code>. An empty dictionary <code class="docutils literal notranslate"><span class="pre">&lt;&lt;&gt;&gt;</span></code> is accepted. So if you just created the xref and want to give it a stream, first execute <code class="xref any docutils literal notranslate"><span class="pre">doc.update_object(xref,</span> <span class="pre">&quot;&lt;&lt;&gt;&gt;&quot;)</span></code>, and then insert the stream data with this method.</p>
</dd>
</dl>
<p>The method is primarily (but not exclusively) intended to manipulate streams containing PDF operator syntax (see pp. 643 of the <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>) as it is the case for e.g. page content streams.</p>
<p>If you update a contents stream, consider using save parameter <em>clean=True</em> to ensure consistency between PDF operator source and the object structure.</p>
<p>Example: Let us assume that you no longer want a certain image appear on a page. This can be achieved by deleting the respective reference in its contents source(s) – and indeed: the image will be gone after reloading the page. But the page’s <a class="reference internal" href="glossary.html#resources" title="resources"><code class="xref py py-data docutils literal notranslate"><span class="pre">resources</span></code></a> object would still show the image as being referenced by the page. This save option will clean up any such mismatches.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_copy">
<span class="sig-name descname"><span class="pre">xref_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_copy" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.19.5</p></li>
</ul>
<p>PDF Only: Make <em>target</em> xref an exact copy of <em>source</em>. If <em>source</em> is a <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a>, then these data are also copied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>int</em>) – the source <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>. It must be an existing <strong>dictionary</strong> object.</p></li>
<li><p><strong>target</strong> (<em>int</em>) – the target xref. Must be an existing <strong>dictionary</strong> object. If the xref has just been created, make sure to initialize it as a PDF dictionary with the minimum specification <code class="docutils literal notranslate"><span class="pre">&lt;&lt;&gt;&gt;</span></code>.</p></li>
<li><p><strong>keep</strong> (<em>list</em>) – an optional list of top-level keys in <em>target</em>, that should not be removed in preparation of the copy process.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>This method has much in common with Python’s <em>dict</em> method <a class="reference internal" href="pixmap.html#Pixmap.copy" title="Pixmap.copy"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">copy()</span></code></a>.</p></li>
<li><p>Both xref numbers must represent existing dictionaries.</p></li>
<li><p>Before data is copied from <em>source</em>, all <em>target</em> dictionary keys are deleted. You can specify exceptions from this in the <em>keep</em> list. If <em>source</em> however has a same-named key, its value will still replace the target.</p></li>
<li><p>If <em>source</em> is a <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a> object, then these data will also be copied over, and <em>target</em> will be converted to a stream object.</p></li>
<li><p>A typical use case is to replace or remove an existing image without using redaction annotations. Example scripts can be seen <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/replace-image">here</a>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.extract_image">
<span class="sig-name descname"><span class="pre">extract_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.extract_image" title="Link to this definition">¶</a></dt>
<dd><p>PDF Only: Extract data and meta information of an image stored in the document. The output can directly be used to be stored as an image file, as input for PIL, <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> creation, etc. This method avoids using pixmaps wherever possible to present the image in its original format (e.g. as JPEG).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of an image object. If this is not in <code class="xref any docutils literal notranslate"><span class="pre">range(1,</span> <span class="pre">doc.xref_length())</span></code>, or the object is no image or other errors occur, <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> is returned and no exception is raised.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>a dictionary with the following keys</p>
<ul class="simple">
<li><p><em>ext</em> (<em>str</em>) image type (e.g. <em>‘jpeg’</em>), usable as image file extension</p></li>
<li><p><em>smask</em> (<em>int</em>) <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number of a stencil (/SMask) image or zero</p></li>
<li><p><em>width</em> (<em>int</em>) image width</p></li>
<li><p><em>height</em> (<em>int</em>) image height</p></li>
<li><p><em>colorspace</em> (<em>int</em>) the image’s <em>colorspace.n</em> number.</p></li>
<li><p><em>cs-name</em> (<em>str</em>) the image’s <em>colorspace.name</em>.</p></li>
<li><p><em>xres</em> (<em>int</em>) resolution in x direction. Please also see <a class="reference internal" href="glossary.html#resolution" title="resolution"><code class="xref py py-data docutils literal notranslate"><span class="pre">resolution</span></code></a>.</p></li>
<li><p><em>yres</em> (<em>int</em>) resolution in y direction. Please also see <a class="reference internal" href="glossary.html#resolution" title="resolution"><code class="xref py py-data docutils literal notranslate"><span class="pre">resolution</span></code></a>.</p></li>
<li><p><em>image</em> (<em>bytes</em>) image data, usable as image file content</p></li>
</ul>
</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">extract_image</span><span class="p">(</span><span class="mi">1373</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">{&#39;ext&#39;: &#39;png&#39;, &#39;smask&#39;: 2934, &#39;width&#39;: 5, &#39;height&#39;: 629, &#39;colorspace&#39;: 3, &#39;xres&#39;: 96,</span>
<span class="go">&#39;yres&#39;: 96, &#39;cs-name&#39;: &#39;DeviceRGB&#39;,</span>
<span class="go">&#39;image&#39;: b&#39;\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x05\ ...&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;image.</span><span class="si">{</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;ext&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">])</span>
<span class="go">102</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a functional overlap with <em>pix = pymupdf.Pixmap(doc, xref)</em>, followed by a <em>pix.tobytes()</em>. Main differences are that extract_image, <strong>(1)</strong> does not always deliver PNG image formats, <strong>(2)</strong> is <strong>very</strong> much faster with non-PNG images, <strong>(3)</strong> usually results in much less disk storage for extracted images, <strong>(4)</strong> returns <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> in error cases (generates no exception). Look at the following example images within the same PDF.</p>
<ul>
<li><p>xref 1268 is a PNG – Comparable execution time and identical output:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">1268</span><span class="p">);</span><span class="n">pix</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
<span class="mf">10.8</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">52.4</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="nb">len</span><span class="p">(</span><span class="n">pix</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="mi">21462</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">img</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">extract_image</span><span class="p">(</span><span class="mi">1268</span><span class="p">)</span>
<span class="mf">10.8</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">86</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">26</span><span class="p">]:</span> <span class="nb">len</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">26</span><span class="p">]:</span> <span class="mi">21462</span>
</pre></div>
</div>
</li>
<li><p>xref 1186 is a JPEG – <a class="reference internal" href="#Document.extract_image" title="Document.extract_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extract_image()</span></code></a> is <strong>many times faster</strong> and produces a <strong>much smaller</strong> output (2.48 MB vs. 0.35 MB):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">27</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">1186</span><span class="p">);</span><span class="n">pix</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
<span class="mi">341</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">2.86</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span> <span class="n">loop</span> <span class="n">each</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="nb">len</span><span class="p">(</span><span class="n">pix</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="mi">2599433</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">29</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">img</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">extract_image</span><span class="p">(</span><span class="mi">1186</span><span class="p">)</span>
<span class="mf">15.7</span> <span class="n">µs</span> <span class="err">±</span> <span class="mi">116</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">30</span><span class="p">]:</span> <span class="nb">len</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">30</span><span class="p">]:</span> <span class="mi">371177</span>
</pre></div>
</div>
</li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.extract_font">
<span class="sig-name descname"><span class="pre">extract_font</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">named</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.extract_font" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Changed in v1.19.4: return a dictionary if <code class="xref any docutils literal notranslate"><span class="pre">named</span> <span class="pre">==</span> <span class="pre">True</span></code>.</p></li>
</ul>
<p>PDF Only: Return an embedded font file’s data and appropriate file extension. This can be used to store the font as an external file. The method does not throw exceptions (other than via checking for PDF and valid <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – PDF object number of the font to extract.</p></li>
<li><p><strong>info_only</strong> (<em>bool</em>) – only return font information, not the buffer. To be used for information-only purposes, avoids allocation of large buffer areas.</p></li>
<li><p><strong>named</strong> (<em>bool</em>) – If true, a dictionary with the following keys is returned: ‘name’ (font base name), ‘ext’ (font file extension), ‘type’ (font type), ‘content’ (font file content).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple,dict</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>a tuple <code class="xref any docutils literal notranslate"><span class="pre">(basename,</span> <span class="pre">ext,</span> <span class="pre">type,</span> <span class="pre">content)</span></code>, where <em>ext</em> is a 3-byte suggested file extension (<em>str</em>), <em>basename</em> is the font’s name (<em>str</em>), <em>type</em> is the font’s type (e.g. “Type1”) and <em>content</em> is a bytes object containing the font file’s content (or <em>b””</em>). For possible extension values and their meaning see <a class="reference internal" href="vars.html#fontextensions"><span class="std std-ref">Font File Extensions</span></a>. Return details on error:</p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">(&quot;&quot;,</span> <span class="pre">&quot;&quot;,</span> <span class="pre">&quot;&quot;,</span> <span class="pre">b&quot;&quot;)</span></code> – invalid xref or xref is not a (valid) font object.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">(basename,</span> <span class="pre">&quot;n/a&quot;,</span> <span class="pre">&quot;Type1&quot;,</span> <span class="pre">b&quot;&quot;)</span></code> – <em>basename</em> is not embedded and thus cannot be extracted. This is the case for e.g. the <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 Fonts</span></a> and Type 3 fonts.</p></li>
</ul>
</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># store font as an external file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name</span><span class="p">,</span> <span class="n">ext</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">extract_font</span><span class="p">(</span><span class="mi">4711</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># assuming content is not None:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ofile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">ext</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ofile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ofile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The basename is returned unchanged from the PDF. So it may contain characters (such as blanks) which may disqualify it as a filename for your operating system. Take appropriate action.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The returned <em>basename</em> in general is <strong>not</strong> the original file name, but it probably has some similarity.</p></li>
<li><p>If parameter <code class="xref any docutils literal notranslate"><span class="pre">named</span> <span class="pre">==</span> <span class="pre">True</span></code>, a dictionary with the following keys is returned: <code class="xref any docutils literal notranslate"><span class="pre">{'name':</span> <span class="pre">'T1',</span> <span class="pre">'ext':</span> <span class="pre">'n/a',</span> <span class="pre">'type':</span> <span class="pre">'Type3',</span> <span class="pre">'content':</span> <span class="pre">b''}</span></code>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_xml_metadata">
<span class="sig-name descname"><span class="pre">xref_xml_metadata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_xml_metadata" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.16.8</p></li>
</ul>
<p>PDF only: Return the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the document’s XML metadata.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.has_links">
<span class="sig-name descname"><span class="pre">has_links</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.has_links" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.has_annots">
<span class="sig-name descname"><span class="pre">has_annots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.has_annots" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.7</p></li>
</ul>
<p>PDF only: Check whether there are links, resp. annotations anywhere in the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>True</em> / <em>False</em>. As opposed to fields, which are also stored in a central place of a PDF document, the existence of links / annotations can only be detected by parsing each page. These methods are tuned to do this efficiently and will immediately return, if the answer is <em>True</em> for a page. For PDFs with many thousand pages however, an answer may take some time <a class="footnote-reference brackets" href="#f6" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a> if no link, resp. no annotation is found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.subset_fonts">
<span class="sig-name descname"><span class="pre">subset_fonts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fallback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.subset_fonts" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Investigate eligible fonts for their use by text in the document. If a font is supported and a size reduction is possible, that font is replaced by a version with a subset of its characters.</p>
<p>Use this method immediately before saving the document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verbose</strong> (<em>bool</em>) – write various progress information to sysout. This currently only has an effect if <code class="xref any docutils literal notranslate"><span class="pre">fallback</span></code> is <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>fallback</strong> (<em>bool</em>) – if <code class="xref any docutils literal notranslate"><span class="pre">True</span></code> use the deprecated algorithm that makes use of package <a class="reference external" href="https://pypi.org/project/fonttools/">fontTools</a> (which hence must be installed). If using the recommended value <code class="xref any docutils literal notranslate"><span class="pre">False</span></code> (default), MuPDF’s native function is used – which is <strong>very much faster</strong> and can subset a broader range of font types. Package fontTools is not required then.</p></li>
</ul>
</dd>
</dl>
<p>The greatest benefit can be achieved when creating new PDFs using large fonts like is typical for Asian scripts. When using the <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> class or method <a class="reference internal" href="page.html#Page.insert_htmlbox" title="Page.insert_htmlbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_htmlbox()</span></code></a>, multiple fonts may automatically be included – without the programmer becoming aware of it.</p>
<p>In all these cases, the set of actually used unicodes mostly is very small compared to the number of glyphs available in the used fonts. Using this method can easily reduce the embedded font binaries by two orders of magnitude – from several megabytes down to a low two-digit kilobyte amount.</p>
<p>Creating font subsets leaves behind a large number of large, now unused PDF objects (“ghosts”). Therefore, make sure to compress and garbage-collect when saving the file. We recommend to use <a class="reference internal" href="#Document.ez_save" title="Document.ez_save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.ez_save()</span></code></a>.</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>New in v1.18.7</p></li>
<li><p>Changed in v1.18.9</p></li>
<li><p>Changed in v1.24.2 use native function of MuPDF.</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_enable">
<span class="sig-name descname"><span class="pre">journal_enable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_enable" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.19.0</p></li>
</ul>
<p>PDF only: Enable journalling. Use this before you start logging operations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_start_op">
<span class="sig-name descname"><span class="pre">journal_start_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_start_op" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.19.0</p></li>
</ul>
<p>PDF only: Start journalling an <em>“operation”</em> identified by a string “name”. Updates will fail for a journal-enabled PDF, if no operation has been started.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_stop_op">
<span class="sig-name descname"><span class="pre">journal_stop_op</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_stop_op" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.19.0</p></li>
</ul>
<p>PDF only: Stop the current operation. The updates between start and stop of an operation belong to the same unit of work and will be undone / redone together.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_position">
<span class="sig-name descname"><span class="pre">journal_position</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_position" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.19.0</p></li>
</ul>
<p>PDF only: Return the numbers of the current operation and the total operation count.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a tuple <code class="xref any docutils literal notranslate"><span class="pre">(step,</span> <span class="pre">steps)</span></code> containing the current operation number and the total number of operations in the journal. If <strong>step</strong> is 0, we are at the top of the journal. If <strong>step</strong> equals <strong>steps</strong>, we are at the bottom. Updating the PDF with anything other than undo or redo will automatically remove all journal entries after the current one and the new update will become the new last entry in the journal. The updates corresponding to the removed journal entries will be permanently lost.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_op_name">
<span class="sig-name descname"><span class="pre">journal_op_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_op_name" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.19.0</p></li>
</ul>
<p>PDF only: Return the name of operation number <em>step.</em></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_can_do">
<span class="sig-name descname"><span class="pre">journal_can_do</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_can_do" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.19.0</p></li>
</ul>
<p>PDF only: Show whether forward (“redo”) and / or backward (“undo”) executions are possible from the current journal position.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dictionary <code class="xref any docutils literal notranslate"><span class="pre">{&quot;undo&quot;:</span> <span class="pre">bool,</span> <span class="pre">&quot;redo&quot;:</span> <span class="pre">bool}</span></code>. The respective method is available if its value is <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_undo">
<span class="sig-name descname"><span class="pre">journal_undo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_undo" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.19.0</p></li>
</ul>
<p>PDF only: Revert (undo) the current step in the journal. This moves towards the journal’s top.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_redo">
<span class="sig-name descname"><span class="pre">journal_redo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_redo" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.19.0</p></li>
</ul>
<p>PDF only: Re-apply (redo) the current step in the journal. This moves towards the journal’s bottom.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_save">
<span class="sig-name descname"><span class="pre">journal_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_save" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.19.0</p></li>
</ul>
<p>PDF only: Save the journal to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em><em>,</em><em>fp</em>) – either a filename as string or a file object opened as “wb” (or an <code class="xref any docutils literal notranslate"><span class="pre">io.BytesIO()</span></code> object).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_load">
<span class="sig-name descname"><span class="pre">journal_load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_load" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.19.0</p></li>
</ul>
<p>PDF only: Load journal from a file. Enables journalling for the document. If journalling is already enabled, an exception is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em><em>,</em><em>fp</em>) – the filename (str) of the journal or a file object opened as “rb” (or an <code class="xref any docutils literal notranslate"><span class="pre">io.BytesIO()</span></code> object).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.save_snapshot" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.19.0</p></li>
</ul>
<p>PDF only: Saves a “snapshot” of the document. This is a PDF document with a special, incremental-save format compatible with journalling – therefore no save options are available. Saving a snapshot is not possible for new documents.</p>
<p>This is a normal PDF document with no usage restrictions whatsoever. If it is not being changed in any way, it can be used together with its journal to undo / redo operations or continue updating.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.outline">
<span class="sig-name descname"><span class="pre">outline</span></span><a class="headerlink" href="#Document.outline" title="Link to this definition">¶</a></dt>
<dd><p>Contains the first <a class="reference internal" href="outline.html#outline"><span class="std std-ref">Outline</span></a> entry of the document (or <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>). Can be used as a starting point to walk through all outline items. Accessing this property for encrypted, not authenticated documents will raise an <em>AttributeError</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="outline.html#outline"><span class="std std-ref">Outline</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_closed">
<span class="sig-name descname"><span class="pre">is_closed</span></span><a class="headerlink" href="#Document.is_closed" title="Link to this definition">¶</a></dt>
<dd><p><em>False</em> if document is still open. If closed, most other attributes and methods will have been deleted / disabled. In addition, <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> objects referring to this document (i.e. created with <a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a>) and their dependent objects will no longer be usable. For reference purposes, <a class="reference internal" href="#Document.name" title="Document.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.name</span></code></a> still exists and will contain the filename of the original document (if applicable).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_dirty">
<span class="sig-name descname"><span class="pre">is_dirty</span></span><a class="headerlink" href="#Document.is_dirty" title="Link to this definition">¶</a></dt>
<dd><p><em>True</em> if this is a PDF document and contains unsaved changes, else <em>False</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_pdf">
<span class="sig-name descname"><span class="pre">is_pdf</span></span><a class="headerlink" href="#Document.is_pdf" title="Link to this definition">¶</a></dt>
<dd><p><em>True</em> if this is a PDF document, else <em>False</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_form_pdf">
<span class="sig-name descname"><span class="pre">is_form_pdf</span></span><a class="headerlink" href="#Document.is_form_pdf" title="Link to this definition">¶</a></dt>
<dd><p><em>False</em> if this is not a PDF or has no form fields, otherwise the number of root form fields (fields with no ancestors).</p>
<p><em>(Changed in v1.16.4)</em> Returns the total number of (root) form fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool,int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_reflowable">
<span class="sig-name descname"><span class="pre">is_reflowable</span></span><a class="headerlink" href="#Document.is_reflowable" title="Link to this definition">¶</a></dt>
<dd><p><em>True</em> if document has a variable page layout (like e-books or HTML). In this case you can set the desired page dimensions during document creation (open) or via method <a class="reference internal" href="#Document.layout" title="Document.layout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_repaired">
<span class="sig-name descname"><span class="pre">is_repaired</span></span><a class="headerlink" href="#Document.is_repaired" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.18.2</p></li>
</ul>
<p><em>True</em> if PDF has been repaired during open (because of major structure issues). Always <em>False</em> for non-PDF documents. If true, more details have been stored in <code class="xref any docutils literal notranslate"><span class="pre">TOOLS.mupdf_warnings()</span></code>, and <a class="reference internal" href="#Document.can_save_incrementally" title="Document.can_save_incrementally"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a> will return <em>False</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_fast_webaccess">
<span class="sig-name descname"><span class="pre">is_fast_webaccess</span></span><a class="headerlink" href="#Document.is_fast_webaccess" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.22.2</p></li>
</ul>
<p><em>True</em> if PDF is in linearized format. <em>False</em> for non-PDF documents.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.markinfo">
<span class="sig-name descname"><span class="pre">markinfo</span></span><a class="headerlink" href="#Document.markinfo" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.22.2</p></li>
</ul>
<p>A dictionary indicating the <code class="xref any docutils literal notranslate"><span class="pre">/MarkInfo</span></code> value. If not specified, the empty dictionary is returned. If not a PDF, <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.pagemode">
<span class="sig-name descname"><span class="pre">pagemode</span></span><a class="headerlink" href="#Document.pagemode" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.22.2</p></li>
</ul>
<p>A string containing the <code class="xref any docutils literal notranslate"><span class="pre">/PageMode</span></code> value. If not specified, the default “UseNone” is returned. If not a PDF, <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.pagelayout">
<span class="sig-name descname"><span class="pre">pagelayout</span></span><a class="headerlink" href="#Document.pagelayout" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.22.2</p></li>
</ul>
<p>A string containing the <code class="xref any docutils literal notranslate"><span class="pre">/PageLayout</span></code> value. If not specified, the default “SinglePage” is returned. If not a PDF, <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.version_count">
<span class="sig-name descname"><span class="pre">version_count</span></span><a class="headerlink" href="#Document.version_count" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.22.2</p></li>
</ul>
<p>An integer counting the number of versions present in the document. Zero if not a PDF, otherwise the number of incremental saves plus one.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.needs_pass">
<span class="sig-name descname"><span class="pre">needs_pass</span></span><a class="headerlink" href="#Document.needs_pass" title="Link to this definition">¶</a></dt>
<dd><p>Indicates whether the document is password-protected against access. This indicator remains unchanged – <strong>even after the document has been authenticated</strong>. Precludes incremental saves if true.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_encrypted">
<span class="sig-name descname"><span class="pre">is_encrypted</span></span><a class="headerlink" href="#Document.is_encrypted" title="Link to this definition">¶</a></dt>
<dd><p>This indicator initially equals <a class="reference internal" href="#Document.needs_pass" title="Document.needs_pass"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.needs_pass</span></code></a>. After successful authentication, it is set to <em>False</em> to reflect the situation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.permissions">
<span class="sig-name descname"><span class="pre">permissions</span></span><a class="headerlink" href="#Document.permissions" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Changed in v1.16.0: This is now an integer comprised of bit indicators. Was a dictionary previously.</p></li>
</ul>
<p>Contains the permissions to access the document. This is an integer containing bool values in respective bit positions. For example, if <em>doc.permissions &amp; pymupdf.PDF_PERM_MODIFY &gt; 0</em>, you may change the document. See <a class="reference internal" href="vars.html#permissioncodes"><span class="std std-ref">Document Permissions</span></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#Document.metadata" title="Link to this definition">¶</a></dt>
<dd><p>Contains the document’s meta data as a Python dictionary or <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> (if <em>is_encrypted=True</em> and <em>needPass=True</em>). Keys are <em>format</em>, <em>encryption</em>, <em>title</em>, <em>author</em>, <em>subject</em>, <em>keywords</em>, <em>creator</em>, <em>producer</em>, <em>creationDate</em>, <em>modDate</em>, <em>trapped</em>. All item values are strings or <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>Except <em>format</em> and <em>encryption</em>, for PDF documents, the key names correspond in an obvious way to the PDF keys <em>/Creator</em>, <em>/Producer</em>, <em>/CreationDate</em>, <em>/ModDate</em>, <em>/Title</em>, <em>/Author</em>, <em>/Subject</em>, <em>/Trapped</em> and <em>/Keywords</em> respectively.</p>
<ul>
<li><p><em>format</em> contains the document format (e.g. ‘PDF-1.6’, ‘XPS’, ‘EPUB’).</p></li>
<li><p><em>encryption</em> either contains <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> (no encryption), or a string naming an encryption method (e.g. <em>‘Standard V4 R4 128-bit RC4’</em>). Note that an encryption method may be specified <strong>even if</strong> <em>needs_pass=False</em>. In such cases not all permissions will probably have been granted. Check <a class="reference internal" href="#Document.permissions" title="Document.permissions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.permissions</span></code></a> for details.</p></li>
<li><p>If the date fields contain valid data (which need not be the case at all!), they are strings in the PDF-specific timestamp format “D:&lt;TS&gt;&lt;TZ&gt;”, where</p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;TS&gt; is the 12 character ISO timestamp <em>YYYYMMDDhhmmss</em> (<em>YYYY</em> - year, <em>MM</em> - month, <em>DD</em> - day, <em>hh</em> - hour, <em>mm</em> - minute, <em>ss</em> - second), and</p></li>
<li><p>&lt;TZ&gt; is a time zone value (time interval relative to GMT) containing a sign (‘+’ or ‘-‘), the hour (<em>hh</em>), and the minute (<em>‘mm’</em>, note the apostrophes!).</p></li>
</ul>
</div></blockquote>
</li>
<li><p>A Paraguayan value might hence look like <em>D:20150415131602-04’00’</em>, which corresponds to the timestamp April 15, 2015, at 1:16:02 pm local time Asuncion.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#Document.name" title="Link to this definition">¶</a></dt>
<dd><p>Contains the <em>filename</em> or <em>filetype</em> value with which <em>Document</em> was created.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.page_count">
<span class="sig-name descname"><span class="pre">page_count</span></span><a class="headerlink" href="#Document.page_count" title="Link to this definition">¶</a></dt>
<dd><p>Contains the number of pages of the document. May return 0 for documents with no pages. Function <code class="xref any docutils literal notranslate"><span class="pre">len(doc)</span></code> will also deliver this result.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.chapter_count">
<span class="sig-name descname"><span class="pre">chapter_count</span></span><a class="headerlink" href="#Document.chapter_count" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.17.0</p></li>
</ul>
<p>Contains the number of chapters in the document. Always at least 1. Relevant only for document types with chapter support (EPUB currently). Other documents will return 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.last_location">
<span class="sig-name descname"><span class="pre">last_location</span></span><a class="headerlink" href="#Document.last_location" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>New in v1.17.0</p></li>
</ul>
<p>Contains (chapter, pno) of the document’s last page. Relevant only for document types with chapter support (EPUB currently). Other documents will return <code class="xref any docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">page_count</span> <span class="pre">-</span> <span class="pre">1)</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">-1)</span></code> if it has no pages.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.FormFonts">
<span class="sig-name descname"><span class="pre">FormFonts</span></span><a class="headerlink" href="#Document.FormFonts" title="Link to this definition">¶</a></dt>
<dd><p>A list of form field font names defined in the <em>/AcroForm</em> object. <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> if not a PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For methods that change the structure of a PDF (<code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">select()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_page()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_page()</span></code> and others), be aware that objects or properties in your program may have been invalidated or orphaned. Examples are <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> objects and their children (links, annotations, widgets), variables holding old page counts, tables of content and the like. Remember to keep such variables up to date or delete orphaned objects. Also refer to <a class="reference internal" href="app3.html#referenialintegrity"><span class="std std-ref">Ensuring Consistency of Important Objects in PyMuPDF</span></a>.</p>
</div>
<section id="set-metadata-example">
<h2><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_metadata()</span></code> Example<a class="headerlink" href="#set-metadata-example" title="Link to this heading">¶</a></h2>
<p>Clear metadata information. If you do this out of privacy / data protection concerns, make sure you save the document as a new file with <em>garbage &gt; 0</em>. Only then the old <em>/Info</em> object will also be physically removed from the file. In this case, you may also want to clear any XML metadata inserted by several PDF editors:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">=</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pymupdf.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">metadata</span>             <span class="c1"># look at what we currently have</span>
<span class="go">{&#39;producer&#39;: &#39;rst2pdf, reportlab&#39;, &#39;format&#39;: &#39;PDF 1.4&#39;, &#39;encryption&#39;: None, &#39;author&#39;:</span>
<span class="go">&#39;Jorj X. McKie&#39;, &#39;modDate&#39;: &quot;D:20160611145816-04&#39;00&#39;&quot;, &#39;keywords&#39;: &#39;PDF, XPS, EPUB, CBZ&#39;,</span>
<span class="go">&#39;title&#39;: &#39;The PyMuPDF Documentation&#39;, &#39;creationDate&#39;: &quot;D:20160611145816-04&#39;00&#39;&quot;,</span>
<span class="go">&#39;creator&#39;: &#39;sphinx&#39;, &#39;subject&#39;: &#39;PyMuPDF 1.9.1&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">({})</span>      <span class="c1"># clear all fields</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">metadata</span>             <span class="c1"># look again to show what happened</span>
<span class="go">{&#39;producer&#39;: &#39;none&#39;, &#39;format&#39;: &#39;PDF 1.4&#39;, &#39;encryption&#39;: None, &#39;author&#39;: &#39;none&#39;,</span>
<span class="go">&#39;modDate&#39;: &#39;none&#39;, &#39;keywords&#39;: &#39;none&#39;, &#39;title&#39;: &#39;none&#39;, &#39;creationDate&#39;: &#39;none&#39;,</span>
<span class="go">&#39;creator&#39;: &#39;none&#39;, &#39;subject&#39;: &#39;none&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">del_xml_metadata</span><span class="p">()</span>    <span class="c1"># clear any XML metadata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;anonymous.pdf&quot;</span><span class="p">,</span> <span class="n">garbage</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>       <span class="c1"># save anonymized doc</span>
</pre></div>
</div>
</section>
<section id="set-toc-demonstration">
<h2><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_toc()</span></code> Demonstration<a class="headerlink" href="#set-toc-demonstration" title="Link to this heading">¶</a></h2>
<p>This shows how to modify or add a table of contents. Also have a look at <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-toc/import.py">import.py</a> and <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/export-toc/export.py">export.py</a> in the examples directory.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">toc</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                           <span class="c1"># show what we have</span>
<span class="go">[1, &#39;The PyMuPDF Documentation&#39;, 1]</span>
<span class="go">[2, &#39;Introduction&#39;, 1]</span>
<span class="go">[3, &#39;Note on the Name fitz&#39;, 1]</span>
<span class="go">[3, &#39;License&#39;, 1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot; modified by set_toc&quot;</span>               <span class="c1"># modify something</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_toc</span><span class="p">(</span><span class="n">toc</span><span class="p">)</span>                                  <span class="c1"># replace outline tree</span>
<span class="go">3                                                    # number of bookmarks inserted</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                  <span class="c1"># demonstrate it worked</span>
<span class="go">[1, &#39;The PyMuPDF Documentation&#39;, 1]</span>
<span class="go">[2, &#39;Introduction modified by set_toc&#39;, 1]            # &lt;&lt;&lt; this has changed</span>
<span class="go">[3, &#39;Note on the Name fitz&#39;, 1]</span>
<span class="go">[3, &#39;License&#39;, 1]</span>
</pre></div>
</div>
</section>
<section id="insert-pdf-examples">
<h2><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code> Examples<a class="headerlink" href="#insert-pdf-examples" title="Link to this heading">¶</a></h2>
<p><strong>(1) Concatenate two documents including their TOCs:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;file1.pdf&quot;</span><span class="p">)</span>          <span class="c1"># must be a PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc2</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;file2.pdf&quot;</span><span class="p">)</span>          <span class="c1"># must be a PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pages1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc1</span><span class="p">)</span>                     <span class="c1"># save doc1&#39;s page count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc1</span> <span class="o">=</span> <span class="n">doc1</span><span class="o">.</span><span class="n">get_toc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>     <span class="c1"># save TOC 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc2</span> <span class="o">=</span> <span class="n">doc2</span><span class="o">.</span><span class="n">get_toc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>     <span class="c1"># save TOC 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">)</span>                   <span class="c1"># doc2 at end of doc1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">toc2</span><span class="p">:</span>                         <span class="c1"># increase toc2 page numbers</span>
<span class="go">        t[2] += pages1                     # by old len(doc1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">set_toc</span><span class="p">(</span><span class="n">toc1</span> <span class="o">+</span> <span class="n">toc2</span><span class="p">)</span>               <span class="c1"># now result has total TOC</span>
</pre></div>
</div>
<p>Obviously, similar ways can be found in more general situations. Just make sure that hierarchy levels in a row do not increase by more than one. Inserting dummy bookmarks before and after <em>toc2</em> segments would heal such cases. A ready-to-use GUI (wxPython) solution can be found in script <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py">join.py</a> of the examples directory.</p>
<p><strong>(2) More examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># insert 5 pages of doc2, where its page 21 becomes page 15 in doc1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">start_at</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># same example, but pages are rotated and copied in reverse order</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">start_at</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># put copied pages in front of doc1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">start_at</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="other-examples">
<h2>Other Examples<a class="headerlink" href="#other-examples" title="Link to this heading">¶</a></h2>
<p><strong>Extract all page-referenced images of a PDF into separate PNG files</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">page_count</span><span class="p">):</span>
    <span class="n">imglist</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_page_images</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">imglist</span><span class="p">:</span>
        <span class="n">xref</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                  <span class="c1"># xref number</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">xref</span><span class="p">)</span>   <span class="c1"># make pixmap from image</span>
        <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>      <span class="c1"># can be saved as PNG</span>
            <span class="n">pix</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;p</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">xref</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>                          <span class="c1"># CMYK: must convert first</span>
            <span class="n">pix0</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">csRGB</span><span class="p">,</span> <span class="n">pix</span><span class="p">)</span>
            <span class="n">pix0</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;p</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">xref</span><span class="p">))</span>
            <span class="n">pix0</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1"># free Pixmap resources</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="kc">None</span>                     <span class="c1"># free Pixmap resources</span>
</pre></div>
</div>
<p><strong>Rotate all pages of a PDF:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span> <span class="n">page</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="f1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">1</a><span class="fn-bracket">]</span></span>
<p>Content streams describe what (e.g. text or images) appears where and how on a page. PDF uses a specialized mini language similar to PostScript to do this (pp. 643 in <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>), which gets interpreted when a page is loaded.</p>
</aside>
<aside class="footnote brackets" id="f2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">2</a><span class="fn-bracket">]</span></span>
<p>However, you <strong>can</strong> use <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> and <a class="reference internal" href="page.html#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a> (which are available for all document types) and copy this information over to the output PDF. See demo <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/convert-document/convert.py">convert.py</a>.</p>
</aside>
<aside class="footnote brackets" id="f3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>For applicable (EPUB) document types, loading a page via its absolute number may result in layouting a large part of the document, before the page can be accessed. To avoid this performance impact, prefer chapter-based access. Use convenience methods and attributes <a class="reference internal" href="#Document.next_location" title="Document.next_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.next_location()</span></code></a>, <a class="reference internal" href="#Document.prev_location" title="Document.prev_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.prev_location()</span></code></a> and <a class="reference internal" href="#Document.last_location" title="Document.last_location"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.last_location</span></code></a> for maintaining a high level of coding efficiency.</p>
</aside>
<aside class="footnote brackets" id="f4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id7">1</a>,<a role="doc-backlink" href="#id8">2</a>)</span>
<p>These parameters cause separate handling of stream categories: use it together with <code class="xref any docutils literal notranslate"><span class="pre">expand</span></code> to restrict decompression to streams other than images / fontfiles.</p>
</aside>
<aside class="footnote brackets" id="f5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">5</a><span class="fn-bracket">]</span></span>
<p>Examples for “Form XObjects” are created by <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>.</p>
</aside>
<aside class="footnote brackets" id="f6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">6</a><span class="fn-bracket">]</span></span>
<p>For a <em>False</em> the <strong>complete document</strong> must be scanned. Both methods <strong>do not load pages,</strong> but only scan object definitions. This makes them at least 10 times faster than application-level loops (where total response time roughly equals the time for loading all pages). For the <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a> (756 pages) and the Pandas documentation (over 3070 pages) – both have no annotations – the method needs about 11 ms for the answer <em>False</em>. So response times will probably become significant only well beyond this order of magnitude.</p>
</aside>
<aside class="footnote brackets" id="f7" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">7</a><span class="fn-bracket">]</span></span>
<p>This only works under certain conditions. For example, if there is normal text covered by some image on top of it, then this is undetectable and the respective text is <strong>not</strong> removed. Similar is true for white text on white background, and so on.</p>
</aside>
</aside>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>Do you have any feedback on this page?</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.3.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="document-writer-class.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">DocumentWriter</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="displaylist.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">DisplayList</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 10. Mar 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Document</a><ul>
<li><a class="reference internal" href="#Document"><code class="docutils literal notranslate"><span class="pre">Document</span></code></a><ul>
<li><a class="reference internal" href="#Document.__init__"><code class="docutils literal notranslate"><span class="pre">Document.__init__()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_oc"><code class="docutils literal notranslate"><span class="pre">Document.get_oc()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_oc"><code class="docutils literal notranslate"><span class="pre">Document.set_oc()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_layers"><code class="docutils literal notranslate"><span class="pre">Document.get_layers()</span></code></a></li>
<li><a class="reference internal" href="#Document.add_layer"><code class="docutils literal notranslate"><span class="pre">Document.add_layer()</span></code></a></li>
<li><a class="reference internal" href="#Document.switch_layer"><code class="docutils literal notranslate"><span class="pre">Document.switch_layer()</span></code></a></li>
<li><a class="reference internal" href="#Document.add_ocg"><code class="docutils literal notranslate"><span class="pre">Document.add_ocg()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_ocmd"><code class="docutils literal notranslate"><span class="pre">Document.set_ocmd()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_ocmd"><code class="docutils literal notranslate"><span class="pre">Document.get_ocmd()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_layer"><code class="docutils literal notranslate"><span class="pre">Document.get_layer()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_layer"><code class="docutils literal notranslate"><span class="pre">Document.set_layer()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_ocgs"><code class="docutils literal notranslate"><span class="pre">Document.get_ocgs()</span></code></a></li>
<li><a class="reference internal" href="#Document.layer_ui_configs"><code class="docutils literal notranslate"><span class="pre">Document.layer_ui_configs()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_layer_ui_config"><code class="docutils literal notranslate"><span class="pre">Document.set_layer_ui_config()</span></code></a></li>
<li><a class="reference internal" href="#Document.authenticate"><code class="docutils literal notranslate"><span class="pre">Document.authenticate()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_numbers"><code class="docutils literal notranslate"><span class="pre">Document.get_page_numbers()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_labels"><code class="docutils literal notranslate"><span class="pre">Document.get_page_labels()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_page_labels"><code class="docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a></li>
<li><a class="reference internal" href="#Document.make_bookmark"><code class="docutils literal notranslate"><span class="pre">Document.make_bookmark()</span></code></a></li>
<li><a class="reference internal" href="#Document.find_bookmark"><code class="docutils literal notranslate"><span class="pre">Document.find_bookmark()</span></code></a></li>
<li><a class="reference internal" href="#Document.chapter_page_count"><code class="docutils literal notranslate"><span class="pre">Document.chapter_page_count()</span></code></a></li>
<li><a class="reference internal" href="#Document.next_location"><code class="docutils literal notranslate"><span class="pre">Document.next_location()</span></code></a></li>
<li><a class="reference internal" href="#Document.prev_location"><code class="docutils literal notranslate"><span class="pre">Document.prev_location()</span></code></a></li>
<li><a class="reference internal" href="#Document.load_page"><code class="docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.reload_page"><code class="docutils literal notranslate"><span class="pre">Document.reload_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.resolve_names"><code class="docutils literal notranslate"><span class="pre">Document.resolve_names()</span></code></a></li>
<li><a class="reference internal" href="#Document.page_cropbox"><code class="docutils literal notranslate"><span class="pre">Document.page_cropbox()</span></code></a></li>
<li><a class="reference internal" href="#Document.page_xref"><code class="docutils literal notranslate"><span class="pre">Document.page_xref()</span></code></a></li>
<li><a class="reference internal" href="#Document.pages"><code class="docutils literal notranslate"><span class="pre">Document.pages()</span></code></a></li>
<li><a class="reference internal" href="#Document.convert_to_pdf"><code class="docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_toc"><code class="docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_get_keys"><code class="docutils literal notranslate"><span class="pre">Document.xref_get_keys()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_get_key"><code class="docutils literal notranslate"><span class="pre">Document.xref_get_key()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_set_key"><code class="docutils literal notranslate"><span class="pre">Document.xref_set_key()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_pixmap"><code class="docutils literal notranslate"><span class="pre">Document.get_page_pixmap()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_xobjects"><code class="docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_images"><code class="docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_fonts"><code class="docutils literal notranslate"><span class="pre">Document.get_page_fonts()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_text"><code class="docutils literal notranslate"><span class="pre">Document.get_page_text()</span></code></a></li>
<li><a class="reference internal" href="#Document.layout"><code class="docutils literal notranslate"><span class="pre">Document.layout()</span></code></a></li>
<li><a class="reference internal" href="#Document.select"><code class="docutils literal notranslate"><span class="pre">Document.select()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_metadata"><code class="docutils literal notranslate"><span class="pre">Document.set_metadata()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_xml_metadata"><code class="docutils literal notranslate"><span class="pre">Document.get_xml_metadata()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_xml_metadata"><code class="docutils literal notranslate"><span class="pre">Document.set_xml_metadata()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_pagelayout"><code class="docutils literal notranslate"><span class="pre">Document.set_pagelayout()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_pagemode"><code class="docutils literal notranslate"><span class="pre">Document.set_pagemode()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_markinfo"><code class="docutils literal notranslate"><span class="pre">Document.set_markinfo()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_toc"><code class="docutils literal notranslate"><span class="pre">Document.set_toc()</span></code></a></li>
<li><a class="reference internal" href="#Document.outline_xref"><code class="docutils literal notranslate"><span class="pre">Document.outline_xref()</span></code></a></li>
<li><a class="reference internal" href="#Document.del_toc_item"><code class="docutils literal notranslate"><span class="pre">Document.del_toc_item()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_toc_item"><code class="docutils literal notranslate"><span class="pre">Document.set_toc_item()</span></code></a></li>
<li><a class="reference internal" href="#Document.bake"><code class="docutils literal notranslate"><span class="pre">Document.bake()</span></code></a></li>
<li><a class="reference internal" href="#Document.can_save_incrementally"><code class="docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a></li>
<li><a class="reference internal" href="#Document.scrub"><code class="docutils literal notranslate"><span class="pre">Document.scrub()</span></code></a></li>
<li><a class="reference internal" href="#Document.save"><code class="docutils literal notranslate"><span class="pre">Document.save()</span></code></a></li>
<li><a class="reference internal" href="#Document.ez_save"><code class="docutils literal notranslate"><span class="pre">Document.ez_save()</span></code></a></li>
<li><a class="reference internal" href="#Document.saveIncr"><code class="docutils literal notranslate"><span class="pre">Document.saveIncr()</span></code></a></li>
<li><a class="reference internal" href="#Document.tobytes"><code class="docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a></li>
<li><a class="reference internal" href="#Document.search_page_for"><code class="docutils literal notranslate"><span class="pre">Document.search_page_for()</span></code></a></li>
<li><a class="reference internal" href="#Document.insert_pdf"><code class="docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a></li>
<li><a class="reference internal" href="#Document.insert_file"><code class="docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a></li>
<li><a class="reference internal" href="#Document.new_page"><code class="docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.insert_page"><code class="docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.delete_page"><code class="docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.delete_pages"><code class="docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a></li>
<li><a class="reference internal" href="#Document.copy_page"><code class="docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.fullcopy_page"><code class="docutils literal notranslate"><span class="pre">Document.fullcopy_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.move_page"><code class="docutils literal notranslate"><span class="pre">Document.move_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.need_appearances"><code class="docutils literal notranslate"><span class="pre">Document.need_appearances()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_sigflags"><code class="docutils literal notranslate"><span class="pre">Document.get_sigflags()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_add"><code class="docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_count"><code class="docutils literal notranslate"><span class="pre">Document.embfile_count()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_get"><code class="docutils literal notranslate"><span class="pre">Document.embfile_get()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_del"><code class="docutils literal notranslate"><span class="pre">Document.embfile_del()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_info"><code class="docutils literal notranslate"><span class="pre">Document.embfile_info()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_names"><code class="docutils literal notranslate"><span class="pre">Document.embfile_names()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_upd"><code class="docutils literal notranslate"><span class="pre">Document.embfile_upd()</span></code></a></li>
<li><a class="reference internal" href="#Document.close"><code class="docutils literal notranslate"><span class="pre">Document.close()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_object"><code class="docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a></li>
<li><a class="reference internal" href="#Document.pdf_catalog"><code class="docutils literal notranslate"><span class="pre">Document.pdf_catalog()</span></code></a></li>
<li><a class="reference internal" href="#Document.pdf_trailer"><code class="docutils literal notranslate"><span class="pre">Document.pdf_trailer()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_stream"><code class="docutils literal notranslate"><span class="pre">Document.xref_stream()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_stream_raw"><code class="docutils literal notranslate"><span class="pre">Document.xref_stream_raw()</span></code></a></li>
<li><a class="reference internal" href="#Document.update_object"><code class="docutils literal notranslate"><span class="pre">Document.update_object()</span></code></a></li>
<li><a class="reference internal" href="#Document.update_stream"><code class="docutils literal notranslate"><span class="pre">Document.update_stream()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_copy"><code class="docutils literal notranslate"><span class="pre">Document.xref_copy()</span></code></a></li>
<li><a class="reference internal" href="#Document.extract_image"><code class="docutils literal notranslate"><span class="pre">Document.extract_image()</span></code></a></li>
<li><a class="reference internal" href="#Document.extract_font"><code class="docutils literal notranslate"><span class="pre">Document.extract_font()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_xml_metadata"><code class="docutils literal notranslate"><span class="pre">Document.xref_xml_metadata()</span></code></a></li>
<li><a class="reference internal" href="#Document.has_links"><code class="docutils literal notranslate"><span class="pre">Document.has_links()</span></code></a></li>
<li><a class="reference internal" href="#Document.has_annots"><code class="docutils literal notranslate"><span class="pre">Document.has_annots()</span></code></a></li>
<li><a class="reference internal" href="#Document.subset_fonts"><code class="docutils literal notranslate"><span class="pre">Document.subset_fonts()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_enable"><code class="docutils literal notranslate"><span class="pre">Document.journal_enable()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_start_op"><code class="docutils literal notranslate"><span class="pre">Document.journal_start_op()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_stop_op"><code class="docutils literal notranslate"><span class="pre">Document.journal_stop_op()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_position"><code class="docutils literal notranslate"><span class="pre">Document.journal_position()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_op_name"><code class="docutils literal notranslate"><span class="pre">Document.journal_op_name()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_can_do"><code class="docutils literal notranslate"><span class="pre">Document.journal_can_do()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_undo"><code class="docutils literal notranslate"><span class="pre">Document.journal_undo()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_redo"><code class="docutils literal notranslate"><span class="pre">Document.journal_redo()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_save"><code class="docutils literal notranslate"><span class="pre">Document.journal_save()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_load"><code class="docutils literal notranslate"><span class="pre">Document.journal_load()</span></code></a></li>
<li><a class="reference internal" href="#Document.save_snapshot"><code class="docutils literal notranslate"><span class="pre">Document.save_snapshot()</span></code></a></li>
<li><a class="reference internal" href="#Document.outline"><code class="docutils literal notranslate"><span class="pre">Document.outline</span></code></a></li>
<li><a class="reference internal" href="#Document.is_closed"><code class="docutils literal notranslate"><span class="pre">Document.is_closed</span></code></a></li>
<li><a class="reference internal" href="#Document.is_dirty"><code class="docutils literal notranslate"><span class="pre">Document.is_dirty</span></code></a></li>
<li><a class="reference internal" href="#Document.is_pdf"><code class="docutils literal notranslate"><span class="pre">Document.is_pdf</span></code></a></li>
<li><a class="reference internal" href="#Document.is_form_pdf"><code class="docutils literal notranslate"><span class="pre">Document.is_form_pdf</span></code></a></li>
<li><a class="reference internal" href="#Document.is_reflowable"><code class="docutils literal notranslate"><span class="pre">Document.is_reflowable</span></code></a></li>
<li><a class="reference internal" href="#Document.is_repaired"><code class="docutils literal notranslate"><span class="pre">Document.is_repaired</span></code></a></li>
<li><a class="reference internal" href="#Document.is_fast_webaccess"><code class="docutils literal notranslate"><span class="pre">Document.is_fast_webaccess</span></code></a></li>
<li><a class="reference internal" href="#Document.markinfo"><code class="docutils literal notranslate"><span class="pre">Document.markinfo</span></code></a></li>
<li><a class="reference internal" href="#Document.pagemode"><code class="docutils literal notranslate"><span class="pre">Document.pagemode</span></code></a></li>
<li><a class="reference internal" href="#Document.pagelayout"><code class="docutils literal notranslate"><span class="pre">Document.pagelayout</span></code></a></li>
<li><a class="reference internal" href="#Document.version_count"><code class="docutils literal notranslate"><span class="pre">Document.version_count</span></code></a></li>
<li><a class="reference internal" href="#Document.needs_pass"><code class="docutils literal notranslate"><span class="pre">Document.needs_pass</span></code></a></li>
<li><a class="reference internal" href="#Document.is_encrypted"><code class="docutils literal notranslate"><span class="pre">Document.is_encrypted</span></code></a></li>
<li><a class="reference internal" href="#Document.permissions"><code class="docutils literal notranslate"><span class="pre">Document.permissions</span></code></a></li>
<li><a class="reference internal" href="#Document.metadata"><code class="docutils literal notranslate"><span class="pre">Document.metadata</span></code></a></li>
<li><a class="reference internal" href="#Document.name"><code class="docutils literal notranslate"><span class="pre">Document.name</span></code></a></li>
<li><a class="reference internal" href="#Document.page_count"><code class="docutils literal notranslate"><span class="pre">Document.page_count</span></code></a></li>
<li><a class="reference internal" href="#Document.chapter_count"><code class="docutils literal notranslate"><span class="pre">Document.chapter_count</span></code></a></li>
<li><a class="reference internal" href="#Document.last_location"><code class="docutils literal notranslate"><span class="pre">Document.last_location</span></code></a></li>
<li><a class="reference internal" href="#Document.FormFonts"><code class="docutils literal notranslate"><span class="pre">Document.FormFonts</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#set-metadata-example"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_metadata()</span></code> Example</a></li>
<li><a class="reference internal" href="#set-toc-demonstration"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_toc()</span></code> Demonstration</a></li>
<li><a class="reference internal" href="#insert-pdf-examples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code> Examples</a></li>
<li><a class="reference internal" href="#other-examples">Other Examples</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=9ddcf537"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    </body>
</html>