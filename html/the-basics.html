<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF is a high-performance Python library for data extraction, analysis, conversion &amp; manipulation of PDF (and other) documents." name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="About these documents" href="about.html" /><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Tutorial" href="tutorial.html" /><link rel="prev" title="Installation" href="installation.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>The Basics - PyMuPDF 1.25.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=74643500" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.3 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.3 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">Features Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#performance">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#license-and-copyright">License and Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">The Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF, LLM &amp; RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">Opening Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">Drawing and Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">Stories</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">Journalling</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">Multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - Optical Character Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">Optional Content Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">Low-Level Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">Common Issues and their Solutions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module.html">Command line interface</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="classes.html">Classes</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">Operator Algebra for Geometry Objects</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">Low Level Functions and Classes</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Low Level Functions and Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">Working together: DisplayList and TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">Constants and Enumerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">Color Database</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app1.html">Appendix 1: Details on Text Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">Appendix 2: Considerations on Embedded Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">Appendix 3: Assorted Technical Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">Appendix 4: Performance Comparison Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">Deprecated Names</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/the-basics.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <style>

    #languageToggle {
        width:25%;
        margin:8px 10px 0;
    }

    #button-select-en {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 10px 0 0 10px;
        font-size: 14px;
    }

    #button-select-ja {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 0px 10px 10px 0;
        border-left: 0;
        font-size: 14px;
    }

    #button-select-en , #button-select-ja, #button-select-en:hover , #button-select-ja:hover  {
        color: #fff;
        text-decoration: none;
    }

    /* small screens */
    @media all and (max-width : 768px)  {
        #languageToggle {
            width:50%;
        }
    }

    @media all and (max-width : 400px)  {
        #languageToggle {
            width:70%;
        }
    }

    @media all and (max-width : 375px)  {
        #button-select-en , #button-select-ja {
            font-size: 11px;
        }
    }

</style>

<div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
    <div id="languageToggle"><span><a id="button-select-en" href="javaScript:changeLanguage('en')">English</a></span><span><a id="button-select-ja" href="javaScript:changeLanguage('ja')">日本語</a></span></div>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

    <div class="feedbackLink"><a id="feedbackLinkTop" target=_blank>Do you have any feedback on this page?</b></a></div>
</div>

<script>
    // highlightSelectedLanguage

    if (document.getElementsByTagName('html')[0].getAttribute('lang')=="ja") {
        document.getElementById("button-select-ja").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-en").style.color = "#000";
    } else {
        document.getElementById("button-select-en").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-ja").style.color = "#000";
    }


    var url_string = window.location.href;
    var a = document.getElementById('feedbackLinkTop');
    a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=header-link&url="+url_string);

    function changeLanguage(lang) {
        var new_url;

        if (lang == "en") {
            new_url = url_string.replace("/ja/", "/en/");
        } else {
            new_url = url_string.replace("/en/", "/ja/");
        }

        window.location.replace(new_url);
    }

</script><section id="the-basics">
<span id="thebasics"></span><h1>The Basics<a class="headerlink" href="#the-basics" title="Link to this heading">¶</a></h1>
<section id="opening-a-file">
<span id="the-basics-opening-files"></span><h2>Opening a File<a class="headerlink" href="#opening-a-file" title="Link to this heading">¶</a></h2>
<p>To open a file, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>See the <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">list of supported file types</span></a> and <a class="reference internal" href="how-to-open-a-file.html#howtoopenafile"><span class="std std-ref">The How to Guide on Opening Files</span></a> for more advanced options.</p>
</div>
<hr class="docutils" />
</section>
<section id="extract-text-from-a-pdf">
<span id="the-basics-extracting-text"></span><h2>Extract text from a <cite>PDF</cite><a class="headerlink" href="#extract-text-from-a-pdf" title="Link to this heading">¶</a></h2>
<p>To extract all the text from a <cite>PDF</cite> file, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
<span class="n">out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;output.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="c1"># create a text output</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span> <span class="c1"># iterate the document pages</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span> <span class="c1"># get plain text (is in UTF-8)</span>
    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="c1"># write text of page</span>
    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">((</span><span class="mi">12</span><span class="p">,)))</span> <span class="c1"># write page delimiter (form feed 0x0C)</span>
<span class="n">out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Of course it is not just <cite>PDF</cite> which can have text extracted - all the <a class="reference internal" href="about.html#about-feature-matrix"><span class="std std-ref">supported document file formats</span></a> such as <cite>MOBI</cite>, <cite>EPUB</cite>, <cite>TXT</cite> can have their text extracted.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>If your document contains image based text content the use OCR on the page for subsequent text extraction:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tp</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_textpage_ocr</span><span class="p">()</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">textpage</span><span class="o">=</span><span class="n">tp</span><span class="p">)</span>
</pre></div>
</div>
<p>There are many more examples which explain how to extract text from specific areas or how to extract tables from documents. Please refer to the <a class="reference internal" href="recipes-text.html#recipestext"><span class="std std-ref">How to Guide for Text</span></a>.</p>
<p>You can now also <a class="reference internal" href="rag.html#rag-outputting-as-md"><span class="std std-ref">extract text in Markdown format</span></a>.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="extract-images-from-a-pdf">
<span id="the-basics-extracting-images"></span><h2>Extract images from a <cite>PDF</cite><a class="headerlink" href="#extract-images-from-a-pdf" title="Link to this heading">¶</a></h2>
<p>To extract all the images from a <cite>PDF</cite> file, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>

<span class="k">for</span> <span class="n">page_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)):</span> <span class="c1"># iterate over pdf pages</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span> <span class="c1"># get the page</span>
    <span class="n">image_list</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_images</span><span class="p">()</span>

    <span class="c1"># print the number of images found on the page</span>
    <span class="k">if</span> <span class="n">image_list</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">image_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> images on page </span><span class="si">{</span><span class="n">page_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No images found on page&quot;</span><span class="p">,</span> <span class="n">page_index</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">image_index</span><span class="p">,</span> <span class="n">img</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">image_list</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># enumerate the image list</span>
        <span class="n">xref</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get the XREF of the image</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">xref</span><span class="p">)</span> <span class="c1"># create a Pixmap</span>

        <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># CMYK: convert to RGB first</span>
            <span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">csRGB</span><span class="p">,</span> <span class="n">pix</span><span class="p">)</span>

        <span class="n">pix</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;page_</span><span class="si">%s</span><span class="s2">-image_</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">page_index</span><span class="p">,</span> <span class="n">image_index</span><span class="p">))</span> <span class="c1"># save the image as png</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>There are many more examples which explain how to extract text from specific areas or how to extract tables from documents. Please refer to the <a class="reference internal" href="recipes-text.html#recipestext"><span class="std std-ref">How to Guide for Text</span></a>.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a></p></li>
<li><p><a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a></p></li>
</ul>
</div>
</section>
<section id="extract-vector-graphics">
<span id="the-basics-extracting-vector-graphics"></span><h2>Extract vector graphics<a class="headerlink" href="#extract-vector-graphics" title="Link to this heading">¶</a></h2>
<p>To extract all the vector graphics from a document page, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.file&quot;</span><span class="p">)</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">paths</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_drawings</span><span class="p">()</span>
</pre></div>
</div>
<p>This will return a dictionary of paths for any vector drawings found on the page.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>Please refer to: <a class="reference internal" href="recipes-drawing-and-graphics.html#recipesdrawingandgraphics-extract-drawings"><span class="std std-ref">How to Extract Drawings</span></a>.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="merging-pdf-files">
<span id="join-pdf"></span><span id="merge-pdf"></span><span id="the-basics-merging-pdf"></span><h2>Merging <cite>PDF</cite> files<a class="headerlink" href="#merging-pdf-files" title="Link to this heading">¶</a></h2>
<p>To merge <cite>PDF</cite> files, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc_a</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a.pdf&quot;</span><span class="p">)</span> <span class="c1"># open the 1st document</span>
<span class="n">doc_b</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;b.pdf&quot;</span><span class="p">)</span> <span class="c1"># open the 2nd document</span>

<span class="n">doc_a</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc_b</span><span class="p">)</span> <span class="c1"># merge the docs</span>
<span class="n">doc_a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;a+b.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the merged document with a new filename</span>
</pre></div>
</div>
<section id="merging-pdf-files-with-other-types-of-file">
<h3>Merging <cite>PDF</cite> files with other types of file<a class="headerlink" href="#merging-pdf-files-with-other-types-of-file" title="Link to this heading">¶</a></h3>
<p>With <a class="reference internal" href="document.html#Document.insert_file" title="Document.insert_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a> you can invoke the method to merge <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">supported files</span></a> with <cite>PDF</cite>. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc_a</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a.pdf&quot;</span><span class="p">)</span> <span class="c1"># open the 1st document</span>
<span class="n">doc_b</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;b.svg&quot;</span><span class="p">)</span> <span class="c1"># open the 2nd document</span>

<span class="n">doc_a</span><span class="o">.</span><span class="n">insert_file</span><span class="p">(</span><span class="n">doc_b</span><span class="p">)</span> <span class="c1"># merge the docs</span>
<span class="n">doc_a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;a+b.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the merged document with a new filename</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>It is easy to join PDFs with <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a> &amp; <a class="reference internal" href="document.html#Document.insert_file" title="Document.insert_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a>. Given open <cite>PDF</cite> documents, you can copy page ranges from one to the other. You can select the point where the copied pages should be placed, you can revert the page sequence and also change page rotation.</p>
<p>The GUI script <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py">join.py</a> uses this method to join a list of files while also joining the respective table of contents segments. It looks like this:</p>
<a class="reference internal image-reference" href="_images/img-pdfjoiner.jpg"><img alt="_images/img-pdfjoiner.jpg" src="_images/img-pdfjoiner.jpg" style="width: 592.8px; height: 426.59999999999997px;" />
</a>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a></p></li>
<li><p><a class="reference internal" href="document.html#Document.insert_file" title="Document.insert_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a></p></li>
</ul>
</div>
</section>
</section>
<hr class="docutils" />
<section id="working-with-coordinates">
<h2>Working with Coordinates<a class="headerlink" href="#working-with-coordinates" title="Link to this heading">¶</a></h2>
<p>There is one <em>mathematical term</em> that you should feel comfortable with when using <strong>PyMuPDF</strong> -  <strong>“coordinates”</strong>. Please have a quick look at the <a class="reference internal" href="app3.html#coordinates"><span class="std std-ref">Coordinates</span></a> section to understand the coordinate system to help you with positioning objects and understand your document space.</p>
<hr class="docutils" />
</section>
<section id="adding-a-watermark-to-a-pdf">
<span id="the-basics-watermarks"></span><h2>Adding a watermark to a <cite>PDF</cite><a class="headerlink" href="#adding-a-watermark-to-a-pdf" title="Link to this heading">¶</a></h2>
<p>To add a watermark to a <cite>PDF</cite> file, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;document.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>

<span class="k">for</span> <span class="n">page_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)):</span> <span class="c1"># iterate over pdf pages</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span> <span class="c1"># get the page</span>

    <span class="c1"># insert an image watermark from a file name to fit the page bounds</span>
    <span class="n">page</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">bound</span><span class="p">(),</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;watermark.png&quot;</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;watermarked-document.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document with a new filename</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>Adding watermarks is essentially as simple as adding an image at the base of each <cite>PDF</cite> page. You should ensure that the image has the required opacity and aspect ratio to make it look the way you need it to.</p>
<p>In the example above a new image is created from each file reference, but to be more performant (by saving memory and file size) this image data should be referenced only once - see the code example and explanation on <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> for the implementation.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.bound" title="Page.bound"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.bound()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="adding-an-image-to-a-pdf">
<span id="the-basics-images"></span><h2>Adding an image to a <cite>PDF</cite><a class="headerlink" href="#adding-an-image-to-a-pdf" title="Link to this heading">¶</a></h2>
<p>To add an image to a <cite>PDF</cite> file, for example a logo, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;document.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>

<span class="k">for</span> <span class="n">page_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)):</span> <span class="c1"># iterate over pdf pages</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span> <span class="c1"># get the page</span>

    <span class="c1"># insert an image logo from a file name at the top left of the document</span>
    <span class="n">page</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;my-logo.png&quot;</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;logo-document.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document with a new filename</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>As with the watermark example you should ensure to be more performant by only referencing the image once if possible - see the code example and explanation on <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a>.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="rotating-a-pdf">
<span id="the-basics-rotating"></span><h2>Rotating a <cite>PDF</cite><a class="headerlink" href="#rotating-a-pdf" title="Link to this heading">¶</a></h2>
<p>To add a rotation to a page, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open document</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get the 1st page of the document</span>
<span class="n">page</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="c1"># rotate the page</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;rotated-page-1.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.set_rotation" title="Page.set_rotation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_rotation()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="cropping-a-pdf">
<span id="the-basics-cropping"></span><h2>Cropping a <cite>PDF</cite><a class="headerlink" href="#cropping-a-pdf" title="Link to this heading">¶</a></h2>
<p>To crop a page to a defined <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open document</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get the 1st page of the document</span>
<span class="n">page</span><span class="o">.</span><span class="n">set_cropbox</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span> <span class="c1"># set a cropbox for the page</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;cropped-page-1.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.set_cropbox" title="Page.set_cropbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_cropbox()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="attaching-files">
<span id="the-basics-attaching-files"></span><h2><span class="target" id="index-0"></span>Attaching Files<a class="headerlink" href="#attaching-files" title="Link to this heading">¶</a></h2>
<p>To attach another file to a page, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open main document</span>
<span class="n">attachment</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-attachment.pdf&quot;</span><span class="p">)</span> <span class="c1"># open document you want to attach</span>

<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get the 1st page of the document</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># create the point where you want to add the attachment</span>
<span class="n">attachment_data</span> <span class="o">=</span> <span class="n">attachment</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span> <span class="c1"># get the document byte data as a buffer</span>

<span class="c1"># add the file annotation with the point, data and the file name</span>
<span class="n">file_annotation</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">add_file_annot</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">attachment_data</span><span class="p">,</span> <span class="s2">&quot;attachment.pdf&quot;</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;document-with-attachment.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>When adding the file with <a class="reference internal" href="page.html#Page.add_file_annot" title="Page.add_file_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_file_annot()</span></code></a> note that the third parameter for the <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code> should include the actual file extension. Without this the attachment possibly will not be able to be recognized as being something which can be opened. For example, if the <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code> is just <em>“attachment”</em> when view the resulting PDF and attempting to open the attachment you may well get an error. However, with <em>“attachment.pdf”</em> this can be recognized and opened by PDF viewers as a valid file type.</p>
<p>The default icon for the attachment is by default a “push pin”, however you can change this by setting the <code class="xref any docutils literal notranslate"><span class="pre">icon</span></code> parameter.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p></li>
<li><p><a class="reference internal" href="document.html#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.add_file_annot" title="Page.add_file_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_file_annot()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="embedding-files">
<span id="the-basics-embedding-files"></span><h2><span class="target" id="index-1"></span>Embedding Files<a class="headerlink" href="#embedding-files" title="Link to this heading">¶</a></h2>
<p>To embed a file to a document, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open main document</span>
<span class="n">embedded_doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-embed.pdf&quot;</span><span class="p">)</span> <span class="c1"># open document you want to embed</span>

<span class="n">embedded_data</span> <span class="o">=</span> <span class="n">embedded_doc</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span> <span class="c1"># get the document byte data as a buffer</span>

<span class="c1"># embed with the file name and the data</span>
<span class="n">doc</span><span class="o">.</span><span class="n">embfile_add</span><span class="p">(</span><span class="s2">&quot;my-embedded_file.pdf&quot;</span><span class="p">,</span> <span class="n">embedded_data</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;document-with-embed.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>As with <a class="reference internal" href="#the-basics-attaching-files"><span class="std std-ref">attaching files</span></a>, when adding the file with <a class="reference internal" href="document.html#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a> note that the first parameter for the <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code> should include the actual file extension.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a></p></li>
<li><p><a class="reference internal" href="document.html#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="deleting-pages">
<span id="the-basics-deleting-pages"></span><h2>Deleting Pages<a class="headerlink" href="#deleting-pages" title="Link to this heading">¶</a></h2>
<p>To delete a page from a document, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">delete_page</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># delete the 1st page of the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test-deleted-page-one.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<p>To delete a multiple pages from a document, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">delete_pages</span><span class="p">(</span><span class="n">from_page</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="c1"># delete a page range from the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test-deleted-pages.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<section id="what-happens-if-i-delete-a-page-referred-to-by-bookmarks-or-hyperlinks">
<h3>What happens if I delete a page referred to by bookmarks or hyperlinks?<a class="headerlink" href="#what-happens-if-i-delete-a-page-referred-to-by-bookmarks-or-hyperlinks" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>A bookmark (entry in the Table of Contents) will become inactive and will no longer navigate to any page.</p></li>
<li><p>A hyperlink will be removed from the page that contains it. The visible content on that page will not otherwise be changed in any way.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>The page index is zero-based, so to delete page 10 of a document you would do the following <code class="xref any docutils literal notranslate"><span class="pre">doc.delete_page(9)</span></code>.</p>
<p>Similarly, <code class="xref any docutils literal notranslate"><span class="pre">doc.delete_pages(from_page=9,</span> <span class="pre">to_page=14)</span></code> will delete pages 10 - 15 inclusive.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a></p></li>
<li><p><a class="reference internal" href="document.html#Document.delete_pages" title="Document.delete_pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
</section>
<section id="re-arranging-pages">
<span id="the-basics-rearrange-pages"></span><h2>Re-Arranging Pages<a class="headerlink" href="#re-arranging-pages" title="Link to this heading">¶</a></h2>
<p>To change the sequence of pages, i.e. re-arrange pages, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">move_page</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># move the 2nd page of the document to the start of the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test-page-moved.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.move_page" title="Document.move_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.move_page()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="copying-pages">
<span id="the-basics-copying-pages"></span><h2>Copying Pages<a class="headerlink" href="#copying-pages" title="Link to this heading">¶</a></h2>
<p>To copy pages, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">copy_page</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># copy the 1st page and puts it at the end of the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test-page-copied.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="selecting-pages">
<span id="the-basics-selecting-pages"></span><h2>Selecting Pages<a class="headerlink" href="#selecting-pages" title="Link to this heading">¶</a></h2>
<p>To select pages, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># select the 1st &amp; 2nd page of the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;just-page-one-and-two.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>With <cite>PyMuPDF</cite> you have all options to copy, move, delete or re-arrange the pages of a <cite>PDF</cite>. Intuitive methods exist that allow you to do this on a page-by-page level, like the <a class="reference internal" href="document.html#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a> method.</p>
<p>Or you alternatively prepare a complete new page layout in form of a <cite>Python</cite> sequence, that contains the page numbers you want, in the sequence you want, and as many times as you want each page. The following may illustrate what can be done with <a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Now let’s prepare a PDF for double-sided printing (on a printer not directly supporting this):</p>
<p>The number of pages is given by <code class="xref any docutils literal notranslate"><span class="pre">len(doc)</span></code> (equal to <code class="xref any docutils literal notranslate"><span class="pre">doc.page_count</span></code>). The following lists represent the even and the odd page numbers, respectively:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p_even</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">page_count</span><span class="p">)</span> <span class="k">if</span> <span class="n">p</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">p_odd</span>  <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">page_count</span><span class="p">)</span> <span class="k">if</span> <span class="n">p</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>This snippet creates the respective sub documents which can then be used to print the document:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">p_even</span><span class="p">)</span> <span class="c1"># only the even pages left over</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;even.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the &quot;even&quot; PDF</span>
<span class="n">doc</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># recycle the file</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="c1"># re-open</span>
<span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">p_odd</span><span class="p">)</span> <span class="c1"># and do the same with the odd pages</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;odd.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For more information also have a look at this Wiki <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/wiki/Rearranging-Pages-of-a-PDF">article</a>.</p>
<p>The following example will reverse the order of all pages (<strong>extremely fast:</strong> sub-second time for the 756 pages of the <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lastPage</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">page_count</span> <span class="o">-</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lastPage</span><span class="p">):</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">move_page</span><span class="p">(</span><span class="n">lastPage</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="c1"># move current last page to the front</span>
</pre></div>
</div>
<p>This snippet duplicates the PDF with itself so that it will contain the pages <em>0, 1, …, n, 0, 1, …, n</em> <strong>(extremely fast and without noticeably increasing the file size!)</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">page_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">page_count</span><span class="p">):</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">copy_page</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="c1"># copy this page to after last page</span>
</pre></div>
</div>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="adding-blank-pages">
<span id="the-basics-adding-blank-pages"></span><h2>Adding Blank Pages<a class="headerlink" href="#adding-blank-pages" title="Link to this heading">¶</a></h2>
<p>To add a blank page, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="c1"># some new or existing PDF document</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># insertion point: end of document</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="mi">595</span><span class="p">,</span> <span class="c1"># page dimension: A4 portrait</span>
                    <span class="n">height</span> <span class="o">=</span> <span class="mi">842</span><span class="p">)</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;doc-with-new-blank-page.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>Use this to create the page with another pre-defined paper format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">paper_size</span><span class="p">(</span><span class="s2">&quot;letter-l&quot;</span><span class="p">)</span>  <span class="c1"># &#39;Letter&#39; landscape</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="n">w</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
<p>The convenience function <a class="reference internal" href="functions.html#paper_size" title="paper_size"><code class="xref py py-meth docutils literal notranslate"><span class="pre">paper_size()</span></code></a> knows over 40 industry standard paper formats to choose from. To see them, inspect dictionary <code class="xref py py-attr docutils literal notranslate"><span class="pre">paperSizes</span></code>. Pass the desired dictionary key to <a class="reference internal" href="functions.html#paper_size" title="paper_size"><code class="xref py py-meth docutils literal notranslate"><span class="pre">paper_size()</span></code></a> to retrieve the paper dimensions. Upper and lower case is supported. If you append “-L” to the format name, the landscape version is returned.</p>
<p>Here is a 3-liner that creates a <cite>PDF</cite>: with one empty page. Its file size is 460 bytes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;A4.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.new_page" title="Document.new_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a></p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">paperSizes</span></code></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="inserting-pages-with-text-content">
<span id="the-basics-inserting-pages"></span><h2>Inserting Pages with Text Content<a class="headerlink" href="#inserting-pages-with-text-content" title="Link to this heading">¶</a></h2>
<p>Using the <a class="reference internal" href="document.html#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a> method also inserts a new page and accepts the same <a class="reference internal" href="irect.html#IRect.width" title="IRect.width"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">width</span></code></a> and <a class="reference internal" href="irect.html#IRect.height" title="IRect.height"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">height</span></code></a> parameters. But it lets you also insert arbitrary text into the new page and returns the number of inserted lines.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># some new or existing PDF document</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">insert_page</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># default insertion point</span>
                    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;The quick brown fox jumped over the lazy dog&quot;</span><span class="p">,</span>
                    <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="mi">595</span><span class="p">,</span>
                    <span class="n">height</span> <span class="o">=</span> <span class="mi">842</span><span class="p">,</span>
                    <span class="n">fontname</span> <span class="o">=</span> <span class="s2">&quot;Helvetica&quot;</span><span class="p">,</span> <span class="c1"># default font</span>
                    <span class="n">fontfile</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="c1"># any font file name</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1"># text color (RGB)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>The text parameter can be a (sequence of) string (assuming UTF-8 encoding). Insertion will start at <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a> (50, 72), which is one inch below top of page and 50 points from the left. The number of inserted text lines is returned.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="splitting-single-pages">
<span id="the-basics-spliting-single-pages"></span><h2>Splitting Single Pages<a class="headerlink" href="#splitting-single-pages" title="Link to this heading">¶</a></h2>
<p>This deals with splitting up pages of a <cite>PDF</cite> in arbitrary pieces. For example, you may have a <cite>PDF</cite> with <em>Letter</em> format pages which you want to print with a magnification factor of four: each page is split up in 4 pieces which each going to a separate <cite>PDF</cite> page in <em>Letter</em> format again.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">src</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>  <span class="c1"># empty output PDF</span>

<span class="k">for</span> <span class="n">spage</span> <span class="ow">in</span> <span class="n">src</span><span class="p">:</span>  <span class="c1"># for each page in input</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">spage</span><span class="o">.</span><span class="n">rect</span>  <span class="c1"># input page rectangle</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">spage</span><span class="o">.</span><span class="n">cropbox_position</span><span class="p">,</span>  <span class="c1"># CropBox displacement if not</span>
                  <span class="n">spage</span><span class="o">.</span><span class="n">cropbox_position</span><span class="p">)</span>  <span class="c1"># starting at (0, 0)</span>
    <span class="c1">#--------------------------------------------------------------------------</span>
    <span class="c1"># example: cut input page into 2 x 2 parts</span>
    <span class="c1">#--------------------------------------------------------------------------</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># top left rect</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># top right rect</span>
    <span class="n">r3</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>  <span class="c1"># bottom left rect</span>
    <span class="n">r4</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">br</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">br</span><span class="p">)</span>  <span class="c1"># bottom right rect</span>
    <span class="n">rect_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r4</span><span class="p">]</span>  <span class="c1"># put them in a list</span>

    <span class="k">for</span> <span class="n">rx</span> <span class="ow">in</span> <span class="n">rect_list</span><span class="p">:</span>  <span class="c1"># run thru rect list</span>
        <span class="n">rx</span> <span class="o">+=</span> <span class="n">d</span>  <span class="c1"># add the CropBox displacement</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># new output page with rx dimensions</span>
                           <span class="n">width</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                           <span class="n">height</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="n">page</span><span class="o">.</span><span class="n">show_pdf_page</span><span class="p">(</span>
                <span class="n">page</span><span class="o">.</span><span class="n">rect</span><span class="p">,</span>  <span class="c1"># fill all new page with the image</span>
                <span class="n">src</span><span class="p">,</span>  <span class="c1"># input document</span>
                <span class="n">spage</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>  <span class="c1"># input page number</span>
                <span class="n">clip</span> <span class="o">=</span> <span class="n">rx</span><span class="p">,</span>  <span class="c1"># which part to use of input page</span>
            <span class="p">)</span>

<span class="c1"># that&#39;s it, save output file</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;poster-&quot;</span> <span class="o">+</span> <span class="n">src</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
         <span class="n">garbage</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># eliminate duplicate objects</span>
         <span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># compress stuff where possible</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Example:</p>
<img alt="_images/img-posterize.png" src="_images/img-posterize.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.cropbox_position" title="Page.cropbox_position"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.cropbox_position()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="combining-single-pages">
<span id="the-basics-combining-single-pages"></span><h2>Combining Single Pages<a class="headerlink" href="#combining-single-pages" title="Link to this heading">¶</a></h2>
<p>This deals with joining <cite>PDF</cite> pages to form a new <cite>PDF</cite> with pages each combining two or four original ones (also called “2-up”, “4-up”, etc.). This could be used to create booklets or thumbnail-like overviews.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">src</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>  <span class="c1"># empty output PDF</span>

<span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">paper_size</span><span class="p">(</span><span class="s2">&quot;a4&quot;</span><span class="p">)</span>  <span class="c1"># A4 portrait output page format</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

<span class="c1"># define the 4 rectangles per page</span>
<span class="n">r1</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># top left rect</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># top right</span>
<span class="n">r3</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>  <span class="c1"># bottom left</span>
<span class="n">r4</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">br</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">br</span><span class="p">)</span>  <span class="c1"># bottom right</span>

<span class="c1"># put them in a list</span>
<span class="n">r_tab</span> <span class="o">=</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r4</span><span class="p">]</span>

<span class="c1"># now copy input pages to output</span>
<span class="k">for</span> <span class="n">spage</span> <span class="ow">in</span> <span class="n">src</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">spage</span><span class="o">.</span><span class="n">number</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># create new output page</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                      <span class="n">width</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span>
                      <span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="p">)</span>
    <span class="c1"># insert input page into the correct rectangle</span>
    <span class="n">page</span><span class="o">.</span><span class="n">show_pdf_page</span><span class="p">(</span><span class="n">r_tab</span><span class="p">[</span><span class="n">spage</span><span class="o">.</span><span class="n">number</span> <span class="o">%</span> <span class="mi">4</span><span class="p">],</span>  <span class="c1"># select output rect</span>
                     <span class="n">src</span><span class="p">,</span>  <span class="c1"># input document</span>
                     <span class="n">spage</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>  <span class="c1"># input page number</span>

<span class="c1"># by all means, save new file using garbage collection and compression</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;4up.pdf&quot;</span><span class="p">,</span> <span class="n">garbage</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Example:</p>
<img alt="_images/img-4up.png" src="_images/img-4up.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.cropbox_position" title="Page.cropbox_position"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.cropbox_position()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="pdf-encryption-decryption">
<span id="the-basics-encryption-and-decryption"></span><h2><cite>PDF</cite> Encryption &amp; Decryption<a class="headerlink" href="#pdf-encryption-decryption" title="Link to this heading">¶</a></h2>
<p>Starting with version 1.16.0, <cite>PDF</cite> decryption and encryption (using passwords) are fully supported. You can do the following:</p>
<ul>
<li><p>Check whether a document is password protected / (still) encrypted (<a class="reference internal" href="document.html#Document.needs_pass" title="Document.needs_pass"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.needs_pass</span></code></a>, <a class="reference internal" href="document.html#Document.is_encrypted" title="Document.is_encrypted"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_encrypted</span></code></a>).</p></li>
<li><p>Gain access authorization to a document (<a class="reference internal" href="document.html#Document.authenticate" title="Document.authenticate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.authenticate()</span></code></a>).</p></li>
<li><p>Set encryption details for PDF files using <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> or <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.write()</span></code> and</p>
<blockquote>
<div><ul class="simple">
<li><p>decrypt or encrypt the content</p></li>
<li><p>set password(s)</p></li>
<li><p>set the encryption method</p></li>
<li><p>set permission details</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A PDF document may have two different passwords:</p>
<ul class="simple">
<li><p>The <strong>owner password</strong> provides full access rights, including changing passwords, encryption method, or permission detail.</p></li>
<li><p>The <strong>user password</strong> provides access to document content according to the established permission details. If present, opening the <cite>PDF</cite> in a viewer will require providing it.</p></li>
</ul>
<p>Method <a class="reference internal" href="document.html#Document.authenticate" title="Document.authenticate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.authenticate()</span></code></a> will automatically establish access rights according to the password used.</p>
</div>
<p>The following snippet creates a new <cite>PDF</cite> and encrypts it with separate user and owner passwords. Permissions are granted to print, copy and annotate, but no changes are allowed to someone authenticating with the user password.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;some secret information&quot;</span> <span class="c1"># keep this data secret</span>
<span class="n">perm</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
    <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_PERM_ACCESSIBILITY</span> <span class="c1"># always use this</span>
    <span class="o">|</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_PERM_PRINT</span> <span class="c1"># permit printing</span>
    <span class="o">|</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_PERM_COPY</span> <span class="c1"># permit copying</span>
    <span class="o">|</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_PERM_ANNOTATE</span> <span class="c1"># permit annotations</span>
<span class="p">)</span>
<span class="n">owner_pass</span> <span class="o">=</span> <span class="s2">&quot;owner&quot;</span> <span class="c1"># owner password</span>
<span class="n">user_pass</span> <span class="o">=</span> <span class="s2">&quot;user&quot;</span> <span class="c1"># user password</span>
<span class="n">encrypt_meth</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_ENCRYPT_AES_256</span> <span class="c1"># strongest algorithm</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="c1"># empty pdf</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span> <span class="c1"># empty page</span>
<span class="n">page</span><span class="o">.</span><span class="n">insert_text</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">72</span><span class="p">),</span> <span class="n">text</span><span class="p">)</span> <span class="c1"># insert the data</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
    <span class="s2">&quot;secret.pdf&quot;</span><span class="p">,</span>
    <span class="n">encryption</span><span class="o">=</span><span class="n">encrypt_meth</span><span class="p">,</span> <span class="c1"># set the encryption method</span>
    <span class="n">owner_pw</span><span class="o">=</span><span class="n">owner_pass</span><span class="p">,</span> <span class="c1"># set the owner password</span>
    <span class="n">user_pw</span><span class="o">=</span><span class="n">user_pass</span><span class="p">,</span> <span class="c1"># set the user password</span>
    <span class="n">permissions</span><span class="o">=</span><span class="n">perm</span><span class="p">,</span> <span class="c1"># set permissions</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>Opening this document with some viewer (Nitro Reader 5) reflects these settings:</p>
<img alt="_images/img-encrypting.jpg" src="_images/img-encrypting.jpg" />
<p><strong>Decrypting</strong> will automatically happen on save as before when no encryption parameters are provided.</p>
<p>To <strong>keep the encryption method</strong> of a PDF save it using <code class="xref any docutils literal notranslate"><span class="pre">encryption=pymupdf.PDF_ENCRYPT_KEEP</span></code>. If <code class="xref any docutils literal notranslate"><span class="pre">doc.can_save_incrementally()</span> <span class="pre">==</span> <span class="pre">True</span></code>, an incremental save is also possible.</p>
<p>To <strong>change the encryption method</strong> specify the full range of options above (<code class="xref any docutils literal notranslate"><span class="pre">encryption</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">owner_pw</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">user_pw</span></code>, <a class="reference internal" href="document.html#Document.permissions" title="Document.permissions"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">permissions</span></code></a>). An incremental save is <strong>not possible</strong> in this case.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="extracting-tables-from-a-page">
<span id="the-basics-extracting-tables"></span><h2>Extracting Tables from a <cite>Page</cite><a class="headerlink" href="#extracting-tables-from-a-page" title="Link to this heading">¶</a></h2>
<p>Tables can be found and extracted from any document <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open document</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get the 1st page of the document</span>
<span class="n">tabs</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">find_tables</span><span class="p">()</span> <span class="c1"># locate and extract any tables on page</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tabs</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span><span class="si">}</span><span class="s2"> found on </span><span class="si">{</span><span class="n">page</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># display number of found tables</span>

<span class="k">if</span> <span class="n">tabs</span><span class="o">.</span><span class="n">tables</span><span class="p">:</span>  <span class="c1"># at least one table found?</span>
   <span class="n">pprint</span><span class="p">(</span><span class="n">tabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">extract</span><span class="p">())</span>  <span class="c1"># print content of first table</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.find_tables" title="Page.find_tables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.find_tables()</span></code></a></p></li>
</ul>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>There is also the <a class="reference external" href="https://pdf2docx.readthedocs.io/en/latest/quickstart.table.html">pdf2docx extract tables method</a> which is capable of table extraction if you prefer.</p>
</div>
<hr class="docutils" />
</section>
<section id="getting-page-links">
<span id="the-basics-get-page-links"></span><h2>Getting Page Links<a class="headerlink" href="#getting-page-links" title="Link to this heading">¶</a></h2>
<p>Links can be extracted from a <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> to return <a class="reference internal" href="link.html#link"><span class="std std-ref">Link</span></a> objects.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span> <span class="c1"># iterate the document pages</span>
    <span class="n">link</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">first_link</span>  <span class="c1"># a `Link` object or `None`</span>

    <span class="k">while</span> <span class="n">link</span><span class="p">:</span> <span class="c1"># iterate over the links on page</span>
        <span class="c1"># do something with the link, then:</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">next</span> <span class="c1"># get next link, last one has `None` in its `next`</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.first_link" title="Page.first_link"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.first_link()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="getting-all-annotations-from-a-document">
<span id="the-basics-get-all-annotations"></span><h2>Getting All Annotations from a Document<a class="headerlink" href="#getting-all-annotations-from-a-document" title="Link to this heading">¶</a></h2>
<p>Annotations (<a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a>) on pages can be retrieved with the <code class="xref any docutils literal notranslate"><span class="pre">page.annots()</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">annot</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">annots</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Annotation on page: </span><span class="si">{</span><span class="n">page</span><span class="o">.</span><span class="n">number</span><span class="si">}</span><span class="s1"> with type: </span><span class="si">{</span><span class="n">annot</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1"> and rect: </span><span class="si">{</span><span class="n">annot</span><span class="o">.</span><span class="n">rect</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.annots" title="Page.annots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annots()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="redacting-content-from-a-pdf">
<span id="the-basics-redacting"></span><h2>Redacting content from a <strong>PDF</strong><a class="headerlink" href="#redacting-content-from-a-pdf" title="Link to this heading">¶</a></h2>
<p>Redactions are special types of annotations which can be marked onto a document page to denote an area on the page which should be securely removed. After marking an area with a rectangle then this area will be marked for <em>redaction</em>, once the redaction is <em>applied</em> then the content is securely removed.</p>
<p>For example if we wanted to redact all instances of the name “Jane Doe” from a document we could do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="c1"># Open the PDF document</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;test.pdf&#39;</span><span class="p">)</span>

<span class="c1"># Iterate over each page of the document</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
    <span class="c1"># Find all instances of &quot;Jane Doe&quot; on the current page</span>
    <span class="n">instances</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">search_for</span><span class="p">(</span><span class="s2">&quot;Jane Doe&quot;</span><span class="p">)</span>

    <span class="c1"># Redact each instance of &quot;Jane Doe&quot; on the current page</span>
    <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
        <span class="n">page</span><span class="o">.</span><span class="n">add_redact_annot</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>

    <span class="c1"># Apply the redactions to the current page</span>
    <span class="n">page</span><span class="o">.</span><span class="n">apply_redactions</span><span class="p">()</span>

<span class="c1"># Save the modified document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;redacted_document.pdf&#39;</span><span class="p">)</span>

<span class="c1"># Close the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Another example could be redacting an area of a page, but not to redact any line art (i.e. vector graphics) within the defined area, by setting a parameter flag as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>

<span class="c1"># Open the PDF document</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;test.pdf&#39;</span><span class="p">)</span>

<span class="c1"># Get the first page</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Add an area to redact</span>
<span class="n">rect</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span>

<span class="c1"># Add a redacction annotation which will have a red fill color</span>
<span class="n">page</span><span class="o">.</span><span class="n">add_redact_annot</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Apply the redactions to the current page, but ignore vector graphics</span>
<span class="n">page</span><span class="o">.</span><span class="n">apply_redactions</span><span class="p">(</span><span class="n">graphics</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Save the modified document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;redactied_document.pdf&#39;</span><span class="p">)</span>

<span class="c1"># Close the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Once a redacted version of a document is saved then the redacted content in the <strong>PDF</strong> is <em>irretrievable</em>. Thus, a redacted area in a document removes text and graphics completely from that area.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Taking it further</strong></p>
<p>The are a few options for creating and applying redactions to a page, for the full API details to understand the parameters to control these options refer to the API reference.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.add_redact_annot" title="Page.add_redact_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_redact_annot()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.apply_redactions" title="Page.apply_redactions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.apply_redactions()</span></code></a></p></li>
</ul>
</div>
<hr class="docutils" />
</section>
<section id="converting-pdf-documents">
<span id="the-basics-coverting-pdf-documents"></span><h2>Converting PDF Documents<a class="headerlink" href="#converting-pdf-documents" title="Link to this heading">¶</a></h2>
<p>We recommend the <a class="reference external" href="https://pdf2docx.readthedocs.io/en/latest/">pdf2docx</a> library which uses <strong>PyMuPDF</strong> and the <strong>python-docx</strong> library to provide simple document conversion from <strong>PDF</strong> to <strong>DOCX</strong> format.</p>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>Do you have any feedback on this page?</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.3.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="tutorial.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tutorial</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="installation.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Installation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 10. Mar 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">The Basics</a><ul>
<li><a class="reference internal" href="#opening-a-file">Opening a File</a></li>
<li><a class="reference internal" href="#extract-text-from-a-pdf">Extract text from a <cite>PDF</cite></a></li>
<li><a class="reference internal" href="#extract-images-from-a-pdf">Extract images from a <cite>PDF</cite></a></li>
<li><a class="reference internal" href="#extract-vector-graphics">Extract vector graphics</a></li>
<li><a class="reference internal" href="#merging-pdf-files">Merging <cite>PDF</cite> files</a><ul>
<li><a class="reference internal" href="#merging-pdf-files-with-other-types-of-file">Merging <cite>PDF</cite> files with other types of file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-coordinates">Working with Coordinates</a></li>
<li><a class="reference internal" href="#adding-a-watermark-to-a-pdf">Adding a watermark to a <cite>PDF</cite></a></li>
<li><a class="reference internal" href="#adding-an-image-to-a-pdf">Adding an image to a <cite>PDF</cite></a></li>
<li><a class="reference internal" href="#rotating-a-pdf">Rotating a <cite>PDF</cite></a></li>
<li><a class="reference internal" href="#cropping-a-pdf">Cropping a <cite>PDF</cite></a></li>
<li><a class="reference internal" href="#attaching-files">Attaching Files</a></li>
<li><a class="reference internal" href="#embedding-files">Embedding Files</a></li>
<li><a class="reference internal" href="#deleting-pages">Deleting Pages</a><ul>
<li><a class="reference internal" href="#what-happens-if-i-delete-a-page-referred-to-by-bookmarks-or-hyperlinks">What happens if I delete a page referred to by bookmarks or hyperlinks?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#re-arranging-pages">Re-Arranging Pages</a></li>
<li><a class="reference internal" href="#copying-pages">Copying Pages</a></li>
<li><a class="reference internal" href="#selecting-pages">Selecting Pages</a></li>
<li><a class="reference internal" href="#adding-blank-pages">Adding Blank Pages</a></li>
<li><a class="reference internal" href="#inserting-pages-with-text-content">Inserting Pages with Text Content</a></li>
<li><a class="reference internal" href="#splitting-single-pages">Splitting Single Pages</a></li>
<li><a class="reference internal" href="#combining-single-pages">Combining Single Pages</a></li>
<li><a class="reference internal" href="#pdf-encryption-decryption"><cite>PDF</cite> Encryption &amp; Decryption</a></li>
<li><a class="reference internal" href="#extracting-tables-from-a-page">Extracting Tables from a <cite>Page</cite></a></li>
<li><a class="reference internal" href="#getting-page-links">Getting Page Links</a></li>
<li><a class="reference internal" href="#getting-all-annotations-from-a-document">Getting All Annotations from a Document</a></li>
<li><a class="reference internal" href="#redacting-content-from-a-pdf">Redacting content from a <strong>PDF</strong></a></li>
<li><a class="reference internal" href="#converting-pdf-documents">Converting PDF Documents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=9ddcf537"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    </body>
</html>