<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF is a high-performance Python library for data extraction, analysis, conversion &amp; manipulation of PDF (and other) documents." name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="About these documents" href="about.html" /><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Appendix 2: Considerations on Embedded Files" href="app2.html" /><link rel="prev" title="Color Database" href="colors.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Appendix 1: Details on Text Extraction - PyMuPDF 1.25.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=74643500" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.3 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.3 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">Features Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#performance">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#license-and-copyright">License and Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">The Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF, LLM &amp; RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">Opening Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">Drawing and Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">Stories</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">Journalling</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">Multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - Optical Character Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">Optional Content Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">Low-Level Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">Common Issues and their Solutions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module.html">Command line interface</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="classes.html">Classes</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">Operator Algebra for Geometry Objects</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">Low Level Functions and Classes</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Low Level Functions and Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">Working together: DisplayList and TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">Constants and Enumerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">Color Database</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Appendix 1: Details on Text Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">Appendix 2: Considerations on Embedded Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">Appendix 3: Assorted Technical Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">Appendix 4: Performance Comparison Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">Deprecated Names</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/app1.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <style>

    #languageToggle {
        width:25%;
        margin:8px 10px 0;
    }

    #button-select-en {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 10px 0 0 10px;
        font-size: 14px;
    }

    #button-select-ja {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 0px 10px 10px 0;
        border-left: 0;
        font-size: 14px;
    }

    #button-select-en , #button-select-ja, #button-select-en:hover , #button-select-ja:hover  {
        color: #fff;
        text-decoration: none;
    }

    /* small screens */
    @media all and (max-width : 768px)  {
        #languageToggle {
            width:50%;
        }
    }

    @media all and (max-width : 400px)  {
        #languageToggle {
            width:70%;
        }
    }

    @media all and (max-width : 375px)  {
        #button-select-en , #button-select-ja {
            font-size: 11px;
        }
    }

</style>

<div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
    <div id="languageToggle"><span><a id="button-select-en" href="javaScript:changeLanguage('en')">English</a></span><span><a id="button-select-ja" href="javaScript:changeLanguage('ja')">日本語</a></span></div>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

    <div class="feedbackLink"><a id="feedbackLinkTop" target=_blank>Do you have any feedback on this page?</b></a></div>
</div>

<script>
    // highlightSelectedLanguage

    if (document.getElementsByTagName('html')[0].getAttribute('lang')=="ja") {
        document.getElementById("button-select-ja").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-en").style.color = "#000";
    } else {
        document.getElementById("button-select-en").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-ja").style.color = "#000";
    }


    var url_string = window.location.href;
    var a = document.getElementById('feedbackLinkTop');
    a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=header-link&url="+url_string);

    function changeLanguage(lang) {
        var new_url;

        if (lang == "en") {
            new_url = url_string.replace("/ja/", "/en/");
        } else {
            new_url = url_string.replace("/en/", "/ja/");
        }

        window.location.replace(new_url);
    }

</script><section id="appendix-1-details-on-text-extraction">
<span id="appendix1"></span><h1>Appendix 1: Details on Text Extraction<a class="headerlink" href="#appendix-1-details-on-text-extraction" title="Link to this heading">¶</a></h1>
<p>This chapter provides background on the text extraction methods of PyMuPDF.</p>
<p>Information of interest are</p>
<ul class="simple">
<li><p>what do they provide?</p></li>
<li><p>what do they imply (processing time / data sizes)?</p></li>
</ul>
<section id="general-structure-of-a-textpage">
<h2>General structure of a TextPage<a class="headerlink" href="#general-structure-of-a-textpage" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> is one of (Py-) MuPDF’s classes. It is normally created (and destroyed again) behind the curtain, when <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> text extraction methods are used, but it is also available directly and can be used as a persistent object. Other than its name suggests, images may optionally also be part of a text page:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">page</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">text</span> <span class="n">block</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">line</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">span</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">char</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">image</span> <span class="n">block</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">img</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>A <strong>text page</strong> consists of blocks (= roughly paragraphs).</p>
<p>A <strong>block</strong> consists of either lines and their characters, or an image.</p>
<p>A <strong>line</strong> consists of spans.</p>
<p>A <strong>span</strong> consists of adjacent characters with identical font properties: name, size, flags and color.</p>
</section>
<section id="plain-text">
<h2>Plain Text<a class="headerlink" href="#plain-text" title="Link to this heading">¶</a></h2>
<p>Function <a class="reference internal" href="textpage.html#TextPage.extractText" title="TextPage.extractText"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractText()</span></code></a> (or <em>Page.get_text(“text”)</em>) extracts a page’s plain <strong>text in original order</strong> as specified by the creator of the document.</p>
<p>An example output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">))</span>
<span class="go">Some text on first page.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The output may not equal an accustomed “natural” reading order. However, you can request a reordering following the scheme “top-left to bottom-right” by executing <code class="xref any docutils literal notranslate"><span class="pre">page.get_text(&quot;text&quot;,</span> <span class="pre">sort=True)</span></code>.</p>
</div>
</section>
<section id="blocks">
<h2>BLOCKS<a class="headerlink" href="#blocks" title="Link to this heading">¶</a></h2>
<p>Function <a class="reference internal" href="textpage.html#TextPage.extractBLOCKS" title="TextPage.extractBLOCKS"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractBLOCKS()</span></code></a> (or <em>Page.get_text(“blocks”)</em>) extracts a page’s text blocks as a list of items like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s2">&quot;lines in block&quot;</span><span class="p">,</span> <span class="n">block_no</span><span class="p">,</span> <span class="n">block_type</span><span class="p">)</span>
</pre></div>
</div>
<p>Where the first 4 items are the float coordinates of the block’s bbox. The lines within each block are concatenated by a new-line character.</p>
<p>This is a high-speed method, which by default also extracts image meta information: Each image appears as a block with one text line, which contains meta information. The image itself is not shown.</p>
<p>As with simple text output above, the <code class="xref any docutils literal notranslate"><span class="pre">sort</span></code> argument can be used as well to obtain a reading order.</p>
<p>Example output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="s2">&quot;blocks&quot;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">[(50.0, 88.17500305175781, 166.1709747314453, 103.28900146484375,</span>
<span class="go">&#39;Some text on first page.&#39;, 0, 0)]</span>
</pre></div>
</div>
</section>
<section id="words">
<h2>WORDS<a class="headerlink" href="#words" title="Link to this heading">¶</a></h2>
<p>Function <a class="reference internal" href="textpage.html#TextPage.extractWORDS" title="TextPage.extractWORDS"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractWORDS()</span></code></a> (or <em>Page.get_text(“words”)</em>) extracts a page’s text <strong>words</strong> as a list of items like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s2">&quot;word&quot;</span><span class="p">,</span> <span class="n">block_no</span><span class="p">,</span> <span class="n">line_no</span><span class="p">,</span> <span class="n">word_no</span><span class="p">)</span>
</pre></div>
</div>
<p>Where the first 4 items are the float coordinates of the words’s bbox. The last three integers provide some more information on the word’s whereabouts.</p>
<p>This is a high-speed method. As with the previous methods, argument <code class="xref any docutils literal notranslate"><span class="pre">sort=True</span></code> will reorder the words.</p>
<p>Example output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="s2">&quot;words&quot;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="go">        print(word)</span>
<span class="go">(50.0, 88.17500305175781, 78.73200225830078, 103.28900146484375,</span>
<span class="go">&#39;Some&#39;, 0, 0, 0)</span>
<span class="go">(81.79000091552734, 88.17500305175781, 99.5219955444336, 103.28900146484375,</span>
<span class="go">&#39;text&#39;, 0, 0, 1)</span>
<span class="go">(102.57999420166016, 88.17500305175781, 114.8119888305664, 103.28900146484375,</span>
<span class="go">&#39;on&#39;, 0, 0, 2)</span>
<span class="go">(117.86998748779297, 88.17500305175781, 135.5909881591797, 103.28900146484375,</span>
<span class="go">&#39;first&#39;, 0, 0, 3)</span>
<span class="go">(138.64898681640625, 88.17500305175781, 166.1709747314453, 103.28900146484375,</span>
<span class="go">&#39;page.&#39;, 0, 0, 4)</span>
</pre></div>
</div>
</section>
<section id="html">
<h2>HTML<a class="headerlink" href="#html" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="textpage.html#TextPage.extractHTML" title="TextPage.extractHTML"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractHTML()</span></code></a> (or <em>Page.get_text(“html”)</em> output fully reflects the structure of the page’s <em>TextPage</em> – much like DICT / JSON below. This includes images, font information and text positions. If wrapped in HTML header and trailer code, it can readily be displayed by an internet browser. Our above example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="s2">&quot;html&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
<span class="go">        print(line)</span>

<span class="go">&lt;div id=&quot;page0&quot; style=&quot;position:relative;width:300pt;height:350pt;</span>
<span class="go">background-color:white&quot;&gt;</span>
<span class="go">&lt;p style=&quot;position:absolute;white-space:pre;margin:0;padding:0;top:88pt;</span>
<span class="go">left:50pt&quot;&gt;&lt;span style=&quot;font-family:Helvetica,sans-serif;</span>
<span class="go">font-size:11pt&quot;&gt;Some text on first page.&lt;/span&gt;&lt;/p&gt;</span>
<span class="go">&lt;/div&gt;</span>
</pre></div>
</div>
</section>
<section id="controlling-quality-of-html-output">
<span id="htmlquality"></span><h2>Controlling Quality of HTML Output<a class="headerlink" href="#controlling-quality-of-html-output" title="Link to this heading">¶</a></h2>
<p>While HTML output has improved a lot in MuPDF v1.12.0, it is not yet bug-free: we have found problems in the areas <strong>font support</strong> and <strong>image positioning</strong>.</p>
<ul class="simple">
<li><p>HTML text contains references to the fonts used of the original document. If these are not known to the browser (a fat chance!), it will replace them with others; the results will probably look awkward. This issue varies greatly by browser – on my Windows machine, MS Edge worked just fine, whereas Firefox looked horrible.</p></li>
<li><p>For PDFs with a complex structure, images may not be positioned and / or sized correctly. This seems to be the case for rotated pages and pages, where the various possible page bbox variants do not coincide (e.g. <em>MediaBox != CropBox</em>). We do not know yet, how to address this – we filed a bug at MuPDF’s site.</p></li>
</ul>
<p>To address the font issue, you can use a simple utility script to scan through the HTML file and replace font references. Here is a little example that replaces all fonts with one of the <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 Fonts</span></a>: serifed fonts will become “Times”, non-serifed “Helvetica” and monospaced will become “Courier”. Their respective variations for “bold”, “italic”, etc. are hopefully done correctly by your browser:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">otext</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>                 <span class="c1"># original html text string</span>
<span class="n">pos1</span> <span class="o">=</span> <span class="mi">0</span>                                      <span class="c1"># search start poition</span>
<span class="n">font_serif</span> <span class="o">=</span> <span class="s2">&quot;font-family:Times&quot;</span>              <span class="c1"># enter ...</span>
<span class="n">font_sans</span>  <span class="o">=</span> <span class="s2">&quot;font-family:Helvetica&quot;</span>          <span class="c1"># ... your choices ...</span>
<span class="n">font_mono</span>  <span class="o">=</span> <span class="s2">&quot;font-family:Courier&quot;</span>            <span class="c1"># ... here</span>
<span class="n">found_one</span>  <span class="o">=</span> <span class="kc">False</span>                            <span class="c1"># true if search successful</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">pos0</span> <span class="o">=</span> <span class="n">otext</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;font-family:&quot;</span><span class="p">,</span> <span class="n">pos1</span><span class="p">)</span>   <span class="c1"># start of a font spec</span>
    <span class="k">if</span> <span class="n">pos0</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>                              <span class="c1"># none found - we are done</span>
        <span class="k">break</span>
    <span class="n">pos1</span> <span class="o">=</span> <span class="n">otext</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="n">pos0</span><span class="p">)</span>              <span class="c1"># end of font spec</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">otext</span><span class="p">[</span><span class="n">pos0</span> <span class="p">:</span> <span class="n">pos1</span><span class="p">]</span>                 <span class="c1"># complete font spec string</span>
    <span class="n">testn</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>                                <span class="c1"># the new font spec string</span>
    <span class="k">if</span> <span class="n">test</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;,serif&quot;</span><span class="p">):</span>               <span class="c1"># font with serifs?</span>
        <span class="n">testn</span> <span class="o">=</span> <span class="n">font_serif</span>                    <span class="c1"># use Times instead</span>
    <span class="k">elif</span> <span class="n">test</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;,sans-serif&quot;</span><span class="p">):</span>        <span class="c1"># sans serifs font?</span>
        <span class="n">testn</span> <span class="o">=</span> <span class="n">font_sans</span>                     <span class="c1"># use Helvetica</span>
    <span class="k">elif</span> <span class="n">test</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;,monospace&quot;</span><span class="p">):</span>         <span class="c1"># monospaced font?</span>
        <span class="n">testn</span> <span class="o">=</span> <span class="n">font_mono</span>                     <span class="c1"># becomes Courier</span>

    <span class="k">if</span> <span class="n">testn</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>                           <span class="c1"># any of the above found?</span>
        <span class="n">otext</span> <span class="o">=</span> <span class="n">otext</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">testn</span><span class="p">)</span>    <span class="c1"># change the source</span>
        <span class="n">found_one</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">pos1</span> <span class="o">=</span> <span class="mi">0</span>                              <span class="c1"># start over</span>

<span class="k">if</span> <span class="n">found_one</span><span class="p">:</span>
    <span class="n">ofile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.html&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="n">ofile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">otext</span><span class="p">)</span>
    <span class="n">ofile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: could not find any font specs!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="dict-or-json">
<h2>DICT (or JSON)<a class="headerlink" href="#dict-or-json" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="textpage.html#TextPage.extractDICT" title="TextPage.extractDICT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractDICT()</span></code></a> (or <em>Page.get_text(“dict”, sort=False)</em>) output fully reflects the structure of a <em>TextPage</em> and provides image content and position detail (<em>bbox</em> – boundary boxes in pixel units) for every block, line and span. Images are stored as <em>bytes</em> for DICT output and base64 encoded strings for JSON output.</p>
<p>For a visualization of the dictionary structure have a look at <a class="reference internal" href="textpage.html#textpagedict"><span class="std std-ref">Structure of Dictionary Outputs</span></a>.</p>
<p>Here is how this looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">300.0</span><span class="p">,</span>
    <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="mf">350.0</span><span class="p">,</span>
    <span class="s2">&quot;blocks&quot;</span><span class="p">:</span> <span class="p">[{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">88.17500305175781</span><span class="p">,</span> <span class="mf">166.1709747314453</span><span class="p">,</span> <span class="mf">103.28900146484375</span><span class="p">),</span>
        <span class="s2">&quot;lines&quot;</span><span class="p">:</span> <span class="p">({</span>
            <span class="s2">&quot;wmode&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;dir&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
            <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">88.17500305175781</span><span class="p">,</span> <span class="mf">166.1709747314453</span><span class="p">,</span> <span class="mf">103.28900146484375</span><span class="p">),</span>
            <span class="s2">&quot;spans&quot;</span><span class="p">:</span> <span class="p">({</span>
                <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mf">11.0</span><span class="p">,</span>
                <span class="s2">&quot;flags&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s2">&quot;font&quot;</span><span class="p">:</span> <span class="s2">&quot;Helvetica&quot;</span><span class="p">,</span>
                <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">),</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Some text on first page.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">88.17500305175781</span><span class="p">,</span> <span class="mf">166.1709747314453</span><span class="p">,</span> <span class="mf">103.28900146484375</span><span class="p">)</span>
            <span class="p">})</span>
        <span class="p">}]</span>
    <span class="p">}]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="rawdict-or-rawjson">
<h2>RAWDICT (or RAWJSON)<a class="headerlink" href="#rawdict-or-rawjson" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="textpage.html#TextPage.extractRAWDICT" title="TextPage.extractRAWDICT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractRAWDICT()</span></code></a> (or <em>Page.get_text(“rawdict”, sort=False)</em>) is an <strong>information superset of DICT</strong> and takes the detail level one step deeper. It looks exactly like the above, except that the <em>“text”</em> items (<em>string</em>) in the spans are replaced by the list <em>“chars”</em>. Each <em>“chars”</em> entry is a character <em>dict</em>. For example, here is what you would see in place of item <em>“text”: “Text in black color.”</em> above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;chars&quot;</span><span class="p">:</span> <span class="p">[{</span>
    <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">),</span>
    <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">88.17500305175781</span><span class="p">,</span> <span class="mf">57.336997985839844</span><span class="p">,</span> <span class="mf">103.28900146484375</span><span class="p">),</span>
    <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;S&quot;</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">57.33700180053711</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">),</span>
    <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">57.33700180053711</span><span class="p">,</span> <span class="mf">88.17500305175781</span><span class="p">,</span> <span class="mf">63.4530029296875</span><span class="p">,</span> <span class="mf">103.28900146484375</span><span class="p">),</span>
    <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">63.4530029296875</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">),</span>
    <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">63.4530029296875</span><span class="p">,</span> <span class="mf">88.17500305175781</span><span class="p">,</span> <span class="mf">72.61600494384766</span><span class="p">,</span> <span class="mf">103.28900146484375</span><span class="p">),</span>
    <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">72.61600494384766</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">),</span>
    <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">72.61600494384766</span><span class="p">,</span> <span class="mf">88.17500305175781</span><span class="p">,</span> <span class="mf">78.73200225830078</span><span class="p">,</span> <span class="mf">103.28900146484375</span><span class="p">),</span>
    <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;e&quot;</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">78.73200225830078</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">),</span>
    <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">78.73200225830078</span><span class="p">,</span> <span class="mf">88.17500305175781</span><span class="p">,</span> <span class="mf">81.79000091552734</span><span class="p">,</span> <span class="mf">103.28900146484375</span><span class="p">),</span>
    <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot; &quot;</span>
<span class="o">&lt;</span> <span class="o">...</span> <span class="n">deleted</span> <span class="o">...</span> <span class="o">&gt;</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">163.11297607421875</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">),</span>
    <span class="s2">&quot;bbox&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">163.11297607421875</span><span class="p">,</span> <span class="mf">88.17500305175781</span><span class="p">,</span> <span class="mf">166.1709747314453</span><span class="p">,</span> <span class="mf">103.28900146484375</span><span class="p">),</span>
    <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;.&quot;</span>
<span class="p">}],</span>
</pre></div>
</div>
</section>
<section id="xml">
<h2>XML<a class="headerlink" href="#xml" title="Link to this heading">¶</a></h2>
<p>The <a class="reference internal" href="textpage.html#TextPage.extractXML" title="TextPage.extractXML"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractXML()</span></code></a> (or <em>Page.get_text(“xml”)</em>) version extracts text (no images) with the detail level of RAWDICT:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="s2">&quot;xml&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
<span class="go">    print(line)</span>

<span class="go">&lt;page id=&quot;page0&quot; width=&quot;300&quot; height=&quot;350&quot;&gt;</span>
<span class="go">&lt;block bbox=&quot;50 88.175 166.17098 103.289&quot;&gt;</span>
<span class="go">&lt;line bbox=&quot;50 88.175 166.17098 103.289&quot; wmode=&quot;0&quot; dir=&quot;1 0&quot;&gt;</span>
<span class="go">&lt;font name=&quot;Helvetica&quot; size=&quot;11&quot;&gt;</span>
<span class="go">&lt;char quad=&quot;50 88.175 57.336999 88.175 50 103.289 57.336999 103.289&quot; x=&quot;50&quot;</span>
<span class="go">y=&quot;100&quot; color=&quot;#000000&quot; c=&quot;S&quot;/&gt;</span>
<span class="go">&lt;char quad=&quot;57.337 88.175 63.453004 88.175 57.337 103.289 63.453004 103.289&quot; x=&quot;57.337&quot;</span>
<span class="go">y=&quot;100&quot; color=&quot;#000000&quot; c=&quot;o&quot;/&gt;</span>
<span class="go">&lt;char quad=&quot;63.453004 88.175 72.616008 88.175 63.453004 103.289 72.616008 103.289&quot; x=&quot;63.453004&quot;</span>
<span class="go">y=&quot;100&quot; color=&quot;#000000&quot; c=&quot;m&quot;/&gt;</span>
<span class="go">&lt;char quad=&quot;72.616008 88.175 78.732 88.175 72.616008 103.289 78.732 103.289&quot; x=&quot;72.616008&quot;</span>
<span class="go">y=&quot;100&quot; color=&quot;#000000&quot; c=&quot;e&quot;/&gt;</span>
<span class="go">&lt;char quad=&quot;78.732 88.175 81.79 88.175 78.732 103.289 81.79 103.289&quot; x=&quot;78.732&quot;</span>
<span class="go">y=&quot;100&quot; color=&quot;#000000&quot; c=&quot; &quot;/&gt;</span>

<span class="go">... deleted ...</span>

<span class="go">&lt;char quad=&quot;163.11298 88.175 166.17098 88.175 163.11298 103.289 166.17098 103.289&quot; x=&quot;163.11298&quot;</span>
<span class="go">y=&quot;100&quot; color=&quot;#000000&quot; c=&quot;.&quot;/&gt;</span>
<span class="go">&lt;/font&gt;</span>
<span class="go">&lt;/line&gt;</span>
<span class="go">&lt;/block&gt;</span>
<span class="go">&lt;/page&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We have successfully tested <a class="reference external" href="https://pypi.org/project/lxml/">lxml</a> to interpret this output.</p>
</div>
</section>
<section id="xhtml">
<h2>XHTML<a class="headerlink" href="#xhtml" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="textpage.html#TextPage.extractXHTML" title="TextPage.extractXHTML"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractXHTML()</span></code></a> (or <em>Page.get_text(“xhtml”)</em>) is a variation of TEXT but in HTML format, containing the bare text and images (“semantic” output):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">div</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;page0&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Some</span> <span class="n">text</span> <span class="n">on</span> <span class="n">first</span> <span class="n">page</span><span class="o">.&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="text-extraction-flags-defaults">
<span id="text-extraction-flags"></span><h2>Text Extraction Flags Defaults<a class="headerlink" href="#text-extraction-flags-defaults" title="Link to this heading">¶</a></h2>
<ul>
<li><p>New in version 1.16.2: Method <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> supports a keyword parameter <em>flags</em> <em>(int)</em> to control the amount and the quality of extracted data. The following table shows the defaults settings (flags parameter omitted or None) for each extraction variant. If you specify flags with a value other than <em>None</em>, be aware that you must set <strong>all desired</strong> options. A description of the respective bit settings can be found in <a class="reference internal" href="vars.html#textpreserve"><span class="std std-ref">Font Properties</span></a>.</p></li>
<li><p>New in v1.19.6: The default combinations in the following table are now available as Python constants: <a class="reference internal" href="vars.html#TEXTFLAGS_TEXT" title="TEXTFLAGS_TEXT"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXTFLAGS_TEXT</span></code></a>, <a class="reference internal" href="vars.html#TEXTFLAGS_WORDS" title="TEXTFLAGS_WORDS"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXTFLAGS_WORDS</span></code></a>, <a class="reference internal" href="vars.html#TEXTFLAGS_BLOCKS" title="TEXTFLAGS_BLOCKS"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXTFLAGS_BLOCKS</span></code></a>, <a class="reference internal" href="vars.html#TEXTFLAGS_DICT" title="TEXTFLAGS_DICT"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXTFLAGS_DICT</span></code></a>, <a class="reference internal" href="vars.html#TEXTFLAGS_RAWDICT" title="TEXTFLAGS_RAWDICT"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXTFLAGS_RAWDICT</span></code></a>, <a class="reference internal" href="vars.html#TEXTFLAGS_HTML" title="TEXTFLAGS_HTML"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXTFLAGS_HTML</span></code></a>, <a class="reference internal" href="vars.html#TEXTFLAGS_XHTML" title="TEXTFLAGS_XHTML"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXTFLAGS_XHTML</span></code></a>, <a class="reference internal" href="vars.html#TEXTFLAGS_XML" title="TEXTFLAGS_XML"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXTFLAGS_XML</span></code></a>, and <a class="reference internal" href="vars.html#TEXTFLAGS_SEARCH" title="TEXTFLAGS_SEARCH"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXTFLAGS_SEARCH</span></code></a>. You can now easily modify a default flag, e.g.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>include</strong> images in a “blocks” output:</p></li>
</ul>
<p><code class="xref any docutils literal notranslate"><span class="pre">flags</span> <span class="pre">=</span> <span class="pre">TEXTFLAGS_BLOCKS</span> <span class="pre">|</span> <span class="pre">TEXT_PRESERVE_IMAGES</span></code></p>
<ul class="simple">
<li><p><strong>exclude</strong> images from a “dict” output:</p></li>
</ul>
<p><code class="xref any docutils literal notranslate"><span class="pre">flags</span> <span class="pre">=</span> <span class="pre">TEXTFLAGS_DICT</span> <span class="pre">&amp;</span> <span class="pre">~TEXT_PRESERVE_IMAGES</span></code></p>
<ul class="simple">
<li><p>set <strong>dehyphenation off</strong> in text searches:</p></li>
</ul>
<p><code class="xref any docutils literal notranslate"><span class="pre">flags</span> <span class="pre">=</span> <span class="pre">TEXTFLAGS_SEARCH</span> <span class="pre">&amp;</span> <span class="pre">~TEXT_DEHYPHENATE</span></code></p>
</div></blockquote>
</li>
</ul>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Indicator</p></th>
<th class="head"><p>text</p></th>
<th class="head"><p>html</p></th>
<th class="head"><p>xhtml</p></th>
<th class="head"><p>xml</p></th>
<th class="head"><p>dict</p></th>
<th class="head"><p>rawdict</p></th>
<th class="head"><p>words</p></th>
<th class="head"><p>blocks</p></th>
<th class="head"><p>search</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>preserve ligatures</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>preserve whitespace</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>preserve images</p></td>
<td><p>n/a</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>n/a</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>n/a</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>inhibit spaces</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>dehyphenate</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>clip to mediabox</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>use CID instead of U+FFFD</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p><strong>search</strong> refers to the text search function.</p></li>
<li><p><strong>“json”</strong> is handled exactly like <strong>“dict”</strong> and is hence left out.</p></li>
<li><p><strong>“rawjson”</strong> is handled exactly like <strong>“rawdict”</strong> and is hence left out.</p></li>
<li><p>An “n/a” specification means a value of 0 and setting this bit never has any effect on the output (but an adverse effect on performance).</p></li>
<li><p>If you are not interested in images when using an output variant which includes them by default, then by all means set the respective bit off: You will experience a better performance and much lower space requirements.</p></li>
</ul>
<p>To show the effect of <a class="reference internal" href="vars.html#TEXT_INHIBIT_SPACES" title="TEXT_INHIBIT_SPACES"><code class="xref any py py-data docutils literal notranslate"><span class="pre">TEXT_INHIBIT_SPACES</span></code></a> have a look at this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">))</span>
<span class="go">H a l l o !</span>
<span class="go">Mo r e  t e x t</span>
<span class="go">i s  f o l l o w i n g</span>
<span class="go">i n  E n g l i s h</span>
<span class="go">. . .  l e t &#39; s  s e e</span>
<span class="go">w h a t  h a p p e n s .</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">TEXT_INHIBIT_SPACES</span><span class="p">))</span>
<span class="go">Hallo!</span>
<span class="go">More text</span>
<span class="go">is following</span>
<span class="go">in English</span>
<span class="go">... let&#39;s see</span>
<span class="go">what happens.</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</section>
<section id="performance">
<h2>Performance<a class="headerlink" href="#performance" title="Link to this heading">¶</a></h2>
<p>The text extraction methods differ significantly both: in terms of information they supply, and in terms of resource requirements and runtimes. Generally, more information of course means, that more processing is required and a higher data volume is generated.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Especially images have a <strong>very significant</strong> impact. Make sure to exclude them (via the <em>flags</em> parameter) whenever you do not need them. To process the below mentioned 2’700 total pages with default flags settings required 160 seconds across all extraction methods. When all images where excluded, less than 50% of that time (77 seconds) were needed.</p>
</div>
<p>To begin with, all methods are <strong>very fast</strong> in relation to other products out there in the market. In terms of processing speed, we are not aware of a faster (free) tool. Even the most detailed method, RAWDICT, processes all 1’310 pages of the <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a> in less than 5 seconds (simple text needs less than 2 seconds here).</p>
<p>The following table shows average relative speeds (“RSpeed”, baseline 1.00 is TEXT), taken across ca. 1400 text-heavy and 1300 image-heavy pages.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>RSpeed</p></th>
<th class="head"><p>Comments</p></th>
<th class="head"><p>no images</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TEXT</p></td>
<td><p>1.00</p></td>
<td><p>no images, <strong>plain</strong> text, line breaks</p></td>
<td><p>1.00</p></td>
</tr>
<tr class="row-odd"><td><p>BLOCKS</p></td>
<td><p>1.00</p></td>
<td><p>image bboxes (only), <strong>block</strong> level text with bboxes, line breaks</p></td>
<td><p>1.00</p></td>
</tr>
<tr class="row-even"><td><p>WORDS</p></td>
<td><p>1.02</p></td>
<td><p>no images, <strong>word</strong> level text with bboxes</p></td>
<td><p>1.02</p></td>
</tr>
<tr class="row-odd"><td><p>XML</p></td>
<td><p>2.72</p></td>
<td><p>no images, <strong>char</strong> level text, layout and font details</p></td>
<td><p>2.72</p></td>
</tr>
<tr class="row-even"><td><p>XHTML</p></td>
<td><p>3.32</p></td>
<td><p><strong>base64</strong> images, <strong>span</strong> level text, no layout info</p></td>
<td><p>1.00</p></td>
</tr>
<tr class="row-odd"><td><p>HTML</p></td>
<td><p>3.54</p></td>
<td><p><strong>base64</strong> images, <strong>span</strong> level text, layout and font details</p></td>
<td><p>1.01</p></td>
</tr>
<tr class="row-even"><td><p>DICT</p></td>
<td><p>3.93</p></td>
<td><p><strong>binary</strong> images, <strong>span</strong> level text, layout and font details</p></td>
<td><p>1.04</p></td>
</tr>
<tr class="row-odd"><td><p>RAWDICT</p></td>
<td><p>4.50</p></td>
<td><p><strong>binary</strong> images, <strong>char</strong> level text, layout and font details</p></td>
<td><p>1.68</p></td>
</tr>
</tbody>
</table>
</div>
<p>As mentioned: when excluding image extraction (last column), the relative speeds are changing drastically: except RAWDICT and XML, the other methods are almost equally fast, and RAWDICT requires 40% less execution time than the <strong>now slowest XML</strong>.</p>
<p>Look at chapter <strong>Appendix 1</strong> for more performance information.</p>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>Do you have any feedback on this page?</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.3.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="app2.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Appendix 2: Considerations on Embedded Files</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="colors.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Color Database</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 10. Mar 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Appendix 1: Details on Text Extraction</a><ul>
<li><a class="reference internal" href="#general-structure-of-a-textpage">General structure of a TextPage</a></li>
<li><a class="reference internal" href="#plain-text">Plain Text</a></li>
<li><a class="reference internal" href="#blocks">BLOCKS</a></li>
<li><a class="reference internal" href="#words">WORDS</a></li>
<li><a class="reference internal" href="#html">HTML</a></li>
<li><a class="reference internal" href="#controlling-quality-of-html-output">Controlling Quality of HTML Output</a></li>
<li><a class="reference internal" href="#dict-or-json">DICT (or JSON)</a></li>
<li><a class="reference internal" href="#rawdict-or-rawjson">RAWDICT (or RAWJSON)</a></li>
<li><a class="reference internal" href="#xml">XML</a></li>
<li><a class="reference internal" href="#xhtml">XHTML</a></li>
<li><a class="reference internal" href="#text-extraction-flags-defaults">Text Extraction Flags Defaults</a></li>
<li><a class="reference internal" href="#performance">Performance</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=9ddcf537"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    </body>
</html>