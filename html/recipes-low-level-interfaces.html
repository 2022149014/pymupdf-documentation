<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF is a high-performance Python library for data extraction, analysis, conversion &amp; manipulation of PDF (and other) documents." name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="About these documents" href="about.html" /><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Common Issues and their Solutions" href="recipes-common-issues-and-their-solutions.html" /><link rel="prev" title="Optional Content Support" href="recipes-optional-content.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Low-Level Interfaces - PyMuPDF 1.25.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=74643500" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.3 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.3 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">Features Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#performance">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#license-and-copyright">License and Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">The Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF, LLM &amp; RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">Opening Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">Drawing and Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">Stories</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">Journalling</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">Multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - Optical Character Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">Optional Content Support</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Low-Level Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">Common Issues and their Solutions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module.html">Command line interface</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="classes.html">Classes</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">Operator Algebra for Geometry Objects</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">Low Level Functions and Classes</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Low Level Functions and Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">Working together: DisplayList and TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">Constants and Enumerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">Color Database</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app1.html">Appendix 1: Details on Text Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">Appendix 2: Considerations on Embedded Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">Appendix 3: Assorted Technical Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">Appendix 4: Performance Comparison Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">Deprecated Names</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/recipes-low-level-interfaces.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <style>

    #languageToggle {
        width:25%;
        margin:8px 10px 0;
    }

    #button-select-en {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 10px 0 0 10px;
        font-size: 14px;
    }

    #button-select-ja {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 0px 10px 10px 0;
        border-left: 0;
        font-size: 14px;
    }

    #button-select-en , #button-select-ja, #button-select-en:hover , #button-select-ja:hover  {
        color: #fff;
        text-decoration: none;
    }

    /* small screens */
    @media all and (max-width : 768px)  {
        #languageToggle {
            width:50%;
        }
    }

    @media all and (max-width : 400px)  {
        #languageToggle {
            width:70%;
        }
    }

    @media all and (max-width : 375px)  {
        #button-select-en , #button-select-ja {
            font-size: 11px;
        }
    }

</style>

<div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
    <div id="languageToggle"><span><a id="button-select-en" href="javaScript:changeLanguage('en')">English</a></span><span><a id="button-select-ja" href="javaScript:changeLanguage('ja')">日本語</a></span></div>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

    <div class="feedbackLink"><a id="feedbackLinkTop" target=_blank>Do you have any feedback on this page?</b></a></div>
</div>

<script>
    // highlightSelectedLanguage

    if (document.getElementsByTagName('html')[0].getAttribute('lang')=="ja") {
        document.getElementById("button-select-ja").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-en").style.color = "#000";
    } else {
        document.getElementById("button-select-en").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-ja").style.color = "#000";
    }


    var url_string = window.location.href;
    var a = document.getElementById('feedbackLinkTop');
    a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=header-link&url="+url_string);

    function changeLanguage(lang) {
        var new_url;

        if (lang == "en") {
            new_url = url_string.replace("/ja/", "/en/");
        } else {
            new_url = url_string.replace("/en/", "/ja/");
        }

        window.location.replace(new_url);
    }

</script><section id="low-level-interfaces">
<span id="recipeslowlevelinterfaces"></span><h1>Low-Level Interfaces<a class="headerlink" href="#low-level-interfaces" title="Link to this heading">¶</a></h1>
<p>Numerous methods are available to access and manipulate PDF files on a fairly low level. Admittedly, a clear distinction between “low level” and “normal” functionality is not always possible or subject to personal taste.</p>
<p>It also may happen, that functionality previously deemed low-level is later on assessed as being part of the normal interface. This has happened in v1.14.0 for the class <a class="reference internal" href="tools.html#tools"><span class="std std-ref">Tools</span></a> - you now find it as an item in the Classes chapter.</p>
<p>It is a matter of documentation only in which chapter of the documentation you find what you are looking for. Everything is available and always via the same interface.</p>
<hr class="docutils" />
<section id="how-to-iterate-through-the-xref-table">
<h2>How to Iterate through the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> Table<a class="headerlink" href="#how-to-iterate-through-the-xref-table" title="Link to this heading">¶</a></h2>
<p>A PDF’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> table is a list of all objects defined in the file. This table may easily contain many thousands of entries – the manual <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a> for example has 127,000 objects. Table entry “0” is reserved and must not be touched.
The following script loops through the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> table and prints each object’s definition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xreflen</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_length</span><span class="p">()</span>  <span class="c1"># length of objects table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">xreflen</span><span class="p">):</span>  <span class="c1"># skip item 0!</span>
<span class="go">        print(&quot;&quot;)</span>
<span class="go">        print(&quot;object %i (stream: %s)&quot; % (xref, doc.xref_is_stream(xref)))</span>
<span class="go">        print(doc.xref_object(xref, compressed=False))</span>
</pre></div>
</div>
<p>This produces the following output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>object 1 (stream: False)
&lt;&lt;
    /ModDate (D:20170314122233-04&#39;00&#39;)
    /PXCViewerInfo (PDF-XChange Viewer;2.5.312.1;Feb  9 2015;12:00:06;D:20170314122233-04&#39;00&#39;)
&gt;&gt;

object 2 (stream: False)
&lt;&lt;
    /Type /Catalog
    /Pages 3 0 R
&gt;&gt;

object 3 (stream: False)
&lt;&lt;
    /Kids [ 4 0 R 5 0 R ]
    /Type /Pages
    /Count 2
&gt;&gt;

object 4 (stream: False)
&lt;&lt;
    /Type /Page
    /Annots [ 6 0 R ]
    /Parent 3 0 R
    /Contents 7 0 R
    /MediaBox [ 0 0 595 842 ]
    /Resources 8 0 R
&gt;&gt;
...
object 7 (stream: True)
&lt;&lt;
    /Length 494
    /Filter /FlateDecode
&gt;&gt;
...
</pre></div>
</div>
<p>A PDF object definition is an ordinary ASCII string.</p>
</section>
<hr class="docutils" />
<section id="how-to-handle-object-streams">
<h2>How to Handle Object Streams<a class="headerlink" href="#how-to-handle-object-streams" title="Link to this heading">¶</a></h2>
<p>Some object types contain additional data apart from their object definition. Examples are images, fonts, embedded files or commands describing the appearance of a page.</p>
<p>Objects of these types are called “stream objects”. PyMuPDF allows reading an object’s stream via method <a class="reference internal" href="document.html#Document.xref_stream" title="Document.xref_stream"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_stream()</span></code></a> with the object’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> as an argument. It is also possible to write back a modified version of a stream using <a class="reference internal" href="document.html#Document.update_stream" title="Document.update_stream"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.update_stream()</span></code></a>.</p>
<p>Assume that the following snippet wants to read all streams of a PDF for whatever reason:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xreflen</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_length</span><span class="p">()</span> <span class="c1"># number of objects in file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">xreflen</span><span class="p">):</span> <span class="c1"># skip item 0!</span>
<span class="go">        if stream := doc.xref_stream(xref):</span>
<span class="go">            # do something with it (it is a bytes object or None)</span>
<span class="go">            # e.g. just write it back:</span>
<span class="go">            doc.update_stream(xref, stream)</span>
</pre></div>
</div>
<p><a class="reference internal" href="document.html#Document.xref_stream" title="Document.xref_stream"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_stream()</span></code></a> automatically returns a stream decompressed as a bytes object – and <a class="reference internal" href="document.html#Document.update_stream" title="Document.update_stream"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.update_stream()</span></code></a> automatically compresses it if beneficial.</p>
</section>
<hr class="docutils" />
<section id="how-to-handle-page-contents">
<h2>How to Handle Page Contents<a class="headerlink" href="#how-to-handle-page-contents" title="Link to this heading">¶</a></h2>
<p>A PDF page can have zero or multiple <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> objects. These are stream objects describing <strong>what</strong> appears <strong>where</strong> and <strong>how</strong> on a page (like text and images). They are written in a special mini-language described e.g. in chapter “APPENDIX A - Operator Summary” on page 643 of the <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>.</p>
<p>Every PDF reader application must be able to interpret the contents syntax to reproduce the intended appearance of the page.</p>
<p>If multiple <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> objects are provided, they must be interpreted in the specified sequence in exactly the same way as if they were provided as a concatenation of the several.</p>
<p>There are good technical arguments for having multiple <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> objects:</p>
<ul class="simple">
<li><p>It is a lot easier and faster to just add new <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> objects than maintaining a single big one (which entails reading, decompressing, modifying, recompressing, and rewriting it for each change).</p></li>
<li><p>When working with incremental updates, a modified big <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> object will bloat the update delta and can thus easily negate the efficiency of incremental saves.</p></li>
</ul>
<p>For example, PyMuPDF adds new, small <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> objects in methods <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a>, <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> and the <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> methods.</p>
<p>However, there are also situations when a <strong>single</strong> <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> object is beneficial: it is easier to interpret and more compressible than multiple smaller ones.</p>
<p>Here are two ways of combining multiple contents of a page:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># method 1: use the MuPDF clean function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">clean_contents</span><span class="p">()</span>  <span class="c1"># cleans and combines multiple Contents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xref</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_contents</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># only one /Contents now!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cont</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_stream</span><span class="p">(</span><span class="n">xref</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># this has also reformatted the PDF commands</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># method 2: extract concatenated contents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cont</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">read_contents</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the /Contents source itself is unmodified</span>
</pre></div>
</div>
<p>The clean function <a class="reference internal" href="functions.html#Page.clean_contents" title="Page.clean_contents"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.clean_contents()</span></code></a> does a lot more than just glueing <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> objects: it also corrects and optimizes the PDF operator syntax of the page and removes any inconsistencies with the page’s object definition.</p>
</section>
<hr class="docutils" />
<section id="how-to-access-the-pdf-catalog">
<h2>How to Access the PDF Catalog<a class="headerlink" href="#how-to-access-the-pdf-catalog" title="Link to this heading">¶</a></h2>
<p>This is a central (“root”) object of a PDF. It serves as a starting point to reach important other objects and it also contains some global options for the PDF:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">=</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;PyMuPDF.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cat</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">pdf_catalog</span><span class="p">()</span>  <span class="c1"># get xref of the /Catalog</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_object</span><span class="p">(</span><span class="n">cat</span><span class="p">))</span>  <span class="c1"># print object definition</span>
<span class="go">&lt;&lt;</span>
<span class="go">    /Type/Catalog                 % object type</span>
<span class="go">    /Pages 3593 0 R               % points to page tree</span>
<span class="go">    /OpenAction 225 0 R           % action to perform on open</span>
<span class="go">    /Names 3832 0 R               % points to global names tree</span>
<span class="go">    /PageMode /UseOutlines        % initially show the TOC</span>
<span class="go">    /PageLabels&lt;&lt;/Nums[0&lt;&lt;/S/D&gt;&gt;2&lt;&lt;/S/r&gt;&gt;8&lt;&lt;/S/D&gt;&gt;]&gt;&gt; % labels given to pages</span>
<span class="go">    /Outlines 3835 0 R            % points to outline tree</span>
<span class="go">&gt;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Indentation, line breaks and comments are inserted here for clarification purposes only and will not normally appear. For more information on the PDF catalog see section 7.7.2 on page 71 of the <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>.</p>
</div>
</section>
<hr class="docutils" />
<section id="how-to-access-the-pdf-file-trailer">
<h2>How to Access the PDF File Trailer<a class="headerlink" href="#how-to-access-the-pdf-file-trailer" title="Link to this heading">¶</a></h2>
<p>The trailer of a PDF file is a <a class="reference internal" href="glossary.html#dictionary" title="dictionary"><code class="xref py py-data docutils literal notranslate"><span class="pre">dictionary</span></code></a> located towards the end of the file. It contains special objects, and pointers to important other information. See <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a> p. 42. Here is an overview:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Key</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Value</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Size</p></td>
<td><p>int</p></td>
<td><p>Number of entries in the cross-reference table + 1.</p></td>
</tr>
<tr class="row-odd"><td><p>Prev</p></td>
<td><p>int</p></td>
<td><p>Offset to previous <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> section (indicates incremental updates).</p></td>
</tr>
<tr class="row-even"><td><p>Root</p></td>
<td><p>dictionary</p></td>
<td><p>(indirect) Pointer to the catalog. See previous section.</p></td>
</tr>
<tr class="row-odd"><td><p>Encrypt</p></td>
<td><p>dictionary</p></td>
<td><p>Pointer to encryption object (encrypted files only).</p></td>
</tr>
<tr class="row-even"><td><p>Info</p></td>
<td><p>dictionary</p></td>
<td><p>(indirect) Pointer to information (metadata).</p></td>
</tr>
<tr class="row-odd"><td><p>ID</p></td>
<td><p>array</p></td>
<td><p>File identifier consisting of two byte strings.</p></td>
</tr>
<tr class="row-even"><td><p>XRefStm</p></td>
<td><p>int</p></td>
<td><p>Offset of a cross-reference stream. See <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a> p. 49.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Access this information via PyMuPDF with <a class="reference internal" href="document.html#Document.pdf_trailer" title="Document.pdf_trailer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pdf_trailer()</span></code></a> or, equivalently, via <a class="reference internal" href="document.html#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a> using -1 instead of a valid <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">=</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;PyMuPDF.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_object</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># or: print(doc.pdf_trailer())</span>
<span class="go">&lt;&lt;</span>
<span class="go">/Type /XRef</span>
<span class="go">/Index [ 0 8263 ]</span>
<span class="go">/Size 8263</span>
<span class="go">/W [ 1 3 1 ]</span>
<span class="go">/Root 8260 0 R</span>
<span class="go">/Info 8261 0 R</span>
<span class="go">/ID [ &lt;4339B9CEE46C2CD28A79EBDDD67CC9B3&gt; &lt;4339B9CEE46C2CD28A79EBDDD67CC9B3&gt; ]</span>
<span class="go">/Length 19883</span>
<span class="go">/Filter /FlateDecode</span>
<span class="go">&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="how-to-access-xml-metadata">
<h2>How to Access XML Metadata<a class="headerlink" href="#how-to-access-xml-metadata" title="Link to this heading">¶</a></h2>
<p>A PDF may contain XML metadata in addition to the standard metadata format. In fact, most PDF viewer or modification software adds this type of information when saving the PDF (Adobe, Nitro PDF, PDF-XChange, etc.).</p>
<p>PyMuPDF has no way to <strong>interpret or change</strong> this information directly, because it contains no XML features. XML metadata is however stored as a <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a> object, so it can be read, modified with appropriate software and written back.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xmlmetadata</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_xml_metadata</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">xmlmetadata</span><span class="p">)</span>
<span class="go">&lt;?xpacket begin=&quot;\ufeff&quot; id=&quot;W5M0MpCehiHzreSzNTczkc9d&quot;?&gt;</span>
<span class="go">&lt;x:xmpmeta xmlns:x=&quot;adobe:ns:meta/&quot; x:xmptk=&quot;3.1-702&quot;&gt;</span>
<span class="go">&lt;rdf:RDF xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;&gt;</span>
<span class="go">...</span>
<span class="go">omitted data</span>
<span class="go">...</span>
<span class="go">&lt;?xpacket end=&quot;w&quot;?&gt;</span>
</pre></div>
</div>
<p>Using some XML package, the XML data can be interpreted and / or modified and then stored back. The following also works, if the PDF previously had no XML metadata:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># write back modified XML metadata:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_xml_metadata</span><span class="p">(</span><span class="n">xmlmetadata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># XML metadata can be deleted like this:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">del_xml_metadata</span><span class="p">()</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="how-to-extend-pdf-metadata">
<h2>How to Extend PDF Metadata<a class="headerlink" href="#how-to-extend-pdf-metadata" title="Link to this heading">¶</a></h2>
<p>Attribute <a class="reference internal" href="document.html#Document.metadata" title="Document.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.metadata</span></code></a> is designed so it works for all <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">supported document types</span></a> in the same way: it is a Python dictionary with a <strong>fixed set of key-value pairs</strong>. Correspondingly, <a class="reference internal" href="document.html#Document.set_metadata" title="Document.set_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_metadata()</span></code></a> only accepts standard keys.</p>
<p>However, PDFs may contain items not accessible like this. Also, there may be reasons to store additional information, like copyrights. Here is a way to handle <strong>arbitrary metadata items</strong> by using PyMuPDF low-level functions.</p>
<p>As an example, look at this standard metadata output of some PDF:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---------------------</span>
<span class="c1"># standard metadata</span>
<span class="c1"># ---------------------</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;PRINCE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;creationDate&#39;</span><span class="p">:</span> <span class="s2">&quot;D:2010102417034406&#39;-30&#39;&quot;</span><span class="p">,</span>
 <span class="s1">&#39;creator&#39;</span><span class="p">:</span> <span class="s1">&#39;PrimoPDF http://www.primopdf.com/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;encryption&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;PDF 1.4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
 <span class="s1">&#39;modDate&#39;</span><span class="p">:</span> <span class="s2">&quot;D:20200725062431-04&#39;00&#39;&quot;</span><span class="p">,</span>
 <span class="s1">&#39;producer&#39;</span><span class="p">:</span> <span class="s1">&#39;macOS Version 10.15.6 (Build 19G71a) Quartz PDFContext, &#39;</span>
             <span class="s1">&#39;AppendMode 1.1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;subject&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
 <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Full page fax print&#39;</span><span class="p">,</span>
 <span class="s1">&#39;trapped&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>Use the following code to see <strong>all items</strong> stored in the metadata object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ----------------------------------</span>
<span class="c1"># metadata including private items</span>
<span class="c1"># ----------------------------------</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># make my own metadata dict</span>
<span class="n">what</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_key</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Info&quot;</span><span class="p">)</span>  <span class="c1"># /Info key in the trailer</span>
<span class="k">if</span> <span class="n">what</span> <span class="o">!=</span> <span class="s2">&quot;xref&quot;</span><span class="p">:</span>
    <span class="k">pass</span>  <span class="c1"># PDF has no metadata</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">xref</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;0 R&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>  <span class="c1"># extract the metadata xref</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="n">xref</span><span class="p">):</span>
        <span class="n">metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_key</span><span class="p">(</span><span class="n">xref</span><span class="p">,</span> <span class="n">key</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;Author&#39;</span><span class="p">:</span> <span class="s1">&#39;PRINCE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CreationDate&#39;</span><span class="p">:</span> <span class="s2">&quot;D:2010102417034406&#39;-30&#39;&quot;</span><span class="p">,</span>
 <span class="s1">&#39;Creator&#39;</span><span class="p">:</span> <span class="s1">&#39;PrimoPDF http://www.primopdf.com/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ModDate&#39;</span><span class="p">:</span> <span class="s2">&quot;D:20200725062431-04&#39;00&#39;&quot;</span><span class="p">,</span>
 <span class="s1">&#39;PXCViewerInfo&#39;</span><span class="p">:</span> <span class="s1">&#39;PDF-XChange Viewer;2.5.312.1;Feb  9 &#39;</span>
                 <span class="s2">&quot;2015;12:00:06;D:20200725062431-04&#39;00&#39;&quot;</span><span class="p">,</span>
 <span class="s1">&#39;Producer&#39;</span><span class="p">:</span> <span class="s1">&#39;macOS Version 10.15.6 (Build 19G71a) Quartz PDFContext, &#39;</span>
             <span class="s1">&#39;AppendMode 1.1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Title&#39;</span><span class="p">:</span> <span class="s1">&#39;Full page fax print&#39;</span><span class="p">}</span>
<span class="c1"># ---------------------------------------------------------------</span>
<span class="c1"># note the additional &#39;PXCViewerInfo&#39; key - ignored in standard!</span>
<span class="c1"># ---------------------------------------------------------------</span>
</pre></div>
</div>
<p><em>Vice versa</em>, you can also <strong>store private metadata items</strong> in a PDF. It is your responsibility to make sure that these items conform to PDF specifications - especially they must be (unicode) strings. Consult section 14.3 (p. 548) of the <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a> for details and caveats:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">what</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_key</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Info&quot;</span><span class="p">)</span>  <span class="c1"># /Info key in the trailer</span>
<span class="k">if</span> <span class="n">what</span> <span class="o">!=</span> <span class="s2">&quot;xref&quot;</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PDF has no metadata&quot;</span><span class="p">)</span>
<span class="n">xref</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;0 R&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>  <span class="c1"># extract the metadata xref</span>
<span class="c1"># add some private information</span>
<span class="n">doc</span><span class="o">.</span><span class="n">xref_set_key</span><span class="p">(</span><span class="n">xref</span><span class="p">,</span> <span class="s2">&quot;mykey&quot;</span><span class="p">,</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">get_pdf_str</span><span class="p">(</span><span class="s2">&quot;北京 is Beijing&quot;</span><span class="p">))</span>
<span class="c1">#</span>
<span class="c1"># after executing the previous code snippet, we will see this:</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;Author&#39;</span><span class="p">:</span> <span class="s1">&#39;PRINCE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CreationDate&#39;</span><span class="p">:</span> <span class="s2">&quot;D:2010102417034406&#39;-30&#39;&quot;</span><span class="p">,</span>
 <span class="s1">&#39;Creator&#39;</span><span class="p">:</span> <span class="s1">&#39;PrimoPDF http://www.primopdf.com/&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ModDate&#39;</span><span class="p">:</span> <span class="s2">&quot;D:20200725062431-04&#39;00&#39;&quot;</span><span class="p">,</span>
 <span class="s1">&#39;PXCViewerInfo&#39;</span><span class="p">:</span> <span class="s1">&#39;PDF-XChange Viewer;2.5.312.1;Feb  9 &#39;</span>
                  <span class="s2">&quot;2015;12:00:06;D:20200725062431-04&#39;00&#39;&quot;</span><span class="p">,</span>
 <span class="s1">&#39;Producer&#39;</span><span class="p">:</span> <span class="s1">&#39;macOS Version 10.15.6 (Build 19G71a) Quartz PDFContext, &#39;</span>
             <span class="s1">&#39;AppendMode 1.1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Title&#39;</span><span class="p">:</span> <span class="s1">&#39;Full page fax print&#39;</span><span class="p">,</span>
 <span class="s1">&#39;mykey&#39;</span><span class="p">:</span> <span class="s1">&#39;北京 is Beijing&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>To delete selected keys, use <code class="xref any docutils literal notranslate"><span class="pre">doc.xref_set_key(xref,</span> <span class="pre">&quot;mykey&quot;,</span> <span class="pre">&quot;null&quot;)</span></code>. As explained in the next section, string “null” is the PDF equivalent to Python’s <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>. A key with that value will be treated as not being specified – and physically removed in garbage collections.</p>
</section>
<hr class="docutils" />
<section id="how-to-read-and-update-pdf-objects">
<h2>How to Read and Update PDF Objects<a class="headerlink" href="#how-to-read-and-update-pdf-objects" title="Link to this heading">¶</a></h2>
<p>There also exist granular, elegant ways to access and manipulate selected PDF <a class="reference internal" href="glossary.html#dictionary" title="dictionary"><code class="xref py py-data docutils literal notranslate"><span class="pre">dictionary</span></code></a> keys.</p>
<ul>
<li><p><a class="reference internal" href="document.html#Document.xref_get_keys" title="Document.xref_get_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_keys()</span></code></a> returns the PDF keys of the object at <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pymupdf.pdf&quot;</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">xref</span><span class="p">))</span>
<span class="p">(</span><span class="s1">&#39;Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Contents&#39;</span><span class="p">,</span> <span class="s1">&#39;Resources&#39;</span><span class="p">,</span> <span class="s1">&#39;MediaBox&#39;</span><span class="p">,</span> <span class="s1">&#39;Parent&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Compare with the full object definition:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_object</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">xref</span><span class="p">))</span>
<span class="o">&lt;&lt;</span>
  <span class="o">/</span><span class="n">Type</span> <span class="o">/</span><span class="n">Page</span>
  <span class="o">/</span><span class="n">Contents</span> <span class="mi">1297</span> <span class="mi">0</span> <span class="n">R</span>
  <span class="o">/</span><span class="n">Resources</span> <span class="mi">1296</span> <span class="mi">0</span> <span class="n">R</span>
  <span class="o">/</span><span class="n">MediaBox</span> <span class="p">[</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">612</span> <span class="mi">792</span> <span class="p">]</span>
  <span class="o">/</span><span class="n">Parent</span> <span class="mi">1301</span> <span class="mi">0</span> <span class="n">R</span>
<span class="o">&gt;&gt;</span>
</pre></div>
</div>
</li>
<li><p>Single keys can also be accessed directly via <a class="reference internal" href="document.html#Document.xref_get_key" title="Document.xref_get_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_key()</span></code></a>. The value <strong>always is a string</strong> together with type information, that helps with interpreting it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_key</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">xref</span><span class="p">,</span> <span class="s2">&quot;MediaBox&quot;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;[0 0 612 792]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Here is a full listing of the above page keys:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">xref</span><span class="p">):</span>
<span class="o">...</span><span class="p">:</span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_key</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">xref</span><span class="p">,</span> <span class="n">key</span><span class="p">)))</span>
<span class="o">...</span><span class="p">:</span>
<span class="n">Type</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;/Page&#39;</span><span class="p">)</span>
<span class="n">Contents</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;xref&#39;</span><span class="p">,</span> <span class="s1">&#39;1297 0 R&#39;</span><span class="p">)</span>
<span class="n">Resources</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;xref&#39;</span><span class="p">,</span> <span class="s1">&#39;1296 0 R&#39;</span><span class="p">)</span>
<span class="n">MediaBox</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;[0 0 612 792]&#39;</span><span class="p">)</span>
<span class="n">Parent</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;xref&#39;</span><span class="p">,</span> <span class="s1">&#39;1301 0 R&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>An undefined key inquiry returns <code class="xref any docutils literal notranslate"><span class="pre">('null',</span> <span class="pre">'null')</span></code> – PDF object type <code class="xref any docutils literal notranslate"><span class="pre">null</span></code> corresponds to <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> in Python. Similar for the booleans <code class="xref any docutils literal notranslate"><span class="pre">true</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p>Let us add a new key to the page definition that sets its rotation to 90 degrees (you are aware that there actually exists <a class="reference internal" href="page.html#Page.set_rotation" title="Page.set_rotation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_rotation()</span></code></a> for this?):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_key</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">xref</span><span class="p">,</span> <span class="s2">&quot;Rotate&quot;</span><span class="p">)</span>  <span class="c1"># no rotation set:</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;null&#39;</span><span class="p">,</span> <span class="s1">&#39;null&#39;</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_set_key</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">xref</span><span class="p">,</span> <span class="s2">&quot;Rotate&quot;</span><span class="p">,</span> <span class="s2">&quot;90&quot;</span><span class="p">)</span>  <span class="c1"># insert a new key</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_object</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">xref</span><span class="p">))</span>  <span class="c1"># confirm success</span>
<span class="o">&lt;&lt;</span>
  <span class="o">/</span><span class="n">Type</span> <span class="o">/</span><span class="n">Page</span>
  <span class="o">/</span><span class="n">Contents</span> <span class="mi">1297</span> <span class="mi">0</span> <span class="n">R</span>
  <span class="o">/</span><span class="n">Resources</span> <span class="mi">1296</span> <span class="mi">0</span> <span class="n">R</span>
  <span class="o">/</span><span class="n">MediaBox</span> <span class="p">[</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">612</span> <span class="mi">792</span> <span class="p">]</span>
  <span class="o">/</span><span class="n">Parent</span> <span class="mi">1301</span> <span class="mi">0</span> <span class="n">R</span>
  <span class="o">/</span><span class="n">Rotate</span> <span class="mi">90</span>
<span class="o">&gt;&gt;</span>
</pre></div>
</div>
</li>
<li><p>This method can also be used to remove a key from the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> dictionary by setting its value to <code class="xref any docutils literal notranslate"><span class="pre">null</span></code>: The following will remove the rotation specification from the page: <code class="xref any docutils literal notranslate"><span class="pre">doc.xref_set_key(page.xref,</span> <span class="pre">&quot;Rotate&quot;,</span> <span class="pre">&quot;null&quot;)</span></code>. Similarly, to remove all links, annotations and fields from a page, use <code class="xref any docutils literal notranslate"><span class="pre">doc.xref_set_key(page.xref,</span> <span class="pre">&quot;Annots&quot;,</span> <span class="pre">&quot;null&quot;)</span></code>. Because <code class="xref any docutils literal notranslate"><span class="pre">Annots</span></code> by definition is an array, setting en empty array with the statement <code class="xref any docutils literal notranslate"><span class="pre">doc.xref_set_key(page.xref,</span> <span class="pre">&quot;Annots&quot;,</span> <span class="pre">&quot;[]&quot;)</span></code> would do the same job in this case.</p></li>
<li><p>PDF dictionaries can be hierarchically nested. In the following page object definition both, <a class="reference internal" href="font.html#font"><span class="std std-ref">Font</span></a> and <code class="xref any docutils literal notranslate"><span class="pre">XObject</span></code> are subdictionaries of <code class="xref any docutils literal notranslate"><span class="pre">Resources</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_object</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">xref</span><span class="p">))</span>
<span class="o">&lt;&lt;</span>
  <span class="o">/</span><span class="n">Type</span> <span class="o">/</span><span class="n">Page</span>
  <span class="o">/</span><span class="n">Contents</span> <span class="mi">1297</span> <span class="mi">0</span> <span class="n">R</span>
  <span class="o">/</span><span class="n">Resources</span> <span class="o">&lt;&lt;</span>
    <span class="o">/</span><span class="n">XObject</span> <span class="o">&lt;&lt;</span>
      <span class="o">/</span><span class="n">Im1</span> <span class="mi">1291</span> <span class="mi">0</span> <span class="n">R</span>
    <span class="o">&gt;&gt;</span>
    <span class="o">/</span><span class="n">Font</span> <span class="o">&lt;&lt;</span>
      <span class="o">/</span><span class="n">F39</span> <span class="mi">1299</span> <span class="mi">0</span> <span class="n">R</span>
      <span class="o">/</span><span class="n">F40</span> <span class="mi">1300</span> <span class="mi">0</span> <span class="n">R</span>
    <span class="o">&gt;&gt;</span>
  <span class="o">&gt;&gt;</span>
  <span class="o">/</span><span class="n">MediaBox</span> <span class="p">[</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">612</span> <span class="mi">792</span> <span class="p">]</span>
  <span class="o">/</span><span class="n">Parent</span> <span class="mi">1301</span> <span class="mi">0</span> <span class="n">R</span>
  <span class="o">/</span><span class="n">Rotate</span> <span class="mi">90</span>
<span class="o">&gt;&gt;</span>
</pre></div>
</div>
</li>
<li><p>The above situation <strong>is supported</strong> by methods <a class="reference internal" href="document.html#Document.xref_set_key" title="Document.xref_set_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_set_key()</span></code></a> and <a class="reference internal" href="document.html#Document.xref_get_key" title="Document.xref_get_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_key()</span></code></a>: use a path-like notation to point at the required key. For example, to retrieve the value of key <code class="xref any docutils literal notranslate"><span class="pre">Im1</span></code> above, specify the complete chain of dictionaries “above” it in the key argument: <code class="xref any docutils literal notranslate"><span class="pre">&quot;Resources/XObject/Im1&quot;</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_key</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">xref</span><span class="p">,</span> <span class="s2">&quot;Resources/XObject/Im1&quot;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;xref&#39;</span><span class="p">,</span> <span class="s1">&#39;1291 0 R&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>The path notation can also be used to <strong>directly set a value</strong>: use the following to let <code class="xref any docutils literal notranslate"><span class="pre">Im1</span></code> point to a different object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_set_key</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">xref</span><span class="p">,</span> <span class="s2">&quot;Resources/XObject/Im1&quot;</span><span class="p">,</span> <span class="s2">&quot;9999 0 R&quot;</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_object</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">xref</span><span class="p">))</span>  <span class="c1"># confirm success:</span>
<span class="o">&lt;&lt;</span>
  <span class="o">/</span><span class="n">Type</span> <span class="o">/</span><span class="n">Page</span>
  <span class="o">/</span><span class="n">Contents</span> <span class="mi">1297</span> <span class="mi">0</span> <span class="n">R</span>
  <span class="o">/</span><span class="n">Resources</span> <span class="o">&lt;&lt;</span>
    <span class="o">/</span><span class="n">XObject</span> <span class="o">&lt;&lt;</span>
      <span class="o">/</span><span class="n">Im1</span> <span class="mi">9999</span> <span class="mi">0</span> <span class="n">R</span>
    <span class="o">&gt;&gt;</span>
    <span class="o">/</span><span class="n">Font</span> <span class="o">&lt;&lt;</span>
      <span class="o">/</span><span class="n">F39</span> <span class="mi">1299</span> <span class="mi">0</span> <span class="n">R</span>
      <span class="o">/</span><span class="n">F40</span> <span class="mi">1300</span> <span class="mi">0</span> <span class="n">R</span>
    <span class="o">&gt;&gt;</span>
  <span class="o">&gt;&gt;</span>
  <span class="o">/</span><span class="n">MediaBox</span> <span class="p">[</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">612</span> <span class="mi">792</span> <span class="p">]</span>
  <span class="o">/</span><span class="n">Parent</span> <span class="mi">1301</span> <span class="mi">0</span> <span class="n">R</span>
  <span class="o">/</span><span class="n">Rotate</span> <span class="mi">90</span>
<span class="o">&gt;&gt;</span>
</pre></div>
</div>
<p>Be aware, that <strong>no semantic checks</strong> whatsoever will take place here: if the PDF has no xref 9999, it won’t be detected at this point.</p>
</li>
<li><p>If a key does not exist, it will be created by setting its value. Moreover, if any intermediate keys do not exist either, they will also be created as necessary. The following creates an array <code class="xref any docutils literal notranslate"><span class="pre">D</span></code> several levels below the existing dictionary <code class="xref any docutils literal notranslate"><span class="pre">A</span></code>. Intermediate dictionaries <code class="xref any docutils literal notranslate"><span class="pre">B</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">C</span></code> are automatically created:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_object</span><span class="p">(</span><span class="n">xref</span><span class="p">))</span>  <span class="c1"># some existing PDF object:</span>
<span class="o">&lt;&lt;</span>
  <span class="o">/</span><span class="n">A</span> <span class="o">&lt;&lt;</span>
  <span class="o">&gt;&gt;</span>
<span class="o">&gt;&gt;</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="c1"># the following will create &#39;B&#39;, &#39;C&#39; and &#39;D&#39;</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_set_key</span><span class="p">(</span><span class="n">xref</span><span class="p">,</span> <span class="s2">&quot;A/B/C/D&quot;</span><span class="p">,</span> <span class="s2">&quot;[1 2 3 4]&quot;</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_object</span><span class="p">(</span><span class="n">xref</span><span class="p">))</span>  <span class="c1"># check out what happened:</span>
<span class="o">&lt;&lt;</span>
  <span class="o">/</span><span class="n">A</span> <span class="o">&lt;&lt;</span>
    <span class="o">/</span><span class="n">B</span> <span class="o">&lt;&lt;</span>
      <span class="o">/</span><span class="n">C</span> <span class="o">&lt;&lt;</span>
        <span class="o">/</span><span class="n">D</span> <span class="p">[</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="p">]</span>
      <span class="o">&gt;&gt;</span>
    <span class="o">&gt;&gt;</span>
  <span class="o">&gt;&gt;</span>
<span class="o">&gt;&gt;</span>
</pre></div>
</div>
</li>
<li><p>When setting key values, basic <strong>PDF syntax checking</strong> will be done by MuPDF. For example, new keys can only be created <strong>below a dictionary</strong>. The following tries to create some new string item <code class="xref any docutils literal notranslate"><span class="pre">E</span></code> below the previously created array <code class="xref any docutils literal notranslate"><span class="pre">D</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="c1"># &#39;D&#39; is an array, no dictionary!</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_set_key</span><span class="p">(</span><span class="n">xref</span><span class="p">,</span> <span class="s2">&quot;A/B/C/D/E&quot;</span><span class="p">,</span> <span class="s2">&quot;(hello)&quot;</span><span class="p">)</span>
<span class="n">mupdf</span><span class="p">:</span> <span class="ow">not</span> <span class="n">a</span> <span class="nb">dict</span> <span class="p">(</span><span class="n">array</span><span class="p">)</span>
<span class="o">---</span> <span class="o">...</span> <span class="o">---</span>
<span class="ne">RuntimeError</span><span class="p">:</span> <span class="ow">not</span> <span class="n">a</span> <span class="nb">dict</span> <span class="p">(</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>It is also <strong>not possible</strong>, to create a key if some higher level key is an <strong>“indirect”</strong> object, i.e. an xref. In other words, xrefs can only be modified directly and not implicitly via other objects referencing them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="c1"># the following object points to an xref</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_object</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="o">&lt;&lt;</span>
  <span class="o">/</span><span class="n">E</span> <span class="mi">3</span> <span class="mi">0</span> <span class="n">R</span>
<span class="o">&gt;&gt;</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="c1"># &#39;E&#39; is an indirect object and cannot be modified here!</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_set_key</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;E/F&quot;</span><span class="p">,</span> <span class="s2">&quot;90&quot;</span><span class="p">)</span>
<span class="n">mupdf</span><span class="p">:</span> <span class="n">path</span> <span class="n">to</span> <span class="s1">&#39;F&#39;</span> <span class="n">has</span> <span class="n">indirects</span>
<span class="o">---</span> <span class="o">...</span> <span class="o">---</span>
<span class="ne">RuntimeError</span><span class="p">:</span> <span class="n">path</span> <span class="n">to</span> <span class="s1">&#39;F&#39;</span> <span class="n">has</span> <span class="n">indirects</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>These are expert functions! There are no validations as to whether valid PDF objects, xrefs, etc. are specified. As with other low-level methods there is the risk to render the PDF, or parts of it unusable.</p>
</div>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>Do you have any feedback on this page?</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.3.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="recipes-common-issues-and-their-solutions.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Common Issues and their Solutions</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="recipes-optional-content.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Optional Content Support</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 10. Mar 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Low-Level Interfaces</a><ul>
<li><a class="reference internal" href="#how-to-iterate-through-the-xref-table">How to Iterate through the <code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code> Table</a></li>
<li><a class="reference internal" href="#how-to-handle-object-streams">How to Handle Object Streams</a></li>
<li><a class="reference internal" href="#how-to-handle-page-contents">How to Handle Page Contents</a></li>
<li><a class="reference internal" href="#how-to-access-the-pdf-catalog">How to Access the PDF Catalog</a></li>
<li><a class="reference internal" href="#how-to-access-the-pdf-file-trailer">How to Access the PDF File Trailer</a></li>
<li><a class="reference internal" href="#how-to-access-xml-metadata">How to Access XML Metadata</a></li>
<li><a class="reference internal" href="#how-to-extend-pdf-metadata">How to Extend PDF Metadata</a></li>
<li><a class="reference internal" href="#how-to-read-and-update-pdf-objects">How to Read and Update PDF Objects</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=9ddcf537"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    </body>
</html>