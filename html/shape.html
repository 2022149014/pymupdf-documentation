<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF is a high-performance Python library for data extraction, analysis, conversion &amp; manipulation of PDF (and other) documents." name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="About these documents" href="about.html" /><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Story" href="story-class.html" /><link rel="prev" title="Rect" href="rect.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Shape - PyMuPDF 1.25.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=74643500" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.3 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.3 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">Features Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#performance">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#license-and-copyright">License and Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">The Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF, LLM &amp; RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">Opening Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">Drawing and Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">Stories</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">Journalling</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">Multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - Optical Character Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">Optional Content Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">Low-Level Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">Common Issues and their Solutions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="module.html">Command line interface</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="classes.html">Classes</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">Operator Algebra for Geometry Objects</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">Low Level Functions and Classes</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Low Level Functions and Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">Working together: DisplayList and TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">Constants and Enumerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">Color Database</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app1.html">Appendix 1: Details on Text Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">Appendix 2: Considerations on Embedded Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">Appendix 3: Assorted Technical Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">Appendix 4: Performance Comparison Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">Deprecated Names</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/shape.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <style>

    #languageToggle {
        width:25%;
        margin:8px 10px 0;
    }

    #button-select-en {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 10px 0 0 10px;
        font-size: 14px;
    }

    #button-select-ja {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 0px 10px 10px 0;
        border-left: 0;
        font-size: 14px;
    }

    #button-select-en , #button-select-ja, #button-select-en:hover , #button-select-ja:hover  {
        color: #fff;
        text-decoration: none;
    }

    /* small screens */
    @media all and (max-width : 768px)  {
        #languageToggle {
            width:50%;
        }
    }

    @media all and (max-width : 400px)  {
        #languageToggle {
            width:70%;
        }
    }

    @media all and (max-width : 375px)  {
        #button-select-en , #button-select-ja {
            font-size: 11px;
        }
    }

</style>

<div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
    <div id="languageToggle"><span><a id="button-select-en" href="javaScript:changeLanguage('en')">English</a></span><span><a id="button-select-ja" href="javaScript:changeLanguage('ja')">日本語</a></span></div>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

    <div class="feedbackLink"><a id="feedbackLinkTop" target=_blank>Do you have any feedback on this page?</b></a></div>
</div>

<script>
    // highlightSelectedLanguage

    if (document.getElementsByTagName('html')[0].getAttribute('lang')=="ja") {
        document.getElementById("button-select-ja").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-en").style.color = "#000";
    } else {
        document.getElementById("button-select-en").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-ja").style.color = "#000";
    }


    var url_string = window.location.href;
    var a = document.getElementById('feedbackLinkTop');
    a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=header-link&url="+url_string);

    function changeLanguage(lang) {
        var new_url;

        if (lang == "en") {
            new_url = url_string.replace("/ja/", "/en/");
        } else {
            new_url = url_string.replace("/en/", "/ja/");
        }

        window.location.replace(new_url);
    }

</script><section id="shape">
<span id="id1"></span><h1>Shape<a class="headerlink" href="#shape" title="Link to this heading">¶</a></h1>
<p><div style="width:100%; text-align:right"><b>This class is for PDF only.</b></div></p>
<p>This class allows creating interconnected graphical elements on a PDF page. Its methods have the same meaning and name as the corresponding <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> methods.</p>
<p>In fact, each <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> draw method is just a convenience wrapper for (1) one shape draw method, (2) the <a class="reference internal" href="#Shape.finish" title="Shape.finish"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.finish()</span></code></a> method, and (3) the <a class="reference internal" href="#Shape.commit" title="Shape.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.commit()</span></code></a> method. For page text insertion, only the <a class="reference internal" href="#Shape.commit" title="Shape.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.commit()</span></code></a> method is invoked. If many draw and text operations are executed for a page, you should always consider using a Shape object.</p>
<p>Several draw methods can be executed in a row and each one of them will contribute to one drawing. Once the drawing is complete, the <a class="reference internal" href="#Shape.finish" title="Shape.finish"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.finish()</span></code></a> method must be invoked to apply color, dashing, width, morphing and other attributes.</p>
<p><strong>Draw</strong> methods of this class (and <a class="reference internal" href="#Shape.insert_textbox" title="Shape.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_textbox()</span></code></a>) are logging the area they are covering in a rectangle (<a class="reference internal" href="#Shape.rect" title="Shape.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.rect</span></code></a>). This property can for instance be used to set <a class="reference internal" href="page.html#Page.cropbox_position" title="Page.cropbox_position"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.cropbox_position</span></code></a>.</p>
<p><strong>Text insertions</strong> <a class="reference internal" href="#Shape.insert_text" title="Shape.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_text()</span></code></a> and <a class="reference internal" href="#Shape.insert_textbox" title="Shape.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_textbox()</span></code></a> implicitly execute a “finish” and therefore only require <a class="reference internal" href="#Shape.commit" title="Shape.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.commit()</span></code></a> to become effective. As a consequence, both include parameters for controlling properties like colors, etc.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Method / Attribute</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#Shape.commit" title="Shape.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.commit()</span></code></a></p></td>
<td><p>update the page’s contents</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Shape.draw_bezier" title="Shape.draw_bezier"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_bezier()</span></code></a></p></td>
<td><p>draw a cubic Bezier curve</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Shape.draw_circle" title="Shape.draw_circle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_circle()</span></code></a></p></td>
<td><p>draw a circle around a point</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Shape.draw_curve" title="Shape.draw_curve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_curve()</span></code></a></p></td>
<td><p>draw a cubic Bezier using one helper point</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Shape.draw_line" title="Shape.draw_line"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_line()</span></code></a></p></td>
<td><p>draw a line</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Shape.draw_oval" title="Shape.draw_oval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_oval()</span></code></a></p></td>
<td><p>draw an ellipse</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Shape.draw_polyline" title="Shape.draw_polyline"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_polyline()</span></code></a></p></td>
<td><p>connect a sequence of points</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Shape.draw_quad" title="Shape.draw_quad"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_quad()</span></code></a></p></td>
<td><p>draw a quadrilateral</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Shape.draw_rect" title="Shape.draw_rect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_rect()</span></code></a></p></td>
<td><p>draw a rectangle</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Shape.draw_sector" title="Shape.draw_sector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_sector()</span></code></a></p></td>
<td><p>draw a circular sector or piece of pie</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Shape.draw_squiggle" title="Shape.draw_squiggle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_squiggle()</span></code></a></p></td>
<td><p>draw a squiggly line</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Shape.draw_zigzag" title="Shape.draw_zigzag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_zigzag()</span></code></a></p></td>
<td><p>draw a zigzag line</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Shape.finish" title="Shape.finish"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.finish()</span></code></a></p></td>
<td><p>finish a set of draw commands</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Shape.insert_text" title="Shape.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_text()</span></code></a></p></td>
<td><p>insert text lines</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Shape.insert_textbox" title="Shape.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_textbox()</span></code></a></p></td>
<td><p>fit text into a rectangle</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Shape.doc" title="Shape.doc"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.doc</span></code></a></p></td>
<td><p>stores the page’s document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Shape.draw_cont" title="Shape.draw_cont"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.draw_cont</span></code></a></p></td>
<td><p>draw commands since last <a class="reference internal" href="#Shape.finish" title="Shape.finish"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.finish()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Shape.height" title="Shape.height"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.height</span></code></a></p></td>
<td><p>stores the page’s height</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Shape.lastPoint" title="Shape.lastPoint"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.lastPoint</span></code></a></p></td>
<td><p>stores the current point</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Shape.page" title="Shape.page"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.page</span></code></a></p></td>
<td><p>stores the owning page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Shape.rect" title="Shape.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.rect</span></code></a></p></td>
<td><p>rectangle surrounding drawings</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Shape.text_cont" title="Shape.text_cont"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.text_cont</span></code></a></p></td>
<td><p>accumulated text insertions</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Shape.totalcont" title="Shape.totalcont"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.totalcont</span></code></a></p></td>
<td><p>accumulated string to be stored in <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Shape.width" title="Shape.width"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.width</span></code></a></p></td>
<td><p>stores the page’s width</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Class API</strong></p>
<dl class="py class">
<dt class="sig sig-object py" id="Shape">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Shape</span></span><a class="headerlink" href="#Shape" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="Shape.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Create a new drawing. During importing PyMuPDF, the <em>pymupdf.Page</em> object is being given the convenience method <em>new_shape()</em> to construct a <em>Shape</em> object. During instantiation, a check will be made whether we do have a PDF page. An exception is otherwise raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>page</strong> (<a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a>) – an existing page of a PDF document.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Shape.draw_line">
<span class="sig-name descname"><span class="pre">draw_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.draw_line" title="Link to this definition">¶</a></dt>
<dd><p>Draw a line from <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> objects <em>p1</em> to <em>p2</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p1</strong> (<em>point_like</em>) – starting point</p></li>
<li><p><strong>p2</strong> (<em>point_like</em>) – end point</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the end point, <em>p2</em>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method" id="index-0">
<dt class="sig sig-object py" id="Shape.draw_squiggle">
<span class="sig-name descname"><span class="pre">draw_squiggle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">breadth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.draw_squiggle" title="Link to this definition">¶</a></dt>
<dd><p>Draw a squiggly (wavy, undulated) line from <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> objects <em>p1</em> to <em>p2</em>. An integer number of full wave periods will always be drawn, one period having a length of <em>4 * breadth</em>. The breadth parameter will be adjusted as necessary to meet this condition. The drawn line will always turn “left” when leaving <em>p1</em> and always join <em>p2</em> from the “right”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p1</strong> (<em>point_like</em>) – starting point</p></li>
<li><p><strong>p2</strong> (<em>point_like</em>) – end point</p></li>
<li><p><strong>breadth</strong> (<em>float</em>) – the amplitude of each wave. The condition <em>2 * breadth &lt; abs(p2 - p1)</em> must be true to fit in at least one wave. See the following picture, which shows two points connected by one full period.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the end point, <em>p2</em>.</p>
</dd>
</dl>
<img alt="_images/img-breadth.png" src="_images/img-breadth.png" />
<p>Here is an example of three connected lines, forming a closed, filled triangle. Little arrows indicate the stroking direction.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">=</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">=</span><span class="n">page</span><span class="o">.</span><span class="n">new_shape</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">draw_squiggle</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">tl</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">tr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">draw_squiggle</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">tr</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">br</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">draw_squiggle</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">br</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">tl</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;x.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/img-squiggly.png" src="_images/img-squiggly.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Waves drawn are <strong>not</strong> trigonometric (sine / cosine). If you need that, have a look at <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/draw-sines/draw.py">draw.py</a>.</p>
</div>
</dd></dl>

<dl class="py method" id="index-1">
<dt class="sig sig-object py" id="Shape.draw_zigzag">
<span class="sig-name descname"><span class="pre">draw_zigzag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">breadth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.draw_zigzag" title="Link to this definition">¶</a></dt>
<dd><p>Draw a zigzag line from <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> objects <em>p1</em> to <em>p2</em>. Otherwise works exactly like <a class="reference internal" href="#Shape.draw_squiggle" title="Shape.draw_squiggle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_squiggle()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p1</strong> (<em>point_like</em>) – starting point</p></li>
<li><p><strong>p2</strong> (<em>point_like</em>) – end point</p></li>
<li><p><strong>breadth</strong> (<em>float</em>) – the amplitude of the movement. The condition <em>2 * breadth &lt; abs(p2 - p1)</em> must be true to fit in at least one period.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the end point, <em>p2</em>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Shape.draw_polyline">
<span class="sig-name descname"><span class="pre">draw_polyline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.draw_polyline" title="Link to this definition">¶</a></dt>
<dd><p>Draw several connected lines between points contained in the sequence <em>points</em>. This can be used for creating arbitrary polygons by setting the last item equal to the first one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>points</strong> (<em>sequence</em>) – a sequence of <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> objects. Its length must at least be 2 (in which case it is equivalent to <em>draw_line()</em>).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>points[-1]</em> – the last point in the argument sequence.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Shape.draw_bezier">
<span class="sig-name descname"><span class="pre">draw_bezier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.draw_bezier" title="Link to this definition">¶</a></dt>
<dd><p>Draw a standard cubic Bézier curve from <em>p1</em> to <em>p4</em>, using <em>p2</em> and <em>p3</em> as control points.</p>
<p>All arguments are <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the end point, <em>p4</em>.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The points do not need to be different – experiment a bit with some of them being equal!</p>
</div>
<p>Example:</p>
<img alt="_images/img-drawBezier.png" src="_images/img-drawBezier.png" />
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Shape.draw_oval">
<span class="sig-name descname"><span class="pre">draw_oval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tetra</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.draw_oval" title="Link to this definition">¶</a></dt>
<dd><p>Draw an “ellipse” inside the given tetragon (quadrilateral). If it is a square, a regular circle is drawn, a general rectangle will result in an ellipse. If a quadrilateral is used instead, a plethora of shapes can be the result.</p>
<p>The drawing starts and ends at the middle point of the line <code class="xref any docutils literal notranslate"><span class="pre">bottom-left</span> <span class="pre">-&gt;</span> <span class="pre">top-left</span></code> corners in an anti-clockwise movement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tetra</strong> (<em>rect_like</em><em>,</em><em>quad_like</em>) – <p><a class="reference internal" href="glossary.html#rect_like" title="rect_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">rect_like</span></code></a> or <a class="reference internal" href="glossary.html#quad_like" title="quad_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">quad_like</span></code></a>.</p>
<p><em>Changed in version 1.14.5:</em>  Quads are now also supported.</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the middle point of line <code class="xref any docutils literal notranslate"><span class="pre">rect.bl</span> <span class="pre">-&gt;</span> <span class="pre">rect.tl</span></code>, or resp. <code class="xref any docutils literal notranslate"><span class="pre">quad.ll</span> <span class="pre">-&gt;</span> <span class="pre">quad.ul</span></code>. Look at just a few examples here, or at the <em>quad-show?.py</em> scripts in the PyMuPDF-Utilities repository.</p>
</dd>
</dl>
<a class="reference internal image-reference" href="_images/img-drawquad.jpg"><img alt="_images/img-drawquad.jpg" src="_images/img-drawquad.jpg" style="width: 787.0px; height: 281.5px;" />
</a>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Shape.draw_circle">
<span class="sig-name descname"><span class="pre">draw_circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.draw_circle" title="Link to this definition">¶</a></dt>
<dd><p>Draw a circle given its center and radius. The drawing starts and ends at point <code class="xref any docutils literal notranslate"><span class="pre">center</span> <span class="pre">-</span> <span class="pre">(radius,</span> <span class="pre">0)</span></code> in an <strong>anti-clockwise</strong> movement. This point is the middle of the enclosing square’s left side.</p>
<p>This is a shortcut for <code class="xref any docutils literal notranslate"><span class="pre">draw_sector(center,</span> <span class="pre">start,</span> <span class="pre">360,</span> <span class="pre">fullSector=False)</span></code>. To draw the same circle in a <strong>clockwise</strong> movement, use <code class="xref any docutils literal notranslate"><span class="pre">-360</span></code> as degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center</strong> (<em>point_like</em>) – the center of the circle.</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – the radius of the circle. Must be positive.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p><code class="xref any docutils literal notranslate"><span class="pre">Point(center.x</span> <span class="pre">-</span> <span class="pre">radius,</span> <span class="pre">center.y)</span></code>.</p>
<a class="reference internal" href="_images/img-drawcircle.jpg"><img alt="_images/img-drawcircle.jpg" src="_images/img-drawcircle.jpg" style="width: 236.39999999999998px; height: 232.2px;" /></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Shape.draw_curve">
<span class="sig-name descname"><span class="pre">draw_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.draw_curve" title="Link to this definition">¶</a></dt>
<dd><p>A special case of <em>draw_bezier()</em>: Draw a cubic Bezier curve from <em>p1</em> to <em>p3</em>. On each of the two lines <code class="xref any docutils literal notranslate"><span class="pre">p1</span> <span class="pre">-&gt;</span> <span class="pre">p2</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">p3</span> <span class="pre">-&gt;</span> <span class="pre">p2</span></code> one control point is generated. Both control points will therefore be on the same side of the line <code class="xref any docutils literal notranslate"><span class="pre">p1</span> <span class="pre">-&gt;</span> <span class="pre">p3</span></code>. This guaranties that the curve’s curvature does not change its sign. If the lines to p2 intersect with an angle of 90 degrees, then the resulting curve is a quarter ellipse (resp. quarter circle, if of same length).</p>
<p>All arguments are <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>the end point, <em>p3</em>. The following is a filled quarter ellipse segment. The yellow area is oriented <strong>clockwise:</strong></p>
<img alt="_images/img-drawCurve.png" class="align-center" src="_images/img-drawCurve.png" /></p>
</dd>
</dl>
</dd></dl>

<dl class="py method" id="index-2">
<dt class="sig sig-object py" id="Shape.draw_sector">
<span class="sig-name descname"><span class="pre">draw_sector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fullSector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.draw_sector" title="Link to this definition">¶</a></dt>
<dd><p>Draw a circular sector, optionally connecting the arc to the circle’s center (like a piece of pie).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center</strong> (<em>point_like</em>) – the center of the circle.</p></li>
<li><p><strong>point</strong> (<em>point_like</em>) – one of the two end points of the pie’s arc segment. The other one is calculated from the <em>angle</em>.</p></li>
<li><p><strong>angle</strong> (<em>float</em>) – the angle of the sector in degrees. Used to calculate the other end point of the arc. Depending on its sign, the arc is drawn anti-clockwise (positive) or clockwise.</p></li>
<li><p><strong>fullSector</strong> (<em>bool</em>) – whether to draw connecting lines from the ends of the arc to the circle center. If a fill color is specified, the full “pie” is colored, otherwise just the sector.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>the other end point of the arc. Can be used as starting point for a following invocation to create logically connected pies charts. Examples:</p>
<img alt="_images/img-drawSector1.png" src="_images/img-drawSector1.png" /><img alt="_images/img-drawSector2.png" src="_images/img-drawSector2.png" /></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Shape.draw_rect">
<span class="sig-name descname"><span class="pre">draw_rect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.draw_rect" title="Link to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Changed in v1.22.0: Added parameter <em>radius</em>.</p></li>
</ul>
<p>Draw a rectangle. The drawing starts and ends at the top-left corner in an anti-clockwise movement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect_like</em>) – where to put the rectangle on the page.</p></li>
<li><p><strong>radius</strong> (<em>multiple</em>) – draw rounded rectangle corners. If not <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>, specifies the radius of the curvature as a percentage of a rectangle side length. This must one or (a tuple of) two floats <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">radius</span> <span class="pre">&lt;=</span> <span class="pre">0.5</span></code>, where 0.5 corresponds to 50% of the respective side. If a float, the radius of the curvature is computed as <code class="xref any docutils literal notranslate"><span class="pre">radius</span> <span class="pre">*</span> <span class="pre">min(width,</span> <span class="pre">height)</span></code>, drawing the corner’s perimeter as a quarter circle. If a tuple <code class="xref any docutils literal notranslate"><span class="pre">(rx,</span> <span class="pre">ry)</span></code> is given, then the curvature is asymmetric with respect to the horizontal and vertical directions. A value of <code class="xref any docutils literal notranslate"><span class="pre">radius=(0.5,</span> <span class="pre">0.5)</span></code> draws an ellipse.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>top-left corner of the rectangle.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Shape.draw_quad">
<span class="sig-name descname"><span class="pre">draw_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.draw_quad" title="Link to this definition">¶</a></dt>
<dd><p>Draw a quadrilateral. The drawing starts and ends at the top-left corner (<a class="reference internal" href="quad.html#Quad.ul" title="Quad.ul"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Quad.ul</span></code></a>) in an anti-clockwise movement. It is a shortcut of <a class="reference internal" href="#Shape.draw_polyline" title="Shape.draw_polyline"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_polyline()</span></code></a> with the argument <code class="xref any docutils literal notranslate"><span class="pre">(ul,</span> <span class="pre">ll,</span> <span class="pre">lr,</span> <span class="pre">ur,</span> <span class="pre">ul)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>quad</strong> (<em>quad_like</em>) – where to put the tetragon on the page.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="quad.html#Quad.ul" title="Quad.ul"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Quad.ul</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method" id="index-3">
<dt class="sig sig-object py" id="Shape.finish">
<span class="sig-name descname"><span class="pre">finish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineCap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineJoin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">closePath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">even_odd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(fixpoint,</span> <span class="pre">matrix)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.finish" title="Link to this definition">¶</a></dt>
<dd><p>Finish a set of <em>draw*()</em> methods by applying <a class="reference internal" href="#commonparms"><span class="std std-ref">Common Parameters</span></a> to all of them.</p>
<p>It has <strong>no effect on</strong> <a class="reference internal" href="#Shape.insert_text" title="Shape.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_text()</span></code></a> and <a class="reference internal" href="#Shape.insert_textbox" title="Shape.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_textbox()</span></code></a>.</p>
<p>The method also supports <strong>morphing the compound drawing</strong> using <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a> <em>fixpoint</em> and <a class="reference internal" href="matrix.html#matrix"><span class="std std-ref">Matrix</span></a> <em>matrix</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>morph</strong> (<em>sequence</em>) – morph the text or the compound drawing around some arbitrary <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a> <em>fixpoint</em> by applying <a class="reference internal" href="matrix.html#matrix"><span class="std std-ref">Matrix</span></a> <em>matrix</em> to it. This implies that <em>fixpoint</em> is a <strong>fixed point</strong> of this operation: it will not change its position. Default is no morphing (<em>None</em>). The matrix can contain any values in its first 4 components, <em>matrix.e == matrix.f == 0</em> must be true, however. This means that any combination of scaling, shearing, rotating, flipping, etc. is possible, but translations are not.</p></li>
<li><p><strong>stroke_opacity</strong> (<em>float</em>) – <em>(new in v1.18.1)</em> set transparency for stroke colors. Value &lt; 0 or &gt; 1 will be ignored. Default is 1 (intransparent).</p></li>
<li><p><strong>fill_opacity</strong> (<em>float</em>) – <em>(new in v1.18.1)</em> set transparency for fill colors. Default is 1 (intransparent).</p></li>
<li><p><strong>even_odd</strong> (<em>bool</em>) – request the <strong>“even-odd rule”</strong> for filling operations. Default is <em>False</em>, so that the <strong>“nonzero winding number rule”</strong> is used. These rules are alternative methods to apply the fill color where areas overlap. Only with fairly complex shapes a different behavior is to be expected with these rules. For an in-depth explanation, see <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>, pp. 137 ff. Here is an example to demonstrate the difference.</p></li>
<li><p><strong>oc</strong> (<em>int</em>) – <em>(new in v1.18.4)</em> the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number of an <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> or <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> to make this drawing conditionally displayable.</p></li>
</ul>
</dd>
</dl>
<img alt="_images/img-even-odd.png" src="_images/img-even-odd.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For each pixel in a shape, the following will happen:</p>
<ol class="arabic simple">
<li><p>Rule <strong>“even-odd”</strong> counts, how many areas contain the pixel. If this count is <strong>odd,</strong> the pixel is regarded <strong>inside</strong> the shape, if it is <strong>even</strong>, the pixel is <strong>outside</strong>.</p></li>
<li><p>The default rule <strong>“nonzero winding”</strong> in addition looks at the <em>“orientation”</em> of each area containing the pixel: it <strong>adds 1</strong> if an area is drawn anti-clockwise and it <strong>subtracts 1</strong> for clockwise areas. If the result is zero, the pixel is regarded <strong>outside,</strong> pixels with a non-zero count are <strong>inside</strong> the shape.</p></li>
</ol>
<p>Of the four shapes in above image, the top two each show three circles drawn in standard manner (anti-clockwise, look at the arrows). The lower two shapes contain one (the top-left) circle drawn clockwise. As can be seen, area orientation is irrelevant for the right column (even-odd rule).</p>
</div>
</dd></dl>

<dl class="py method" id="index-4">
<dt class="sig sig-object py" id="Shape.insert_text">
<span class="sig-name descname"><span class="pre">insert_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'helv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TEXT_ENCODING_LATIN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineheight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">miter_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.insert_text" title="Link to this definition">¶</a></dt>
<dd><p>Insert text lines starting at <code class="docutils literal notranslate"><span class="pre">point</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point</strong> (<em>point_like</em>) – <p>the bottom-left position of the first character of <em>text</em> in pixels. It is important to understand, how this works in conjunction with the <em>rotate</em> parameter. Please have a look at the following picture. The small red dots indicate the positions of <em>point</em> in each of the four possible cases.</p>
<a class="reference internal" href="_images/img-inserttext.jpg"><img alt="_images/img-inserttext.jpg" src="_images/img-inserttext.jpg" style="width: 221.76000000000002px; height: 260.7px;" /></a></p></li>
<li><p><strong>text</strong> (<em>str/sequence</em>) – the text to be inserted. May be specified as either a string type or as a sequence type. For sequences, or strings containing line breaks <code class="docutils literal notranslate"><span class="pre">\n</span></code>, several lines will be inserted. No care will be taken if lines are too wide, but the number of inserted lines will be limited by “vertical” space on the page (in the sense of reading direction as established by the <em>rotate</em> parameter). Any rest of <em>text</em> is discarded – the return code however contains the number of inserted lines.</p></li>
<li><p><strong>lineheight</strong> (<em>float</em>) – a factor to override the line height calculated from font properties. If not <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>, a line height of <code class="xref any docutils literal notranslate"><span class="pre">fontsize</span> <span class="pre">*</span> <span class="pre">lineheight</span></code> will be used.</p></li>
<li><p><strong>stroke_opacity</strong> (<em>float</em>) – <em>(new in v1.18.1)</em> set transparency for stroke colors (the <strong>border line</strong> of a character). Only  <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">value</span> <span class="pre">&lt;=</span> <span class="pre">1</span></code> will be considered. Default is 1 (intransparent).</p></li>
<li><p><strong>fill_opacity</strong> (<em>float</em>) – <em>(new in v1.18.1)</em> set transparency for fill colors. Default is 1 (intransparent). Use this value to control transparency of the text color. Stroke opacity <strong>only</strong> affects the border line of characters.</p></li>
<li><p><strong>rotate</strong> (<em>int</em>) – determines whether to rotate the text. Acceptable values are multiples of 90 degrees. Default is 0 (no rotation), meaning horizontal text lines oriented from left to right. 180 means text is shown upside down from <strong>right to left</strong>. 90 means anti-clockwise rotation, text running <strong>upwards</strong>. 270 (or -90) means clockwise rotation, text running <strong>downwards</strong>. In any case, <em>point</em> specifies the bottom-left coordinates of the first character’s rectangle. Multiple lines, if present, always follow the reading direction established by this parameter. So line 2 is located <strong>above</strong> line 1 in case of <code class="xref any docutils literal notranslate"><span class="pre">rotate</span> <span class="pre">=</span> <span class="pre">180</span></code>, etc.</p></li>
<li><p><strong>oc</strong> (<em>int</em>) – <em>(new in v1.18.4)</em> the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number of an <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> or <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> to make this text conditionally displayable.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>number of lines inserted.</p>
</dd>
</dl>
<p>For a description of the other parameters see <a class="reference internal" href="#commonparms"><span class="std std-ref">Common Parameters</span></a>.</p>
</dd></dl>

<dl class="py method" id="index-5">
<dt class="sig sig-object py" id="Shape.insert_textbox">
<span class="sig-name descname"><span class="pre">insert_textbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'helv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TEXT_ENCODING_LATIN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">miter_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expandtabs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TEXT_ALIGN_LEFT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineheight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.insert_textbox" title="Link to this definition">¶</a></dt>
<dd><p>PDF only: Insert text into the specified rectangle. The text will be split into lines and words and then filled into the available space, starting from one of the four rectangle corners, which depends on <code class="xref any docutils literal notranslate"><span class="pre">rotate</span></code>. Line feeds and multiple space will be respected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect_like</em>) – the area to use. It must be finite and not empty.</p></li>
<li><p><strong>buffer</strong> (<em>str/sequence</em>) – the text to be inserted. Must be specified as a string or a sequence of strings. Line breaks are respected also when occurring in a sequence entry.</p></li>
<li><p><strong>align</strong> (<em>int</em>) – align each text line. Default is 0 (left). Centered, right and justified are the other supported options, see <a class="reference internal" href="vars.html#textalign"><span class="std std-ref">Text Alignment</span></a>. Please note that the effect of parameter value <em>TEXT_ALIGN_JUSTIFY</em> is only achievable with “simple” (single-byte) fonts (including the <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 Fonts</span></a>).</p></li>
<li><p><strong>lineheight</strong> (<em>float</em>) – <p>a factor to override the line height calculated from font properties. If not <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>, a line height of <code class="xref any docutils literal notranslate"><span class="pre">fontsize</span> <span class="pre">*</span> <span class="pre">lineheight</span></code> will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">arg int expandtabs<span class="colon">:</span></dt>
<dd class="field-odd"><p>controls handling of tab characters <code class="docutils literal notranslate"><span class="pre">\t</span></code> using the <code class="xref any docutils literal notranslate"><span class="pre">string.expandtabs()</span></code> method <strong>per each line</strong>.</p>
</dd>
</dl>
</p></li>
<li><p><strong>stroke_opacity</strong> (<em>float</em>) – <em>(new in v1.18.1)</em> set transparency for stroke colors. Negative values and values &gt; 1 will be ignored. Default is 1 (intransparent).</p></li>
<li><p><strong>fill_opacity</strong> (<em>float</em>) – <em>(new in v1.18.1)</em> set transparency for fill colors. Default is 1 (intransparent). Use this value to control transparency of the text color. Stroke opacity <strong>only</strong> affects the border line of characters.</p></li>
<li><p><strong>rotate</strong> (<em>int</em>) – requests text to be rotated in the rectangle. This value must be a multiple of 90 degrees. Default is 0 (no rotation). Effectively, the four values <code class="xref any docutils literal notranslate"><span class="pre">0</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">90</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">180</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">270</span></code> (= <code class="xref any docutils literal notranslate"><span class="pre">-90</span></code>) are processed, each causing the text to start in a different rectangle corner. Bottom-left is <code class="xref any docutils literal notranslate"><span class="pre">90</span></code>, bottom-right is <code class="xref any docutils literal notranslate"><span class="pre">180</span></code>, and <code class="xref any docutils literal notranslate"><span class="pre">-90</span> <span class="pre">/</span> <span class="pre">270</span></code> is top-right. See the example how text is filled in a rectangle. This argument takes precedence over morphing. See the second example, which shows text first rotated left by <code class="xref any docutils literal notranslate"><span class="pre">90</span></code> degrees and then the whole rectangle rotated clockwise around is lower left corner.</p></li>
<li><p><strong>oc</strong> (<em>int</em>) – <em>(new in v1.18.4)</em> the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number of an <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> or <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> to make this text conditionally displayable.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p><strong>If positive or zero</strong>: successful execution. The value returned is the unused rectangle line space in pixels. This may safely be ignored – or be used to optimize the rectangle, position subsequent items, etc.</p>
<p><strong>If negative</strong>: no execution. The value returned is the space deficit to store text lines. Enlarge rectangle, decrease <em>fontsize</em>, decrease text amount, etc.</p>
</p>
</dd>
</dl>
<img alt="_images/img-rotate.png" src="_images/img-rotate.png" />
<img alt="_images/img-rot%2Bmorph.png" src="_images/img-rot%2Bmorph.png" />
<p>For a description of the other parameters see <a class="reference internal" href="#commonparms"><span class="std std-ref">Common Parameters</span></a>.</p>
</dd></dl>

<dl class="py method" id="index-6">
<dt class="sig sig-object py" id="Shape.commit">
<span class="sig-name descname"><span class="pre">commit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Shape.commit" title="Link to this definition">¶</a></dt>
<dd><p>Update the page’s <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> with the accumulated drawings, followed by any text insertions. If text overlaps drawings, it will be written on top of the drawings.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Do not forget to execute this method:</strong></p>
<p>If a shape is <strong>not committed, it will be ignored and the page will not be changed!</strong></p>
</div>
<p>The method will reset attributes <a class="reference internal" href="#Shape.rect" title="Shape.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.rect</span></code></a>, <a class="reference internal" href="#Shape.lastPoint" title="Shape.lastPoint"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lastPoint</span></code></a>, <a class="reference internal" href="#Shape.draw_cont" title="Shape.draw_cont"><code class="xref py py-attr docutils literal notranslate"><span class="pre">draw_cont</span></code></a>, <a class="reference internal" href="#Shape.text_cont" title="Shape.text_cont"><code class="xref py py-attr docutils literal notranslate"><span class="pre">text_cont</span></code></a> and <a class="reference internal" href="#Shape.totalcont" title="Shape.totalcont"><code class="xref py py-attr docutils literal notranslate"><span class="pre">totalcont</span></code></a>. Afterwards, the shape object can be reused for the <strong>same page</strong>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>overlay</strong> (<em>bool</em>) – determine whether to put content in foreground (default) or background. Relevant only, if the page already has a non-empty <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> object.</p>
</dd>
</dl>
</dd></dl>

<p><strong>———- Attributes ———-</strong></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="Shape.doc">
<span class="sig-name descname"><span class="pre">doc</span></span><a class="headerlink" href="#Shape.doc" title="Link to this definition">¶</a></dt>
<dd><p>For reference only: the page’s document.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Shape.page">
<span class="sig-name descname"><span class="pre">page</span></span><a class="headerlink" href="#Shape.page" title="Link to this definition">¶</a></dt>
<dd><p>For reference only: the owning page.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Shape.height">
<span class="sig-name descname"><span class="pre">height</span></span><a class="headerlink" href="#Shape.height" title="Link to this definition">¶</a></dt>
<dd><p>Copy of the page’s height</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Shape.width">
<span class="sig-name descname"><span class="pre">width</span></span><a class="headerlink" href="#Shape.width" title="Link to this definition">¶</a></dt>
<dd><p>Copy of the page’s width.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Shape.draw_cont">
<span class="sig-name descname"><span class="pre">draw_cont</span></span><a class="headerlink" href="#Shape.draw_cont" title="Link to this definition">¶</a></dt>
<dd><p>Accumulated command buffer for <strong>draw methods</strong> since last finish. Every finish method will append its commands to <a class="reference internal" href="#Shape.totalcont" title="Shape.totalcont"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.totalcont</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Shape.text_cont">
<span class="sig-name descname"><span class="pre">text_cont</span></span><a class="headerlink" href="#Shape.text_cont" title="Link to this definition">¶</a></dt>
<dd><p>Accumulated text buffer. All <strong>text insertions</strong> go here. This buffer will be appended to <a class="reference internal" href="#Shape.totalcont" title="Shape.totalcont"><code class="xref py py-attr docutils literal notranslate"><span class="pre">totalcont</span></code></a> <a class="reference internal" href="#Shape.commit" title="Shape.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.commit()</span></code></a>, so that text will never be covered by drawings in the same Shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Shape.rect">
<span class="sig-name descname"><span class="pre">rect</span></span><a class="headerlink" href="#Shape.rect" title="Link to this definition">¶</a></dt>
<dd><p>Rectangle surrounding drawings. This attribute is at your disposal and may be changed at any time. Its value is set to <em>None</em> when a shape is created or committed. Every <em>draw*</em> method, and <a class="reference internal" href="#Shape.insert_textbox" title="Shape.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_textbox()</span></code></a> update this property (i.e. <strong>enlarge</strong> the rectangle as needed). <strong>Morphing</strong> operations, however (<a class="reference internal" href="#Shape.finish" title="Shape.finish"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.finish()</span></code></a>, <a class="reference internal" href="#Shape.insert_textbox" title="Shape.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_textbox()</span></code></a>) are ignored.</p>
<p>A typical use of this attribute would be setting <a class="reference internal" href="page.html#Page.cropbox_position" title="Page.cropbox_position"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.cropbox_position</span></code></a> to this value, when you are creating shapes for later or external use. If you have not manipulated the attribute yourself, it should reflect a rectangle that contains all drawings so far.</p>
<p>If you have used morphing and need a rectangle containing the morphed objects, use the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># assuming ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">morph</span> <span class="o">=</span> <span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">matrix</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... recalculate the shape rectangle like so:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="p">(</span><span class="n">shape</span><span class="o">.</span><span class="n">rect</span> <span class="o">-</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">point</span><span class="p">))</span> <span class="o">*</span> <span class="o">~</span><span class="n">matrix</span> <span class="o">+</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Shape.totalcont">
<span class="sig-name descname"><span class="pre">totalcont</span></span><a class="headerlink" href="#Shape.totalcont" title="Link to this definition">¶</a></dt>
<dd><p>Total accumulated command buffer for draws and text insertions. This will be used by <a class="reference internal" href="#Shape.commit" title="Shape.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.commit()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Shape.lastPoint">
<span class="sig-name descname"><span class="pre">lastPoint</span></span><a class="headerlink" href="#Shape.lastPoint" title="Link to this definition">¶</a></dt>
<dd><p>For reference only: the current point of the drawing path. It is <em>None</em> at <em>Shape</em> creation and after each <em>finish()</em> and <em>commit()</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p>A drawing object is constructed by <em>shape = page.new_shape()</em>. After this, as many draw, finish and text insertions methods as required may follow. Each sequence of draws must be finished before the drawing is committed. The overall coding pattern looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">new_shape</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">draw1</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">draw2</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="n">width</span><span class="o">=...</span><span class="p">,</span> <span class="n">color</span><span class="o">=...</span><span class="p">,</span> <span class="n">fill</span><span class="o">=...</span><span class="p">,</span> <span class="n">morph</span><span class="o">=...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">draw3</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">draw4</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="n">width</span><span class="o">=...</span><span class="p">,</span> <span class="n">color</span><span class="o">=...</span><span class="p">,</span> <span class="n">fill</span><span class="o">=...</span><span class="p">,</span> <span class="n">morph</span><span class="o">=...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">insert_text</span><span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">....</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>Each <em>finish()</em> combines the preceding draws into one logical shape, giving it common colors, line width, morphing, etc. If <em>closePath</em> is specified, it will also connect the end point of the last draw with the starting point of the first one.</p></li>
<li><p>To successfully create compound graphics, let each draw method use the end point of the previous one as its starting point. In the above pseudo code, <em>draw2</em> should hence use the returned <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a> of <em>draw1</em> as its starting point. Failing to do so, would automatically start a new path and <em>finish()</em> may not work as expected (but it won’t complain either).</p></li>
<li><p>Text insertions may occur anywhere before the commit (they neither touch <a class="reference internal" href="#Shape.draw_cont" title="Shape.draw_cont"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.draw_cont</span></code></a> nor <a class="reference internal" href="#Shape.lastPoint" title="Shape.lastPoint"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Shape.lastPoint</span></code></a>). They are appended to <em>Shape.totalcont</em> directly, whereas draws will be appended by <em>Shape.finish</em>.</p></li>
<li><p>Each <em>commit</em> takes all text insertions and shapes and places them in foreground or background on the page – thus providing a way to control graphical layers.</p></li>
<li><p><strong>Only</strong> <em>commit</em> <strong>will update</strong> the page’s contents, the other methods are basically string manipulations.</p></li>
</ol>
</div>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Create a full circle of pieces of pie in different colors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">new_shape</span><span class="p">()</span>  <span class="c1"># start a new shape</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># a sequence of RGB color triples</span>
<span class="n">pieces</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>  <span class="c1"># number of pieces to draw</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">360.</span> <span class="o">/</span> <span class="n">pieces</span>  <span class="c1"># angle of each piece of pie</span>
<span class="n">center</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># center of the pie</span>
<span class="n">p0</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># starting point</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pieces</span><span class="p">):</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">draw_sector</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span>
                          <span class="n">fullSector</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># draw piece</span>
    <span class="c1"># now fill it but do not connect ends of the arc</span>
    <span class="n">shape</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">cols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">closePath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">shape</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>  <span class="c1"># update the page</span>
</pre></div>
</div>
</li>
</ol>
<p>Here is an example for 5 colors:</p>
<img alt="_images/img-cake.png" src="_images/img-cake.png" />
<ol class="arabic" start="2">
<li><p>Create a regular n-edged polygon (fill yellow, red border). We use <em>draw_sector()</em> only to calculate the points on the circumference, and empty the draw command buffer again before drawing the polygon:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">new_shape</span><span class="p">()</span> <span class="c1"># start a new shape</span>
<span class="n">beta</span> <span class="o">=</span> <span class="o">-</span><span class="mf">360.0</span> <span class="o">/</span> <span class="n">n</span>  <span class="c1"># our angle, drawn clockwise</span>
<span class="n">center</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># center of circle</span>
<span class="n">p0</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># start here (1st edge)</span>
<span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">p0</span><span class="p">]</span>  <span class="c1"># store polygon edges</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>  <span class="c1"># calculate the edges</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">draw_sector</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>
<span class="n">shape</span><span class="o">.</span><span class="n">draw_cont</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># do not draw the circle sectors</span>
<span class="n">shape</span><span class="o">.</span><span class="n">draw_polyline</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>  <span class="c1"># draw the polygon</span>
<span class="n">shape</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">closePath</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">shape</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
<p>Here is the polygon for n = 7:</p>
<img alt="_images/img-7edges.png" src="_images/img-7edges.png" />
</section>
<section id="common-parameters">
<span id="commonparms"></span><h2>Common Parameters<a class="headerlink" href="#common-parameters" title="Link to this heading">¶</a></h2>
<p><strong>fontname</strong> (<em>str</em>)</p>
<blockquote>
<div><p>In general, there are three options:</p>
<ol class="arabic simple">
<li><p>Use one of the standard <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 Fonts</span></a>. In this case, <em>fontfile</em> <strong>must not</strong> be specified and <em>“Helvetica”</em> is used if this parameter is omitted, too.</p></li>
<li><p>Choose a font already in use by the page. Then specify its <strong>reference</strong> name prefixed with a slash “/”, see example below.</p></li>
<li><p>Specify a font file present on your system. In this case choose an arbitrary, but new name for this parameter (without “/” prefix).</p></li>
</ol>
<p>If inserted text should re-use one of the page’s fonts, use its reference name appearing in <a class="reference internal" href="page.html#Page.get_fonts" title="Page.get_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_fonts()</span></code></a> like so:</p>
<p>Suppose the font list has the item <em>[1024, 0, ‘Type1’, ‘NimbusMonL-Bold’, ‘R366’]</em>, then specify <em>fontname = “/R366”, fontfile = None</em> to use font <em>NimbusMonL-Bold</em>.</p>
</div></blockquote>
<hr class="docutils" />
<p><strong>fontfile</strong> (<em>str</em>)</p>
<blockquote>
<div><p>File path of a font existing on your computer. If you specify <em>fontfile</em>, make sure you use a <em>fontname</em> <strong>not occurring</strong> in the above list. This new font will be embedded in the PDF upon <em>doc.save()</em>. Similar to new images, a font file will be embedded only once. A table of MD5 codes for the binary font contents is used to ensure this.</p>
</div></blockquote>
<hr class="docutils" />
<p><strong>set_simple</strong> (<em>bool</em>)</p>
<blockquote>
<div><p>Fonts installed from files are installed as <strong>Type0</strong> fonts by default. If you want to use 1-byte characters only, set this to true. This setting cannot be reverted. Subsequent changes are ignored.</p>
</div></blockquote>
<hr class="docutils" />
<p><strong>fontsize</strong> (<em>float</em>)</p>
<blockquote>
<div><p>Font size of text, see: <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a>.</p>
</div></blockquote>
<hr class="docutils" />
<p><strong>dashes</strong> (<em>str</em>)</p>
<blockquote>
<div><p>Causes lines to be drawn dashed. The general format is <code class="xref any docutils literal notranslate"><span class="pre">&quot;[n</span> <span class="pre">m]</span> <span class="pre">p&quot;</span></code> of (up to) 3 floats denoting pixel lengths. <code class="docutils literal notranslate"><span class="pre">n</span></code> is the dash length, <code class="docutils literal notranslate"><span class="pre">m</span></code> (optional) is the subsequent gap length, and <code class="docutils literal notranslate"><span class="pre">p</span></code> (the “phase” - <strong>required</strong>, even if 0!) specifies how many pixels should be skipped before the dashing starts. If <code class="docutils literal notranslate"><span class="pre">m</span></code> is omitted, it defaults to <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>A continuous line (no dashes) is drawn with <code class="xref any docutils literal notranslate"><span class="pre">&quot;[]</span> <span class="pre">0&quot;</span></code> or <em>None</em> or <code class="xref any docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>. Examples:</p>
<ul class="simple">
<li><p>Specifying <code class="xref any docutils literal notranslate"><span class="pre">&quot;[3</span> <span class="pre">4]</span> <span class="pre">0&quot;</span></code> means dashes of 3 and gaps of 4 pixels following each other.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">&quot;[3</span> <span class="pre">3]</span> <span class="pre">0&quot;</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">&quot;[3]</span> <span class="pre">0&quot;</span></code> do the same thing.</p></li>
</ul>
<p>For (the rather complex) details on how to achieve sophisticated dashing effects, see <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>, page 217.</p>
</div></blockquote>
<hr class="docutils" />
<p><strong>color / fill</strong> (<em>list, tuple</em>)</p>
<blockquote>
<div><p>Stroke and fill colors can be specified as tuples or list of of floats from 0 to 1. These sequences must have a length of 1 (GRAY), 3 (RGB) or 4 (CMYK). For GRAY colorspace, a single float instead of the unwieldy <em>(float,)</em> or <em>[float]</em> is also accepted. Accept (default) or use <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> to not use the parameter.</p>
<p>To simplify color specification, method <em>getColor()</em> in <em>pymupdf.utils</em> may be used to get predefined RGB color triples by name. It accepts a string as the name of the color and returns the corresponding triple. The method knows over 540 color names – see section <a class="reference internal" href="colors.html#colordatabase"><span class="std std-ref">Color Database</span></a>.</p>
<p>Please note that the term <em>color</em> usually means “stroke” color when used in conjunction with fill color.</p>
<p>If letting default a color parameter to <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>, then no resp. color selection command will be generated. If <em>fill</em> and <em>color</em> are both <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>, then the drawing will contain no color specification. But it will still be “stroked”, which causes PDF’s default color “black” be used by Adobe Acrobat and all other viewers.</p>
</div></blockquote>
<hr class="docutils" />
<p><strong>width</strong> (<em>float</em>)</p>
<blockquote>
<div><p>The stroke (“border”) width of the elements in a shape (if applicable). The default value is 1. The values width, color and fill have the following relationship / dependency:</p>
<ul class="simple">
<li><p>If <code class="xref any docutils literal notranslate"><span class="pre">fill=None</span></code> shape elements will always be drawn with a border - even if <code class="xref any docutils literal notranslate"><span class="pre">color=None</span></code> (in which case black is taken) or <code class="xref any docutils literal notranslate"><span class="pre">width=0</span></code> (in which case 1 is taken).</p></li>
<li><p>Shapes without border can only be achieved if a fill color is specified (which may be white of course). To achieve this, specify <code class="xref any docutils literal notranslate"><span class="pre">width=0</span></code>. In this case, the <code class="docutils literal notranslate"><span class="pre">color</span></code> parameter is ignored.</p></li>
</ul>
</div></blockquote>
<hr class="docutils" />
<p><strong>stroke_opacity / fill_opacity</strong> (<em>floats</em>)</p>
<blockquote>
<div><p>Both values are floats in range [0, 1]. Negative values or values &gt; 1 will ignored (in most cases). Both set the transparency such that a value 0.5 corresponds to 50% transparency, 0 means invisible and 1 means intransparent. For e.g. a rectangle the stroke opacity applies to its border and fill opacity to its interior.</p>
<p>For text insertions (<a class="reference internal" href="#Shape.insert_text" title="Shape.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_text()</span></code></a> and <a class="reference internal" href="#Shape.insert_textbox" title="Shape.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_textbox()</span></code></a>), use <em>fill_opacity</em> for the text. At first sight this seems surprising, but it becomes obvious when you look further down to <code class="xref any docutils literal notranslate"><span class="pre">render_mode</span></code>: <code class="xref any docutils literal notranslate"><span class="pre">fill_opacity</span></code> applies to the yellow and <code class="xref any docutils literal notranslate"><span class="pre">stroke_opacity</span></code> applies to the blue color.</p>
</div></blockquote>
<hr class="docutils" />
<p><strong>border_width</strong> (<em>float</em>)</p>
<blockquote>
<div><p>Set the border width for text insertions. New in v1.14.9. Relevant only if the render mode argument is used with a value greater zero.</p>
</div></blockquote>
<hr class="docutils" />
<p><strong>render_mode</strong> (<em>int</em>)</p>
<blockquote>
<div><p><em>New in version 1.14.9:</em> Integer in <code class="xref any docutils literal notranslate"><span class="pre">range(8)</span></code> which controls the text appearance (<a class="reference internal" href="#Shape.insert_text" title="Shape.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_text()</span></code></a> and <a class="reference internal" href="#Shape.insert_textbox" title="Shape.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_textbox()</span></code></a>). See page 246 in <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>. New in v1.14.9. These methods now also differentiate between fill and stroke colors.</p>
<ul class="simple">
<li><p>For default 0, only the text fill color is used to paint the text. For backward compatibility, using the <em>color</em> parameter instead also works.</p></li>
<li><p>For render mode 1, only the border of each glyph (i.e. text character) is drawn with a thickness as set in argument <em>border_width</em>. The color chosen in the <em>color</em> argument is taken for this, the <em>fill</em> parameter is ignored.</p></li>
<li><p>For render mode 2, the glyphs are filled and stroked, using both color parameters and the specified border width. You can use this value to simulate <strong>bold text</strong> without using another font: choose the same value for <em>fill</em> and <em>color</em> and an appropriate value for <em>border_width</em>.</p></li>
<li><p>For render mode 3, the glyphs are neither stroked nor filled: the text becomes invisible.</p></li>
</ul>
<p>The following examples use border_width=0.3, together with a fontsize of 15. Stroke color is blue and fill color is some yellow.</p>
<img alt="_images/img-rendermode.jpg" src="_images/img-rendermode.jpg" />
</div></blockquote>
<hr class="docutils" />
<p><strong>miter_limit</strong> (<em>float</em>)</p>
<blockquote>
<div><p>A float specifying the maximum acceptable value of the quotient <code class="xref any docutils literal notranslate"><span class="pre">miter-length</span> <span class="pre">/</span> <span class="pre">line-width</span></code> (“miter quotient”). Used in text output methods. This is only relevant for non-zero render mode values – then, characters are written with border lines (i.e. “stroked”).</p>
<p>If two lines stroking some character meet at a sharp (&lt;= 90°) angle and the line width is large enough, then “spikes” may become visible – causing an ugly appearance as shown below. For more background, see page 126 of the <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>.</p>
<p>For instance, when joins meet at 90°, then the miter length is <code class="docutils literal notranslate"><span class="pre">sqrt(2)</span> <span class="pre">*</span> <span class="pre">line-width</span></code>, so the miter quotient is <code class="docutils literal notranslate"><span class="pre">sqrt(2)</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">miter_limit</span></code> is exceeded, then all joins with a larger qotient will appear as beveled (“butt” appearance).</p>
<p>The default value 1 (and any smaller value) will ensure that all joins are rendered as a butt. A value of <code class="docutils literal notranslate"><span class="pre">None</span></code> will use the PDF default value.</p>
<p>Example text showing spikes (<code class="docutils literal notranslate"><span class="pre">miter_limit=None</span></code>):</p>
<img alt="_images/spikes-yes.png" src="_images/spikes-yes.png" />
<p>Example text suppressing spikes (<code class="docutils literal notranslate"><span class="pre">miter_limit=1</span></code>):</p>
<img alt="_images/spikes-no.png" src="_images/spikes-no.png" />
</div></blockquote>
<hr class="docutils" />
<p><strong>overlay</strong> (<em>bool</em>)</p>
<blockquote>
<div><p>Causes the item to appear in foreground (default) or background.</p>
</div></blockquote>
<hr class="docutils" />
<p><strong>morph</strong> (<em>sequence</em>)</p>
<blockquote>
<div><p>Causes “morphing” of either a shape, created by the <em>draw*()</em> methods, or the text inserted by page methods <em>insert_textbox()</em> / <em>insert_text()</em>. If not <em>None</em>, it must be a pair <em>(fixpoint, matrix)</em>, where <em>fixpoint</em> is a <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a> and <em>matrix</em> is a <a class="reference internal" href="matrix.html#matrix"><span class="std std-ref">Matrix</span></a>. The matrix can be anything except translations, i.e. <em>matrix.e == matrix.f == 0</em> must be true. The point is used as a fixed point for the matrix operation. For example, if <em>matrix</em> is a rotation or scaling, then <em>fixpoint</em> is its center. Similarly, if <em>matrix</em> is a left-right or up-down flip, then the mirroring axis will be the vertical, respectively horizontal line going through <em>fixpoint</em>, etc.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Several methods contain checks whether the to be inserted items will actually fit into the page (like <a class="reference internal" href="#Shape.insert_text" title="Shape.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_text()</span></code></a>, or <a class="reference internal" href="#Shape.draw_rect" title="Shape.draw_rect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_rect()</span></code></a>). For the result of a morphing operation there is however no such guaranty: this is entirely the programmer’s responsibility.</p>
</div>
</div></blockquote>
<hr class="docutils" />
<p><strong>lineCap (deprecated: “roundCap”)</strong> (<em>int</em>)</p>
<blockquote>
<div><p>Controls the look of line ends. The default value 0 lets each line end at exactly the given coordinate in a sharp edge. A value of 1 adds a semi-circle to the ends, whose center is the end point and whose diameter is the line width. Value 2 adds a semi-square with an edge length of line width and a center of the line end.</p>
<p><em>Changed in version 1.14.15</em></p>
</div></blockquote>
<hr class="docutils" />
<p><strong>lineJoin</strong> (<em>int</em>)</p>
<blockquote>
<div><p><em>New in version 1.14.15:</em> Controls the way how line connections look like. This may be either as a sharp edge (0), a rounded join (1), or a cut-off edge (2, “butt”).</p>
</div></blockquote>
<hr class="docutils" />
<p><strong>closePath</strong> (<em>bool</em>)</p>
<blockquote>
<div><p>Causes the end point of a drawing to be automatically connected with the starting point (by a straight line).</p>
</div></blockquote>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>Do you have any feedback on this page?</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.3.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="story-class.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Story</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="rect.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Rect</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 10. Mar 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Shape</a><ul>
<li><a class="reference internal" href="#Shape"><code class="docutils literal notranslate"><span class="pre">Shape</span></code></a><ul>
<li><a class="reference internal" href="#Shape.__init__"><code class="docutils literal notranslate"><span class="pre">Shape.__init__()</span></code></a></li>
<li><a class="reference internal" href="#Shape.draw_line"><code class="docutils literal notranslate"><span class="pre">Shape.draw_line()</span></code></a></li>
<li><a class="reference internal" href="#Shape.draw_squiggle"><code class="docutils literal notranslate"><span class="pre">Shape.draw_squiggle()</span></code></a></li>
<li><a class="reference internal" href="#Shape.draw_zigzag"><code class="docutils literal notranslate"><span class="pre">Shape.draw_zigzag()</span></code></a></li>
<li><a class="reference internal" href="#Shape.draw_polyline"><code class="docutils literal notranslate"><span class="pre">Shape.draw_polyline()</span></code></a></li>
<li><a class="reference internal" href="#Shape.draw_bezier"><code class="docutils literal notranslate"><span class="pre">Shape.draw_bezier()</span></code></a></li>
<li><a class="reference internal" href="#Shape.draw_oval"><code class="docutils literal notranslate"><span class="pre">Shape.draw_oval()</span></code></a></li>
<li><a class="reference internal" href="#Shape.draw_circle"><code class="docutils literal notranslate"><span class="pre">Shape.draw_circle()</span></code></a></li>
<li><a class="reference internal" href="#Shape.draw_curve"><code class="docutils literal notranslate"><span class="pre">Shape.draw_curve()</span></code></a></li>
<li><a class="reference internal" href="#Shape.draw_sector"><code class="docutils literal notranslate"><span class="pre">Shape.draw_sector()</span></code></a></li>
<li><a class="reference internal" href="#Shape.draw_rect"><code class="docutils literal notranslate"><span class="pre">Shape.draw_rect()</span></code></a></li>
<li><a class="reference internal" href="#Shape.draw_quad"><code class="docutils literal notranslate"><span class="pre">Shape.draw_quad()</span></code></a></li>
<li><a class="reference internal" href="#Shape.finish"><code class="docutils literal notranslate"><span class="pre">Shape.finish()</span></code></a></li>
<li><a class="reference internal" href="#Shape.insert_text"><code class="docutils literal notranslate"><span class="pre">Shape.insert_text()</span></code></a></li>
<li><a class="reference internal" href="#Shape.insert_textbox"><code class="docutils literal notranslate"><span class="pre">Shape.insert_textbox()</span></code></a></li>
<li><a class="reference internal" href="#Shape.commit"><code class="docutils literal notranslate"><span class="pre">Shape.commit()</span></code></a></li>
<li><a class="reference internal" href="#Shape.doc"><code class="docutils literal notranslate"><span class="pre">Shape.doc</span></code></a></li>
<li><a class="reference internal" href="#Shape.page"><code class="docutils literal notranslate"><span class="pre">Shape.page</span></code></a></li>
<li><a class="reference internal" href="#Shape.height"><code class="docutils literal notranslate"><span class="pre">Shape.height</span></code></a></li>
<li><a class="reference internal" href="#Shape.width"><code class="docutils literal notranslate"><span class="pre">Shape.width</span></code></a></li>
<li><a class="reference internal" href="#Shape.draw_cont"><code class="docutils literal notranslate"><span class="pre">Shape.draw_cont</span></code></a></li>
<li><a class="reference internal" href="#Shape.text_cont"><code class="docutils literal notranslate"><span class="pre">Shape.text_cont</span></code></a></li>
<li><a class="reference internal" href="#Shape.rect"><code class="docutils literal notranslate"><span class="pre">Shape.rect</span></code></a></li>
<li><a class="reference internal" href="#Shape.totalcont"><code class="docutils literal notranslate"><span class="pre">Shape.totalcont</span></code></a></li>
<li><a class="reference internal" href="#Shape.lastPoint"><code class="docutils literal notranslate"><span class="pre">Shape.lastPoint</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#common-parameters">Common Parameters</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=9ddcf537"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    </body>
</html>