<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF is a high-performance Python library for data extraction, analysis, conversion &amp; manipulation of PDF (and other) documents." name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="About these documents" href="about.html" /><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Appendix 4: Performance Comparison Methodology" href="app4.html" /><link rel="prev" title="Appendix 2: Considerations on Embedded Files" href="app2.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Appendix 3: Assorted Technical Information - PyMuPDF 1.25.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=74643500" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.3 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.3 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">Features Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#performance">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#license-and-copyright">License and Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">The Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF, LLM &amp; RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">Opening Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">Drawing and Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">Stories</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">Journalling</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">Multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - Optical Character Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">Optional Content Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">Low-Level Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">Common Issues and their Solutions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module.html">Command line interface</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="classes.html">Classes</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">Operator Algebra for Geometry Objects</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">Low Level Functions and Classes</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Low Level Functions and Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">Working together: DisplayList and TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">Constants and Enumerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">Color Database</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="app1.html">Appendix 1: Details on Text Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">Appendix 2: Considerations on Embedded Files</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Appendix 3: Assorted Technical Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">Appendix 4: Performance Comparison Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">Deprecated Names</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/app3.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <style>

    #languageToggle {
        width:25%;
        margin:8px 10px 0;
    }

    #button-select-en {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 10px 0 0 10px;
        font-size: 14px;
    }

    #button-select-ja {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 0px 10px 10px 0;
        border-left: 0;
        font-size: 14px;
    }

    #button-select-en , #button-select-ja, #button-select-en:hover , #button-select-ja:hover  {
        color: #fff;
        text-decoration: none;
    }

    /* small screens */
    @media all and (max-width : 768px)  {
        #languageToggle {
            width:50%;
        }
    }

    @media all and (max-width : 400px)  {
        #languageToggle {
            width:70%;
        }
    }

    @media all and (max-width : 375px)  {
        #button-select-en , #button-select-ja {
            font-size: 11px;
        }
    }

</style>

<div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
    <div id="languageToggle"><span><a id="button-select-en" href="javaScript:changeLanguage('en')">English</a></span><span><a id="button-select-ja" href="javaScript:changeLanguage('ja')">日本語</a></span></div>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

    <div class="feedbackLink"><a id="feedbackLinkTop" target=_blank>Do you have any feedback on this page?</b></a></div>
</div>

<script>
    // highlightSelectedLanguage

    if (document.getElementsByTagName('html')[0].getAttribute('lang')=="ja") {
        document.getElementById("button-select-ja").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-en").style.color = "#000";
    } else {
        document.getElementById("button-select-en").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-ja").style.color = "#000";
    }


    var url_string = window.location.href;
    var a = document.getElementById('feedbackLinkTop');
    a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=header-link&url="+url_string);

    function changeLanguage(lang) {
        var new_url;

        if (lang == "en") {
            new_url = url_string.replace("/ja/", "/en/");
        } else {
            new_url = url_string.replace("/en/", "/ja/");
        }

        window.location.replace(new_url);
    }

</script><section id="appendix-3-assorted-technical-information">
<span id="appendix3"></span><h1>Appendix 3: Assorted Technical Information<a class="headerlink" href="#appendix-3-assorted-technical-information" title="Link to this heading">¶</a></h1>
<p>This section deals with various technical topics, that are not necessarily related to each other.</p>
<hr class="docutils" />
<section id="image-transformation-matrix">
<span id="imagetransformation"></span><h2>Image Transformation Matrix<a class="headerlink" href="#image-transformation-matrix" title="Link to this heading">¶</a></h2>
<p>Starting with version 1.18.11, the image transformation matrix is returned by some methods for text and image extraction: <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> and <a class="reference internal" href="page.html#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a>.</p>
<p>The transformation matrix contains information about how an image was transformed to fit into the rectangle (its “boundary box” = “bbox”) on some document page. By inspecting the image’s bbox on the page and this matrix, one can determine for example, whether and how the image is displayed scaled or rotated on a page.</p>
<p>The relationship between image dimension and its bbox on a page is the following:</p>
<ol class="arabic">
<li><dl class="simple">
<dt>Using the original image’s width and height,</dt><dd><ul class="simple">
<li><p>define the image rectangle <code class="xref any docutils literal notranslate"><span class="pre">imgrect</span> <span class="pre">=</span> <span class="pre">pymupdf.Rect(0,</span> <span class="pre">0,</span> <span class="pre">width,</span> <span class="pre">height)</span></code></p></li>
<li><p>define the “shrink matrix” <code class="xref any docutils literal notranslate"><span class="pre">shrink</span> <span class="pre">=</span> <span class="pre">pymupdf.Matrix(1/width,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">1/height,</span> <span class="pre">0,</span> <span class="pre">0)</span></code>.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Transforming the image rectangle with its shrink matrix, will result in the unit rectangle: <code class="xref any docutils literal notranslate"><span class="pre">imgrect</span> <span class="pre">*</span> <span class="pre">shrink</span> <span class="pre">=</span> <span class="pre">pymupdf.Rect(0,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1)</span></code>.</p></li>
<li><p>Using the image <strong>transformation matrix</strong> “transform”, the following steps will compute the bbox:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">imgrect</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
<span class="n">shrink</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">height</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">bbox</span> <span class="o">=</span> <span class="n">imgrect</span> <span class="o">*</span> <span class="n">shrink</span> <span class="o">*</span> <span class="n">transform</span>
</pre></div>
</div>
</li>
<li><p>Inspecting the matrix product <code class="xref any docutils literal notranslate"><span class="pre">shrink</span> <span class="pre">*</span> <span class="pre">transform</span></code> will reveal all information about what happened to the image rectangle to make it fit into the bbox on the page: rotation, scaling of its sides and translation of its origin. Let us look at an example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">imginfo</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_images</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># get an image item on a page</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imginfo</span>
<span class="go">(5, 0, 439, 501, 8, &#39;DeviceRGB&#39;, &#39;&#39;, &#39;fzImg0&#39;, &#39;DCTDecode&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#------------------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># define image shrink matrix and rectangle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#------------------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shrink</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">439</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">501</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgrect</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">439</span><span class="p">,</span> <span class="mi">501</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#------------------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># determine image bbox and transformation matrix:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#------------------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span><span class="p">,</span> <span class="n">transform</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_image_bbox</span><span class="p">(</span><span class="s2">&quot;fzImg0&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#------------------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># confirm equality - permitting rounding errors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#------------------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bbox</span>
<span class="go">Rect(100.0, 112.37525939941406, 300.0, 287.624755859375)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgrect</span> <span class="o">*</span> <span class="n">shrink</span> <span class="o">*</span> <span class="n">transform</span>
<span class="go">Rect(100.0, 112.375244140625, 300.0, 287.6247253417969)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#------------------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shrink</span> <span class="o">*</span> <span class="n">transform</span>
<span class="go">Matrix(0.0, -0.39920157194137573, 0.3992016017436981, 0.0, 100.0, 287.6247253417969)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#------------------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the above shows:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># image sides are scaled by same factor ~0.4,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># and the image is rotated by 90 degrees clockwise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># compare this with pymupdf.Matrix(-90) * 0.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#------------------------------------------------</span>
</pre></div>
</div>
</li>
</ol>
<hr class="docutils" />
</section>
<section id="pdf-base-14-fonts">
<span id="base-14-fonts"></span><h2>PDF Base 14 Fonts<a class="headerlink" href="#pdf-base-14-fonts" title="Link to this heading">¶</a></h2>
<p>The following 14 builtin font names <strong>must be supported by every PDF viewer</strong> application. They are available as a dictionary, which maps their full names amd their abbreviations in lower case to the full font basename. Wherever a <strong>fontname</strong> must be provided in PyMuPDF, any <strong>key or value</strong> from the dictionary may be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Base14_fontdict</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;courier&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier&#39;</span><span class="p">,</span>
<span class="s1">&#39;courier-oblique&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier-Oblique&#39;</span><span class="p">,</span>
<span class="s1">&#39;courier-bold&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier-Bold&#39;</span><span class="p">,</span>
<span class="s1">&#39;courier-boldoblique&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier-BoldOblique&#39;</span><span class="p">,</span>
<span class="s1">&#39;helvetica&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span>
<span class="s1">&#39;helvetica-oblique&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica-Oblique&#39;</span><span class="p">,</span>
<span class="s1">&#39;helvetica-bold&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica-Bold&#39;</span><span class="p">,</span>
<span class="s1">&#39;helvetica-boldoblique&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica-BoldOblique&#39;</span><span class="p">,</span>
<span class="s1">&#39;times-roman&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-Roman&#39;</span><span class="p">,</span>
<span class="s1">&#39;times-italic&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-Italic&#39;</span><span class="p">,</span>
<span class="s1">&#39;times-bold&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-Bold&#39;</span><span class="p">,</span>
<span class="s1">&#39;times-bolditalic&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-BoldItalic&#39;</span><span class="p">,</span>
<span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;Symbol&#39;</span><span class="p">,</span>
<span class="s1">&#39;zapfdingbats&#39;</span><span class="p">:</span> <span class="s1">&#39;ZapfDingbats&#39;</span><span class="p">,</span>
<span class="s1">&#39;helv&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span>
<span class="s1">&#39;heit&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica-Oblique&#39;</span><span class="p">,</span>
<span class="s1">&#39;hebo&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica-Bold&#39;</span><span class="p">,</span>
<span class="s1">&#39;hebi&#39;</span><span class="p">:</span> <span class="s1">&#39;Helvetica-BoldOblique&#39;</span><span class="p">,</span>
<span class="s1">&#39;cour&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier&#39;</span><span class="p">,</span>
<span class="s1">&#39;coit&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier-Oblique&#39;</span><span class="p">,</span>
<span class="s1">&#39;cobo&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier-Bold&#39;</span><span class="p">,</span>
<span class="s1">&#39;cobi&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier-BoldOblique&#39;</span><span class="p">,</span>
<span class="s1">&#39;tiro&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-Roman&#39;</span><span class="p">,</span>
<span class="s1">&#39;tibo&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-Bold&#39;</span><span class="p">,</span>
<span class="s1">&#39;tiit&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-Italic&#39;</span><span class="p">,</span>
<span class="s1">&#39;tibi&#39;</span><span class="p">:</span> <span class="s1">&#39;Times-BoldItalic&#39;</span><span class="p">,</span>
<span class="s1">&#39;symb&#39;</span><span class="p">:</span> <span class="s1">&#39;Symbol&#39;</span><span class="p">,</span>
<span class="s1">&#39;zadb&#39;</span><span class="p">:</span> <span class="s1">&#39;ZapfDingbats&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>In contrast to their obligation, not all PDF viewers support these fonts correctly and completely – this is especially true for Symbol and ZapfDingbats. Also, the glyph (visual) images will be specific to every reader.</p>
<p>To see how these fonts can be used – including the <strong>CJK built-in</strong> fonts – look at the table in <a class="reference internal" href="page.html#Page.insert_font" title="Page.insert_font"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_font()</span></code></a>.</p>
<hr class="docutils" />
</section>
<section id="adobe-pdf-references">
<span id="adobemanual"></span><h2>Adobe PDF References<a class="headerlink" href="#adobe-pdf-references" title="Link to this heading">¶</a></h2>
<p>This PDF Reference manual published by Adobe is frequently quoted throughout this documentation. It can be viewed and downloaded from <a class="reference external" href="https://opensource.adobe.com/dc-acrobat-sdk-docs/standards/pdfstandards/pdf/PDF32000_2008.pdf">here</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a long time, an older version was also available under <a class="reference external" href="http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/pdf_reference_1-7.pdf">this</a> link. It seems to be taken off of the web site in October 2021. Earlier (pre 1.19.*) versions of the PyMuPDF documentation used to refer to this document. We have undertaken an effort to replace referrals to the current specification above.</p>
</div>
<hr class="docutils" />
</section>
<section id="using-python-sequences-as-arguments-in-pymupdf">
<span id="sequencetypes"></span><h2>Using Python Sequences as Arguments in PyMuPDF<a class="headerlink" href="#using-python-sequences-as-arguments-in-pymupdf" title="Link to this heading">¶</a></h2>
<p>When PyMuPDF objects and methods require a Python <strong>list</strong> of numerical values, other Python <strong>sequence types</strong> are also allowed. Python classes are said to implement the <strong>sequence protocol</strong>, if they have a <code class="xref any docutils literal notranslate"><span class="pre">__getitem__()</span></code> method.</p>
<p>This basically means, you can interchangeably use Python <em>list</em> or <em>tuple</em> or even <em>array.array</em>, <em>numpy.array</em> and <em>bytearray</em> types in these cases.</p>
<p>For example, specifying a sequence <code class="xref any docutils literal notranslate"><span class="pre">&quot;s&quot;</span></code> in any of the following ways</p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">[1,</span> <span class="pre">2]</span></code> – a list</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">(1,</span> <span class="pre">2)</span></code> – a tuple</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">array.array(&quot;i&quot;,</span> <span class="pre">(1,</span> <span class="pre">2))</span></code> – an array.array</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">numpy.array((1,</span> <span class="pre">2))</span></code> – a numpy array</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">bytearray((1,</span> <span class="pre">2))</span></code> – a bytearray</p></li>
</ul>
<p>will make it usable in the following example expressions:</p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">pymupdf.Point(s)</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">pymupdf.Point(x,</span> <span class="pre">y)</span> <span class="pre">+</span> <span class="pre">s</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">doc.select(s)</span></code></p></li>
</ul>
<p>Similarly with all geometry objects <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>, <a class="reference internal" href="irect.html#irect"><span class="std std-ref">IRect</span></a>, <a class="reference internal" href="matrix.html#matrix"><span class="std std-ref">Matrix</span></a> and <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a>.</p>
<p>Because all PyMuPDF geometry classes themselves are special cases of sequences, they (with the exception of <a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a> – see below) can be freely used where numerical sequences can be used, e.g. as arguments for functions like <em>list()</em>, <em>tuple()</em>, <em>array.array()</em> or <em>numpy.array()</em>. Look at the following snippet to see this work.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymupdf</span><span class="o">,</span> <span class="nn">array</span><span class="o">,</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">[1.0, 2.0, 3.0, 4.0, 5.0, 6.0]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">(1.0, 2.0, 3.0, 4.0, 5.0, 6.0)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="go">array(&#39;f&#39;, [1.0, 2.0, 3.0, 4.0, 5.0, 6.0])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">array([1., 2., 3., 4., 5., 6.])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a> is a Python sequence object as well and has a length of 4. Its items however are <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> – not numbers. Therefore, the above remarks do not apply.</p>
</div>
<hr class="docutils" />
</section>
<section id="ensuring-consistency-of-important-objects-in-pymupdf">
<span id="referenialintegrity"></span><h2>Ensuring Consistency of Important Objects in PyMuPDF<a class="headerlink" href="#ensuring-consistency-of-important-objects-in-pymupdf" title="Link to this heading">¶</a></h2>
<p>PyMuPDF is a Python binding for the C library MuPDF. While a lot of effort has been invested by MuPDF’s creators to approximate some sort of an object-oriented behavior, they certainly could not overcome basic shortcomings of the C language in that respect.</p>
<p>Python on the other hand implements the OO-model in a very clean way. The interface code between PyMuPDF and MuPDF consists of two basic files: <em>pymupdf.py</em> and <em>fitz_wrap.c</em>. They are created by the excellent SWIG tool for each new version.</p>
<p>When you use one of PyMuPDF’s objects or methods, this will result in execution of some code in <em>pymupdf.py</em>, which in turn will call some C code compiled with <em>fitz_wrap.c</em>.</p>
<p>Because SWIG goes a long way to keep the Python and the C level in sync, everything works fine, if a certain set of rules is being strictly followed. For example: <strong>never access</strong> a <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> object, after you have closed (or deleted or set to <em>None</em>) the owning <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a>. Or, less obvious: <strong>never access</strong> a page or any of its children (links or annotations) after you have executed one of the document methods <em>select()</em>, <em>delete_page()</em>, <em>insert_page()</em> … and more.</p>
<p>But just no longer accessing invalidated objects is actually not enough: They should rather be actively deleted entirely, to also free C-level resources (meaning allocated memory).</p>
<p>The reason for these rules lies in the fact that there is a hierarchical 2-level one-to-many relationship between a document and its pages and also between a page and its links / annotations. To maintain a consistent situation, any of the above actions must lead to a complete reset – in <strong>Python and, synchronously, in C</strong>.</p>
<p>SWIG cannot know about this and consequently does not do it.</p>
<p>The required logic has therefore been built into PyMuPDF itself in the following way.</p>
<ol class="arabic simple">
<li><p>If a page “loses” its owning document or is being deleted itself, all of its currently existing annotations and links will be made unusable in Python, and their C-level counterparts will be deleted and deallocated.</p></li>
<li><p>If a document is closed (or deleted or set to <em>None</em>) or if its structure has changed, then similarly all currently existing pages and their children will be made unusable, and corresponding C-level deletions will take place. “Structure changes” include methods like <em>select()</em>, <em>delePage()</em>, <em>insert_page()</em>, <em>insert_pdf()</em> and so on: all of these will result in a cascade of object deletions.</p></li>
</ol>
<p>The programmer will normally not realize any of this. If he, however, tries to access invalidated objects, exceptions will be raised.</p>
<p>Invalidated objects cannot be directly deleted as with Python statements like <em>del page</em> or <em>page = None</em>, etc. Instead, their <em>__del__</em> method must be invoked.</p>
<p>All pages, links and annotations have the property <em>parent</em>, which points to the owning object. This is the property that can be checked on the application level: if <em>obj.parent == None</em> then the object’s parent is gone, and any reference to its properties or methods will raise an exception informing about this “orphaned” state.</p>
<p>A sample session:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">first_annot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="o">.</span><span class="n">type</span>                    <span class="c1"># everything works fine</span>
<span class="go">[5, &#39;Circle&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span> <span class="o">=</span> <span class="kc">None</span>                   <span class="c1"># this turns &#39;annot&#39; into an orphan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="o">.</span><span class="n">type</span>
<span class="go">&lt;... omitted lines ...&gt;</span>
<span class="go">RuntimeError: orphaned object: parent is None</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># same happens, if you do this:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">first_annot</span>     <span class="c1"># deletes the page again immediately!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="o">.</span><span class="n">type</span>                    <span class="c1"># so, &#39;annot&#39; is &#39;born&#39; orphaned</span>
<span class="go">&lt;... omitted lines ...&gt;</span>
<span class="go">RuntimeError: orphaned object: parent is None</span>
</pre></div>
</div>
<p>This shows the cascading effect:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">first_annot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">rect</span>
<span class="go">pymupdf.Rect(0.0, 0.0, 595.0, 842.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="o">.</span><span class="n">type</span>
<span class="go">[5, &#39;Circle&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">doc</span>                       <span class="c1"># or doc = None or doc.close()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">rect</span>
<span class="go">&lt;... omitted lines ...&gt;</span>
<span class="go">RuntimeError: orphaned object: parent is None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annot</span><span class="o">.</span><span class="n">type</span>
<span class="go">&lt;... omitted lines ...&gt;</span>
<span class="go">RuntimeError: orphaned object: parent is None</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Objects outside the above relationship are not included in this mechanism. If you e.g. created a table of contents by <em>toc = doc.get_toc()</em>, and later close or change the document, then this cannot and does not change variable <em>toc</em> in any way. It is your responsibility to refresh such variables as required.</p>
</div>
<hr class="docutils" />
</section>
<section id="design-of-method-page-show-pdf-page">
<span id="formxobject"></span><h2>Design of Method <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a><a class="headerlink" href="#design-of-method-page-show-pdf-page" title="Link to this heading">¶</a></h2>
<section id="purpose-and-capabilities">
<h3>Purpose and Capabilities<a class="headerlink" href="#purpose-and-capabilities" title="Link to this heading">¶</a></h3>
<p>The method displays an image of a (“source”) page of another PDF document within a specified rectangle of the current (“containing”, “target”) page.</p>
<ul class="simple">
<li><p><strong>In contrast</strong> to <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a>, this display is vector-based and hence remains accurate across zooming levels.</p></li>
<li><p><strong>Just like</strong> <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a>, the size of the display is adjusted to the given rectangle.</p></li>
</ul>
<p>The following variations of the display are currently supported:</p>
<ul class="simple">
<li><dl class="simple">
<dt>Bool parameter <code class="xref any docutils literal notranslate"><span class="pre">&quot;keep_proportion&quot;</span></code> controls whether to maintain the aspect ratio (default) or not.</dt><dd><ul>
<li><p>Rectangle parameter <code class="xref any docutils literal notranslate"><span class="pre">&quot;clip&quot;</span></code> restricts the visible part of the source page rectangle. Default is the full page.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>float <code class="xref any docutils literal notranslate"><span class="pre">&quot;rotation&quot;</span></code> rotates the display by an arbitrary angle (degrees). If the angle is not an integer multiple of 90, only 2 of the 4 corners may be positioned on the target border if also <code class="xref any docutils literal notranslate"><span class="pre">&quot;keep_proportion&quot;</span></code> is true.</p></li>
<li><p>Bool parameter <code class="xref any docutils literal notranslate"><span class="pre">&quot;overlay&quot;</span></code> controls whether to put the image on top (foreground, default) of current page content or not (background).</p></li>
</ul>
<p>Use cases include (but are not limited to) the following:</p>
<ol class="arabic simple">
<li><p>“Stamp” a series of pages of the current document with the same image, like a company logo or a watermark.</p></li>
<li><p>Combine arbitrary input pages into one output page to support “booklet” or double-sided printing (known as “4-up”, “n-up”).</p></li>
<li><p>Split up (large) input pages into several arbitrary pieces. This is also called “posterization”, because you e.g. can split an A4 page horizontally and vertically, print the 4 pieces enlarged to separate A4 pages, and end up with an A2 version of your original page.</p></li>
</ol>
</section>
<section id="technical-implementation">
<h3>Technical Implementation<a class="headerlink" href="#technical-implementation" title="Link to this heading">¶</a></h3>
<p>This is done using PDF <strong>“Form XObjects”</strong>, see section 8.10 on page 217 of <a class="reference internal" href="#adobemanual"><span class="std std-ref">Adobe PDF References</span></a>. On execution of a <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>, the following things happen:</p>
<blockquote>
<div><ol class="arabic">
<li><p>The <a class="reference internal" href="glossary.html#resources" title="resources"><code class="xref py py-data docutils literal notranslate"><span class="pre">resources</span></code></a> and <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> objects of source page in source document are copied over to the target document, jointly creating a new <strong>Form XObject</strong> with the following properties. The PDF <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number of this object is returned by the method.</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">/BBox</span></code> equals <code class="xref any docutils literal notranslate"><span class="pre">/Mediabox</span></code> of the source page</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">/Matrix</span></code> equals the identity matrix.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">/Resources</span></code> equals that of the source page. This involves a “deep-copy” of hierarchically nested other objects (including fonts, images, etc.). The complexity involved here is covered by MuPDF’s grafting <a class="footnote-reference brackets" href="#f1" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> technique functions.</p></li>
<li><p>This is a stream object type, and its stream is an exact copy of the combined data of the source page’s <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> objects.</p></li>
</ol>
<p>This Form XObject is only executed once per shown source page. Subsequent displays of the same source page will skip this step and only create “pointer” Form XObjects (done in next step) to this object.</p>
</div></blockquote>
</li>
<li><p>A second <strong>Form XObject</strong> is then created which the target page uses to invoke the display. This object has the following properties:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">/BBox</span></code> equals the <code class="xref any docutils literal notranslate"><span class="pre">/CropBox</span></code> of the source page (or <code class="xref any docutils literal notranslate"><span class="pre">&quot;clip&quot;</span></code>).</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">/Matrix</span></code> represents the mapping of <code class="xref any docutils literal notranslate"><span class="pre">/BBox</span></code> to the target rectangle.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">/XObject</span></code> references the previous Form XObject via the fixed name <code class="xref any docutils literal notranslate"><span class="pre">fullpage</span></code>.</p></li>
<li><p>The stream of this object contains exactly one fixed statement: <code class="xref any docutils literal notranslate"><span class="pre">/fullpage</span> <span class="pre">Do</span></code>.</p></li>
<li><p>If the method’s <code class="xref any docutils literal notranslate"><span class="pre">&quot;oc&quot;</span></code> argument is given, its value is assigned to this Form XObject as <code class="xref any docutils literal notranslate"><span class="pre">/OC</span></code>.</p></li>
</ol>
</div></blockquote>
</li>
<li><p>The <a class="reference internal" href="glossary.html#resources" title="resources"><code class="xref py py-data docutils literal notranslate"><span class="pre">resources</span></code></a> and <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> objects of the target page are now modified as follows.</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Add an entry to the <code class="xref any docutils literal notranslate"><span class="pre">/XObject</span></code> dictionary of <code class="xref any docutils literal notranslate"><span class="pre">/Resources</span></code> with the name <a class="reference internal" href="colorspace.html#Colorspace.n" title="Colorspace.n"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">fzFrm</span></code></a> (with n chosen such that this entry is unique on the page).</p></li>
<li><p>Depending on <code class="xref any docutils literal notranslate"><span class="pre">&quot;overlay&quot;</span></code>, prepend or append a new object to the page’s <code class="xref any docutils literal notranslate"><span class="pre">/Contents</span></code> array, containing the statement <code class="xref any docutils literal notranslate"><span class="pre">q</span> <span class="pre">/fzFrm&lt;n&gt;</span> <span class="pre">Do</span> <span class="pre">Q</span></code>.</p></li>
</ol>
</div></blockquote>
</li>
</ol>
</div></blockquote>
<p>This design approach ensures that:</p>
<ol class="arabic simple">
<li><p>The (potentially large) source page is only copied once to the target PDF. Only small “pointer” Form XObjects objects are created per each target page to show the source page.</p></li>
<li><p>Each referring target page can have its own <code class="xref any docutils literal notranslate"><span class="pre">&quot;oc&quot;</span></code> parameter to control the source page’s visibility individually.</p></li>
</ol>
</section>
</section>
<section id="diagnostics">
<span id="redirectmessages"></span><h2>Diagnostics<a class="headerlink" href="#diagnostics" title="Link to this heading">¶</a></h2>
<section id="pymupdf-messages">
<span id="messages"></span><h3><cite>PyMuPDF</cite> messages<a class="headerlink" href="#pymupdf-messages" title="Link to this heading">¶</a></h3>
<p><cite>PyMuPDF</cite> has a Message system for showing text diagnostics.</p>
<p>By default messages are written to <code class="xref any docutils literal notranslate"><span class="pre">sys.stdout</span></code>. This can be controlled in
two ways:</p>
<ul class="simple">
<li><p>Set environment variable <a class="reference internal" href="functions.html#PYMUPDF_MESSAGE" title="PYMUPDF_MESSAGE"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">PYMUPDF_MESSAGE</span></code></a> before <cite>PyMuPDF</cite> is imported.</p></li>
<li><p>Call <a class="reference internal" href="functions.html#set_messages" title="set_messages"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">set_messages()</span></code></a>:</p></li>
</ul>
</section>
<section id="mupdf-errors-and-warnings">
<h3>MuPDF errors and warnings<a class="headerlink" href="#mupdf-errors-and-warnings" title="Link to this heading">¶</a></h3>
<p>MuPDF generates text errors and warnings.</p>
<ul class="simple">
<li><p>These errors and warnings are appended to an internal list, accessible with
<a class="reference internal" href="tools.html#Tools.mupdf_warnings" title="Tools.mupdf_warnings"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Tools.mupdf_warnings()</span></code></a>. Also see <a class="reference internal" href="tools.html#Tools.reset_mupdf_warnings" title="Tools.reset_mupdf_warnings"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Tools.reset_mupdf_warnings()</span></code></a>.</p></li>
<li><p>By default these errors and warnings are also sent to the <cite>PyMuPDF</cite> message
system.</p>
<ul>
<li><p>This can be controlled with <a class="reference internal" href="tools.html#Tools.mupdf_display_errors" title="Tools.mupdf_display_errors"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">mupdf_display_errors()</span></code></a> and
<a class="reference internal" href="tools.html#Tools.mupdf_display_warnings" title="Tools.mupdf_display_warnings"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">mupdf_display_warnings()</span></code></a>.</p></li>
<li><p>These messages are prefixed with <code class="xref any docutils literal notranslate"><span class="pre">MuPDF</span> <span class="pre">error:</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">MuPDF</span> <span class="pre">warning:</span></code>
respectively.</p></li>
</ul>
</li>
</ul>
<p>Some MuPDF errors may lead to Python exceptions.</p>
<p>Example output for a <strong>recoverable error</strong>. We are opening a damaged PDF, but MuPDF is able to repair it and gives us a little information on what happened. Then we illustrate how to find out whether the document can later be saved incrementally. Checking the <a class="reference internal" href="document.html#Document.is_dirty" title="Document.is_dirty"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_dirty</span></code></a> attribute at this point also indicates that during <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.open</span></code> the document had to be repaired:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;damaged-file.pdf&quot;</span><span class="p">)</span>  <span class="c1"># leads to a sys.stderr message:</span>
<span class="go">mupdf: cannot find startxref</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">TOOLS</span><span class="o">.</span><span class="n">mupdf_warnings</span><span class="p">())</span>  <span class="c1"># check if there is more info:</span>
<span class="go">cannot find startxref</span>
<span class="go">trying to repair broken xref</span>
<span class="go">repairing PDF document</span>
<span class="go">object missing &#39;endobj&#39; token</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">can_save_incrementally</span><span class="p">()</span>  <span class="c1"># this is to be expected:</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the following indicates whether there are updates so far</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># this is the case because of the repair actions:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">is_dirty</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the document has nevertheless been created:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span>
<span class="go">pymupdf.Document(&#39;damaged-file.pdf&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we now know that any save must occur to a new file</span>
</pre></div>
</div>
<p>Example output for an <strong>unrecoverable error</strong>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;does-not-exist.pdf&quot;</span><span class="p">)</span>
<span class="go">mupdf: cannot open does-not-exist.pdf: No such file or directory</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;pyshell#1&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="w">    </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;does-not-exist.pdf&quot;</span><span class="p">)</span>
  File <span class="nb">&quot;C:\Users\Jorj\AppData\Local\Programs\Python\Python37\lib\site-packages\fitz\pymupdf.py&quot;</span>, line <span class="m">2200</span>, in <span class="n">__init__</span>
<span class="w">    </span><span class="n">_pymupdf</span><span class="o">.</span><span class="n">Document_swiginit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_pymupdf</span><span class="o">.</span><span class="n">new_Document</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">filetype</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">))</span>
<span class="gr">RuntimeError</span>: <span class="n">cannot open does-not-exist.pdf: No such file or directory</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="coordinates">
<span id="id2"></span><h2>Coordinates<a class="headerlink" href="#coordinates" title="Link to this heading">¶</a></h2>
<p>This is one of the most frequently used terms in this documentation. A <strong>coordinate</strong> generally means a pair of numbers <code class="xref any docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> referring to some location, like a corner of a rectangle (<a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>), a <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a> and so forth. The two values usually are floats, but there a objects like images which only allow them to be integers.</p>
<p>To actually <em>find</em> a coordinate’s location, we also need to know the <em>reference</em> point for <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> - in other words, we must know where location <code class="xref any docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code> is positioned. Once <code class="xref any docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code> (the “origin”) is known, we speak of a “coordinate system”.</p>
<p>Several coordinate systems exist in document processing. For instance, the coordinate systems of a PDF page and the image created from it are <strong>different</strong>. We therefore need ways to <em>transform</em> coordinates from one system to another (and also back occasionally). This is the task of a <a class="reference internal" href="matrix.html#matrix"><span class="std std-ref">Matrix</span></a>. It is a mathematical function which works much like a factor that can be “multiplied” with a point or rectangle to give us the corresponding point / rectangle in another coordinate system. The inverse of a transformation matrix can be used to revert the transformation. Much like multiplying by some factor, say 3, can be reverted by dividing the result by 3 (or multiplying it with 1/3).</p>
<section id="coordinates-and-images">
<h3>Coordinates and Images<a class="headerlink" href="#coordinates-and-images" title="Link to this heading">¶</a></h3>
<p>Images have a coordinate system with integer coordinates. Origin <code class="xref any docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code> is the top-left point. <code class="docutils literal notranslate"><span class="pre">x</span></code> values must be in <code class="xref any docutils literal notranslate"><span class="pre">range(width)</span></code>, and <code class="docutils literal notranslate"><span class="pre">y</span></code> values in <code class="xref any docutils literal notranslate"><span class="pre">range(height)</span></code>. Therefore, <code class="docutils literal notranslate"><span class="pre">y</span></code> values <em>increase</em> if we go <em>downwards</em>. For every image, there is only a <strong>finite number</strong> of coordinates, namely <code class="xref any docutils literal notranslate"><span class="pre">width</span> <span class="pre">*</span> <span class="pre">height</span></code>. A location in an image is also called a “pixel”.</p>
<ul class="simple">
<li><p>How <strong>large</strong> an image will be (in centimeters or inches) when e.g. printed, depends on additional information: the “resolution”. This is measured in <strong>DPI</strong> (dots per inch, or pixels per inch). To find the printed size of some image, we therefore must divide its width and its height by the corresponding DPI values (there may separate ones for width and for height) and will get the respective number of inches.</p></li>
</ul>
</section>
<section id="origin-point-point-size-and-y-axis">
<h3>Origin Point, Point Size and Y-Axis<a class="headerlink" href="#origin-point-point-size-and-y-axis" title="Link to this heading">¶</a></h3>
<p>In <strong>PDF</strong>, the origin <code class="xref any docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code> of a page is located at its <strong>bottom-left point</strong>. In <strong>MuPDF</strong>, the origin <code class="xref any docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code> of a page is located at its <strong>top-left point</strong>.</p>
<img alt="_images/img-coordinate-space.png" src="_images/img-coordinate-space.png" />
<p>Coordinates are float numbers and measured in <strong>points</strong>, where:</p>
<ul class="simple">
<li><p><strong>one point equals 1/72 inches</strong>.</p></li>
</ul>
<p>Typical document page sizes are <strong>ISO A4</strong> and <strong>Letter</strong>. A <strong>Letter</strong> page has a size of <strong>8.5 x 11 inches</strong>, corresponding to <strong>612 x 792 points</strong>. In the <strong>PDF</strong> coordinate system, the top-left point of a <strong>Letter</strong> page hence has the coordinate <code class="xref any docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">792)</span></code> as <strong>the y-axis points upwards</strong>. Now we know our document size the <strong>MuPDF</strong> coordinate system for the bottom right would be coordinate <code class="xref any docutils literal notranslate"><span class="pre">(612,</span> <span class="pre">792)</span></code> (and for <strong>PDF</strong> this coordinate would then be <code class="xref any docutils literal notranslate"><span class="pre">(612,0)</span></code>).</p>
<ul>
<li><p>Theoretically, there are <strong>infinitely many</strong> coordinate positions on a <strong>PDF</strong> page. In practice however, at most the first 5 decimal places are sufficient for a reasonable precision.</p></li>
<li><p>In <strong>MuPDF</strong>, multiple document formats are supported - <strong>PDF</strong> just being one among <strong>over a dozen others</strong>. Images are also supported as documents in <strong>MuPDF</strong> (therefore having one page usually). This is one of the reasons why <strong>MuPDF</strong> uses a coordinate system with the origin <code class="xref any docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code> being the <strong>top-left</strong> point of any document page. <strong>The y-axis points downwards</strong>, like with images. Coordinates in <strong>MuPDF</strong> in any case are floats, like in <strong>PDF</strong>.</p></li>
<li><p>A rectangle <code class="xref any docutils literal notranslate"><span class="pre">Rect(0,</span> <span class="pre">0,</span> <span class="pre">100,</span> <span class="pre">100)</span></code> for instance in <strong>MuPDF</strong> (and thus <strong>PyMuPDF</strong>) therefore is a square with edges of length 100 points (= 1.39 inches or 3.53 centimeters). Its top-left corner is the origin. To switch between the two coordinate systems <strong>PDF</strong> to <strong>MuPDF</strong>, every <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> object has a <a class="reference internal" href="page.html#Page.transformation_matrix" title="Page.transformation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.transformation_matrix</span></code></a>. Its inverse can be used to compute a rectangle’s PDF coordinates. In this way we can conveniently find that <code class="xref any docutils literal notranslate"><span class="pre">Rect(0,</span> <span class="pre">0,</span> <span class="pre">100,</span> <span class="pre">100)</span></code> in <strong>MuPDF</strong> is the same as <code class="xref any docutils literal notranslate"><span class="pre">Rect(0,</span> <span class="pre">692,</span> <span class="pre">100,</span> <span class="pre">792)</span></code> in <strong>PDF</strong>. See this code snippet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">612</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">792</span><span class="p">)</span>  <span class="c1"># make new Letter page</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ptm</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">transformation_matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the inverse matrix of ptm is ~ptm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="o">~</span><span class="n">ptm</span>
<span class="go">Rect(0.0, 692.0, 100.0, 792.0)</span>
</pre></div>
</div>
</li>
</ul>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="f1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>MuPDF supports “deep-copying” objects between PDF documents. To avoid duplicate data in the target, it uses so-called “graftmaps”, like a form of scratchpad: for each object to be copied, its <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> number is looked up in the graftmap. If found, copying is skipped. Otherwise, the new <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> is recorded and the copy takes place. PyMuPDF makes use of this technique in two places so far: <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a> and <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>. This process is fast and very efficient, because it prevents multiple copies of typically large and frequently referenced data, like images and fonts. However, you may still want to consider using garbage collection (option 4) in any of the following cases:</p>
<ol class="arabic simple">
<li><p>The target PDF is not new / empty: grafting does not check for resources that already existed (e.g. images, fonts) in the target document before opening it.</p></li>
<li><p>Using <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> for more than one source document: each grafting occurs <strong>within one source</strong> PDF only, not across multiple. So if e.g. the same image exists in pages from different source PDFs, then this will not be detected until garbage collection.</p></li>
</ol>
</aside>
</aside>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>Do you have any feedback on this page?</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.3.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="app4.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Appendix 4: Performance Comparison Methodology</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="app2.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Appendix 2: Considerations on Embedded Files</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 10. Mar 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Appendix 3: Assorted Technical Information</a><ul>
<li><a class="reference internal" href="#image-transformation-matrix">Image Transformation Matrix</a></li>
<li><a class="reference internal" href="#pdf-base-14-fonts">PDF Base 14 Fonts</a></li>
<li><a class="reference internal" href="#adobe-pdf-references">Adobe PDF References</a></li>
<li><a class="reference internal" href="#using-python-sequences-as-arguments-in-pymupdf">Using Python Sequences as Arguments in PyMuPDF</a></li>
<li><a class="reference internal" href="#ensuring-consistency-of-important-objects-in-pymupdf">Ensuring Consistency of Important Objects in PyMuPDF</a></li>
<li><a class="reference internal" href="#design-of-method-page-show-pdf-page">Design of Method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a><ul>
<li><a class="reference internal" href="#purpose-and-capabilities">Purpose and Capabilities</a></li>
<li><a class="reference internal" href="#technical-implementation">Technical Implementation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#diagnostics">Diagnostics</a><ul>
<li><a class="reference internal" href="#pymupdf-messages"><cite>PyMuPDF</cite> messages</a></li>
<li><a class="reference internal" href="#mupdf-errors-and-warnings">MuPDF errors and warnings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coordinates">Coordinates</a><ul>
<li><a class="reference internal" href="#coordinates-and-images">Coordinates and Images</a></li>
<li><a class="reference internal" href="#origin-point-point-size-and-y-axis">Origin Point, Point Size and Y-Axis</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=9ddcf537"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    </body>
</html>