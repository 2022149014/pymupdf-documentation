<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF is a high-performance Python library for data extraction, analysis, conversion &amp; manipulation of PDF (and other) documents." name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="About these documents" href="about.html" /><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Annotations" href="recipes-annotations.html" /><link rel="prev" title="Text" href="recipes-text.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Images - PyMuPDF 1.25.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=74643500" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.3 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.3 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">Features Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#performance">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#license-and-copyright">License and Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">The Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF, LLM &amp; RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">Opening Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">Text</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">Annotations</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">Drawing and Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">Stories</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">Journalling</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">Multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - Optical Character Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">Optional Content Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">Low-Level Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">Common Issues and their Solutions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module.html">Command line interface</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="classes.html">Classes</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">Operator Algebra for Geometry Objects</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">Low Level Functions and Classes</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Low Level Functions and Classes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">Working together: DisplayList and TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">Constants and Enumerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">Color Database</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app1.html">Appendix 1: Details on Text Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">Appendix 2: Considerations on Embedded Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">Appendix 3: Assorted Technical Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">Appendix 4: Performance Comparison Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">Deprecated Names</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/recipes-images.rst" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <style>

    #languageToggle {
        width:25%;
        margin:8px 10px 0;
    }

    #button-select-en {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 10px 0 0 10px;
        font-size: 14px;
    }

    #button-select-ja {
        padding: 5px 10px;
        background-color: #fff;
        border: 1px solid #000;
        border-radius: 0px 10px 10px 0;
        border-left: 0;
        font-size: 14px;
    }

    #button-select-en , #button-select-ja, #button-select-en:hover , #button-select-ja:hover  {
        color: #fff;
        text-decoration: none;
    }

    /* small screens */
    @media all and (max-width : 768px)  {
        #languageToggle {
            width:50%;
        }
    }

    @media all and (max-width : 400px)  {
        #languageToggle {
            width:70%;
        }
    }

    @media all and (max-width : 375px)  {
        #button-select-en , #button-select-ja {
            font-size: 11px;
        }
    }

</style>

<div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
    <div id="languageToggle"><span><a id="button-select-en" href="javaScript:changeLanguage('en')">English</a></span><span><a id="button-select-ja" href="javaScript:changeLanguage('ja')">日本語</a></span></div>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

    <div class="feedbackLink"><a id="feedbackLinkTop" target=_blank>Do you have any feedback on this page?</b></a></div>
</div>

<script>
    // highlightSelectedLanguage

    if (document.getElementsByTagName('html')[0].getAttribute('lang')=="ja") {
        document.getElementById("button-select-ja").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-en").style.color = "#000";
    } else {
        document.getElementById("button-select-en").style.backgroundColor = "#ff6600";
        document.getElementById("button-select-ja").style.color = "#000";
    }


    var url_string = window.location.href;
    var a = document.getElementById('feedbackLinkTop');
    a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=header-link&url="+url_string);

    function changeLanguage(lang) {
        var new_url;

        if (lang == "en") {
            new_url = url_string.replace("/ja/", "/en/");
        } else {
            new_url = url_string.replace("/en/", "/ja/");
        }

        window.location.replace(new_url);
    }

</script><section id="images">
<span id="recipesimages"></span><h1>Images<a class="headerlink" href="#images" title="Link to this heading">¶</a></h1>
<section id="how-to-make-images-from-document-pages">
<span id="recipesimages-a"></span><h2>How to Make Images from Document Pages<a class="headerlink" href="#how-to-make-images-from-document-pages" title="Link to this heading">¶</a></h2>
<p>This little script will take a document filename and generate a PNG file from each of its pages.</p>
<p>The document can be any <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">supported type</span></a>.</p>
<p>The script works as a command line tool which expects the filename being supplied as a parameter. The generated image files (1 per page) are stored in the directory of the script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">pymupdf</span>  <span class="c1"># import the bindings</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># get filename from command line</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>  <span class="c1"># open document</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>  <span class="c1"># iterate through the pages</span>
    <span class="n">pix</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_pixmap</span><span class="p">()</span>  <span class="c1"># render page to an image</span>
    <span class="n">pix</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;page-</span><span class="si">%i</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="n">page</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>  <span class="c1"># store image as a PNG</span>
</pre></div>
</div>
<p>The script directory will now contain PNG image files named <em>page-0.png</em>, <em>page-1.png</em>, etc. Pictures have the dimension of their pages with width and height rounded to integers, e.g. 595 x 842 pixels for an A4 portrait sized page. They will have a resolution of 96 dpi in x and y dimension and have no transparency. You can change all that – for how to do this, read the next sections.</p>
<hr class="docutils" />
</section>
<section id="how-to-increase-image-resolution">
<span id="recipesimages-b"></span><h2>How to Increase <span class="target" id="index-0"></span>Image Resolution<a class="headerlink" href="#how-to-increase-image-resolution" title="Link to this heading">¶</a></h2>
<p>The image of a document page is represented by a <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a>, and the simplest way to create a pixmap is via method <a class="reference internal" href="page.html#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a>.</p>
<p>This method has many options to influence the result. The most important among them is the <a class="reference internal" href="matrix.html#matrix"><span class="std std-ref">Matrix</span></a>, which lets you <span class="target" id="index-1"></span>zoom, rotate, distort or mirror the outcome.</p>
<p><a class="reference internal" href="page.html#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a> by default will use the <a class="reference internal" href="identity.html#identity"><span class="std std-ref">Identity</span></a> matrix, which does nothing.</p>
<p>In the following, we apply a <span class="target" id="index-2"></span>zoom factor of 2 to each dimension, which will generate an image with a four times better resolution for us (and also about 4 times the size):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">zoom_x</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># horizontal zoom</span>
<span class="n">zoom_y</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># vertical zoom</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">zoom_x</span><span class="p">,</span> <span class="n">zoom_y</span><span class="p">)</span>  <span class="c1"># zoom factor 2 in each dimension</span>
<span class="n">pix</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_pixmap</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">mat</span><span class="p">)</span>  <span class="c1"># use &#39;mat&#39; instead of the identity matrix</span>
</pre></div>
</div>
<p>Since version 1.19.2 there is a more direct way to set the resolution: Parameter <code class="xref any docutils literal notranslate"><span class="pre">&quot;dpi&quot;</span></code> (dots per inch) can be used in place of <code class="xref any docutils literal notranslate"><span class="pre">&quot;matrix&quot;</span></code>. To create a 300 dpi image of a page specify <code class="xref any docutils literal notranslate"><span class="pre">pix</span> <span class="pre">=</span> <span class="pre">page.get_pixmap(dpi=300)</span></code>. Apart from notation brevity, this approach has the additional advantage that the <strong>dpi value is saved with the image</strong> file – which does not happen automatically when using the Matrix notation.</p>
<hr class="docutils" />
</section>
<section id="how-to-create-partial-pixmaps-clips">
<span id="recipesimages-c"></span><h2>How to Create <span class="target" id="index-3"></span>Partial Pixmaps (Clips)<a class="headerlink" href="#how-to-create-partial-pixmaps-clips" title="Link to this heading">¶</a></h2>
<p>You do not always need or want the full image of a page. This is the case e.g. when you display the image in a GUI and would like to fill the respective window with a zoomed part of the page.</p>
<p>Let’s assume your GUI window has room to display a full document page, but you now want to fill this room with the bottom right quarter of your page, thus using a four times better resolution.</p>
<p>To achieve this, define a rectangle equal to the area you want to appear in the GUI and call it “clip”. One way of constructing rectangles in PyMuPDF is by providing two diagonally opposite corners, which is what we are doing here.</p>
<a class="reference internal image-reference" href="_images/img-clip.jpg"><img alt="_images/img-clip.jpg" src="_images/img-clip.jpg" style="width: 50%;" />
</a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mat</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># zoom factor 2 in each direction</span>
<span class="n">rect</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">rect</span>  <span class="c1"># the page rectangle</span>
<span class="n">mp</span> <span class="o">=</span> <span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">tl</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="n">br</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># its middle point, becomes top-left of clip</span>
<span class="n">clip</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span> <span class="n">rect</span><span class="o">.</span><span class="n">br</span><span class="p">)</span>  <span class="c1"># the area we want</span>
<span class="n">pix</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_pixmap</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">mat</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="n">clip</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above we construct <em>clip</em> by specifying two diagonally opposite points: the middle point <em>mp</em> of the page rectangle, and its bottom right, <em>rect.br</em>.</p>
<hr class="docutils" />
</section>
<section id="how-to-zoom-a-clip-to-a-gui-window">
<span id="recipesimages-d"></span><h2>How to Zoom a Clip to a GUI Window<a class="headerlink" href="#how-to-zoom-a-clip-to-a-gui-window" title="Link to this heading">¶</a></h2>
<p>Please also read the previous section. This time we want to <strong>compute the zoom factor</strong> for a clip, such that its image best fits a given GUI window. This means, that the image’s width or height (or both) will equal the window dimension. For the following code snippet you need to provide the WIDTH and HEIGHT of your GUI’s window that should receive the page’s clip rectangle.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># WIDTH: width of the GUI window</span>
<span class="c1"># HEIGHT: height of the GUI window</span>
<span class="c1"># clip: a subrectangle of the document page</span>
<span class="c1"># compare width/height ratios of image and window</span>

<span class="k">if</span> <span class="n">clip</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="n">clip</span><span class="o">.</span><span class="n">height</span> <span class="o">&lt;</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="n">HEIGHT</span><span class="p">:</span>
    <span class="c1"># clip is narrower: zoom to window HEIGHT</span>
    <span class="n">zoom</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">/</span> <span class="n">clip</span><span class="o">.</span><span class="n">height</span>
<span class="k">else</span><span class="p">:</span>  <span class="c1"># clip is broader: zoom to window WIDTH</span>
    <span class="n">zoom</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="n">clip</span><span class="o">.</span><span class="n">width</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">zoom</span><span class="p">,</span> <span class="n">zoom</span><span class="p">)</span>
<span class="n">pix</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_pixmap</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">mat</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="n">clip</span><span class="p">)</span>
</pre></div>
</div>
<p>For the other way round, now assume you <strong>have</strong> the zoom factor and need to <strong>compute the fitting clip</strong>.</p>
<p>In this case we have <code class="xref any docutils literal notranslate"><span class="pre">zoom</span> <span class="pre">=</span> <span class="pre">HEIGHT/clip.height</span> <span class="pre">=</span> <span class="pre">WIDTH/clip.width</span></code>, so we must set <code class="xref any docutils literal notranslate"><span class="pre">clip.height</span> <span class="pre">=</span> <span class="pre">HEIGHT/zoom</span></code> and, <code class="xref any docutils literal notranslate"><span class="pre">clip.width</span> <span class="pre">=</span> <span class="pre">WIDTH/zoom</span></code>. Choose the top-left point <a class="reference internal" href="irect.html#IRect.tl" title="IRect.tl"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">tl</span></code></a> of the clip on the page to compute the right pixmap:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">width</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">/</span> <span class="n">zoom</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">HEIGHT</span> <span class="o">/</span> <span class="n">zoom</span>
<span class="n">clip</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">tl</span><span class="p">,</span> <span class="n">tl</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">tl</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">height</span><span class="p">)</span>
<span class="c1"># ensure we still are inside the page</span>
<span class="n">clip</span> <span class="o">&amp;=</span> <span class="n">page</span><span class="o">.</span><span class="n">rect</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">zoom</span><span class="p">,</span> <span class="n">zoom</span><span class="p">)</span>
<span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">mat</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="n">clip</span><span class="p">)</span>
</pre></div>
</div>
<hr class="docutils" />
</section>
<section id="how-to-create-or-suppress-annotation-images">
<span id="recipesimages-e"></span><h2>How to Create or Suppress Annotation Images<a class="headerlink" href="#how-to-create-or-suppress-annotation-images" title="Link to this heading">¶</a></h2>
<p>Normally, the pixmap of a page also shows the page’s annotations. Occasionally, this may not be desirable.</p>
<p>To suppress the annotation images on a rendered page, just specify <code class="xref any docutils literal notranslate"><span class="pre">annots=False</span></code> in <a class="reference internal" href="page.html#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a>.</p>
<p>You can also render annotations separately: they have their own <a class="reference internal" href="annot.html#Annot.get_pixmap" title="Annot.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.get_pixmap()</span></code></a> method. The resulting pixmap has the same dimensions as the annotation rectangle.</p>
<hr class="docutils" />
</section>
<section id="how-to-extract-images-non-pdf-documents">
<span id="recipesimages-f"></span><span id="index-4"></span><h2>How to Extract Images: Non-PDF Documents<a class="headerlink" href="#how-to-extract-images-non-pdf-documents" title="Link to this heading">¶</a></h2>
<p>In contrast to the previous sections, this section deals with <strong>extracting</strong> images <strong>contained</strong> in documents, so they can be displayed as part of one or more pages.</p>
<p>If you want to recreate the original image in file form or as a memory area, you have basically two options:</p>
<ol class="arabic">
<li><p>Convert your document to a PDF, and then use one of the PDF-only extraction methods. This snippet will convert a document to PDF:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pdfbytes</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">convert_to_pdf</span><span class="p">()</span>  <span class="c1"># this a bytes object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">pdfbytes</span><span class="p">)</span>  <span class="c1"># open it as a PDF document</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># now use &#39;pdf&#39; like any PDF document</span>
</pre></div>
</div>
</li>
<li><p>Use <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> with the “dict” parameter. This works for all document types. It will extract all text and images shown on the page, formatted as a Python dictionary. Every image will occur in an image block, containing meta information and <strong>the binary image data</strong>. For details of the dictionary’s structure, see <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a>. The method works equally well for PDF files. This creates a list of all images shown on a page:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="s2">&quot;dict&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blocks</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;blocks&quot;</span><span class="p">]</span>  <span class="c1"># the list of block dictionaries</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgblocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">blocks</span> <span class="k">if</span> <span class="n">b</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">imgblocks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">{&#39;bbox&#39;: (100.0, 135.8769989013672, 300.0, 364.1230163574219),</span>
<span class="go"> &#39;bpc&#39;: 8,</span>
<span class="go"> &#39;colorspace&#39;: 3,</span>
<span class="go"> &#39;ext&#39;: &#39;jpeg&#39;,</span>
<span class="go"> &#39;height&#39;: 501,</span>
<span class="go"> &#39;image&#39;: b&#39;\xff\xd8\xff\xe0\x00\x10JFIF\...&#39;,  # CAUTION: LARGE!</span>
<span class="go"> &#39;size&#39;: 80518,</span>
<span class="go"> &#39;transform&#39;: (200.0, 0.0, -0.0, 228.2460174560547, 100.0, 135.8769989013672),</span>
<span class="go"> &#39;type&#39;: 1,</span>
<span class="go"> &#39;width&#39;: 439,</span>
<span class="go"> &#39;xres&#39;: 96,</span>
<span class="go"> &#39;yres&#39;: 96}</span>
</pre></div>
</div>
</li>
</ol>
<hr class="docutils" />
</section>
<section id="how-to-extract-images-pdf-documents">
<span id="recipesimages-g"></span><span id="index-5"></span><h2>How to Extract Images: PDF Documents<a class="headerlink" href="#how-to-extract-images-pdf-documents" title="Link to this heading">¶</a></h2>
<p>Like any other “object” in a PDF, images are identified by a cross reference number (<a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>, an integer). If you know this number, you have two ways to access the image’s data:</p>
<ol class="arabic simple">
<li><p><strong>Create</strong> a <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> of the image with instruction <em>pix = pymupdf.Pixmap(doc, xref)</em>. This method is <strong>very</strong> fast (single digit micro-seconds). The pixmap’s properties (width, height, …) will reflect the ones of the image. In this case there is no way to tell which image format the embedded original has.</p></li>
<li><p><strong>Extract</strong> the image with <em>img = doc.extract_image(xref)</em>. This is a dictionary containing the binary image data as <em>img[“image”]</em>. A number of meta data are also provided – mostly the same as you would find in the pixmap of the image. The major difference is string <em>img[“ext”]</em>, which specifies the image format: apart from “png”, strings like “jpeg”, “bmp”, “tiff”, etc. can also occur. Use this string as the file extension if you want to store to disk. The execution speed of this method should be compared to the combined speed of the statements <em>pix = pymupdf.Pixmap(doc, xref);pix.tobytes()</em>. If the embedded image is in PNG format, the speed of <a class="reference internal" href="document.html#Document.extract_image" title="Document.extract_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extract_image()</span></code></a> is about the same (and the binary image data are identical). Otherwise, this method is <strong>thousands of times faster</strong>, and the <strong>image data is much smaller</strong>.</p></li>
</ol>
<p>The question remains: <strong>“How do I know those ‘xref’ numbers of images?”</strong>. There are two answers to this:</p>
<ol class="loweralpha simple">
<li><p><strong>“Inspect the page objects:”</strong> Loop through the items of <a class="reference internal" href="page.html#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a>. It is a list of list, and its items look like <em>[xref, smask, …]</em>, containing the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of an image. This <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> can then be used with one of the above methods. Use this method for <strong>valid (undamaged)</strong> documents. Be wary however, that the same image may be referenced multiple times (by different pages), so you might want to provide a mechanism avoiding multiple extracts.</p></li>
<li><p><strong>“No need to know:”</strong> Loop through the list of <strong>all xrefs</strong> of the document and perform a <a class="reference internal" href="document.html#Document.extract_image" title="Document.extract_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extract_image()</span></code></a> for each one. If the returned dictionary is empty, then continue – this <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> is no image. Use this method if the PDF is <strong>damaged (unusable pages)</strong>. Note that a PDF often contains “pseudo-images” (“stencil masks”) with the special purpose of defining the transparency of some other image. You may want to provide logic to exclude those from extraction. Also have a look at the next section.</p></li>
</ol>
<p>For both extraction approaches, there exist ready-to-use general purpose scripts:</p>
<p><a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/extract-images/extract-from-pages.py">extract-from-pages.py</a> extracts images page by page:</p>
<a class="reference internal image-reference" href="_images/img-extract-imga.jpg"><img alt="_images/img-extract-imga.jpg" src="_images/img-extract-imga.jpg" style="width: 263.2px; height: 228.8px;" />
</a>
<p>and <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/extract-images/extract-from-xref.py">extract-from-xref.py</a> extracts images by xref table:</p>
<a class="reference internal image-reference" href="_images/img-extract-imgb.jpg"><img alt="_images/img-extract-imgb.jpg" src="_images/img-extract-imgb.jpg" style="width: 262.40000000000003px; height: 229.60000000000002px;" />
</a>
<hr class="docutils" />
</section>
<section id="how-to-handle-image-masks">
<span id="recipesimages-h"></span><h2>How to Handle Image Masks<a class="headerlink" href="#how-to-handle-image-masks" title="Link to this heading">¶</a></h2>
<p>Some images in PDFs are accompanied by <strong>image masks</strong>. In their simplest form, masks represent alpha (transparency) bytes stored as separate images. In order to reconstruct the original of an image, which has a mask, it must be “enriched” with transparency bytes taken from its mask.</p>
<p>Whether an image does have such a mask can be recognized in one of two ways in PyMuPDF:</p>
<ol class="arabic simple">
<li><p>An item of <a class="reference internal" href="document.html#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a> has the general format <code class="xref any docutils literal notranslate"><span class="pre">(xref,</span> <span class="pre">smask,</span> <span class="pre">...)</span></code>, where <em>xref</em> is the image’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> and <em>smask</em>, if positive, then it is the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of a mask.</p></li>
<li><p>The (dictionary) results of <a class="reference internal" href="document.html#Document.extract_image" title="Document.extract_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extract_image()</span></code></a> have a key <em>“smask”</em>, which also contains any mask’s <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> if positive.</p></li>
</ol>
<p>If <em>smask == 0</em> then the image encountered via <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> can be processed as it is.</p>
<p>To recover the original image using PyMuPDF, the procedure depicted as follows must be executed:</p>
<a class="reference internal image-reference" href="_images/img-stencil.jpg"><img alt="_images/img-stencil.jpg" src="_images/img-stencil.jpg" style="width: 394.8px; height: 203.4px;" />
</a>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pix1</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">extract_image</span><span class="p">(</span><span class="n">xref</span><span class="p">)[</span><span class="s2">&quot;image&quot;</span><span class="p">])</span>    <span class="c1"># (1) pixmap of image w/o alpha</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">extract_image</span><span class="p">(</span><span class="n">smask</span><span class="p">)[</span><span class="s2">&quot;image&quot;</span><span class="p">])</span>   <span class="c1"># (2) mask pixmap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">pix1</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>                           <span class="c1"># (3) copy of pix1, image mask added</span>
</pre></div>
</div>
<p>Step (1) creates a pixmap of the basic image. Step (2) does the same with the image mask. Step (3) adds an alpha channel and fills it with transparency information.</p>
<p>The scripts <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/extract-images/extract-from-pages.py">extract-from-pages.py</a>, and <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/extract-images/extract-from-xref.py">extract-from-xref.py</a> above also contain this logic.</p>
<hr class="docutils" />
</section>
<section id="how-to-make-one-pdf-of-all-your-pictures-or-files">
<span id="recipesimages-i"></span><span id="index-6"></span><h2>How to Make one PDF of all your Pictures (or Files)<a class="headerlink" href="#how-to-make-one-pdf-of-all-your-pictures-or-files" title="Link to this heading">¶</a></h2>
<p>We show here <strong>three scripts</strong> that take a list of (image and other) files and put them all in one PDF.</p>
<p><strong>Method 1: Inserting Images as Pages</strong></p>
<p>The first one converts each image to a PDF page with the same dimensions. The result will be a PDF with one page per image. It will only work for <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">supported image</span></a> file formats:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">pymupdf</span>
<span class="kn">import</span> <span class="nn">PySimpleGUI</span> <span class="k">as</span> <span class="nn">psg</span>  <span class="c1"># for showing a progress bar</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>  <span class="c1"># PDF with the pictures</span>
<span class="n">imgdir</span> <span class="o">=</span> <span class="s2">&quot;D:/2012_10_05&quot;</span>  <span class="c1"># where the pics are</span>
<span class="n">imglist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">imgdir</span><span class="p">)</span>  <span class="c1"># list of them</span>
<span class="n">imgcount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">imglist</span><span class="p">)</span>  <span class="c1"># pic count</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">imglist</span><span class="p">):</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">imgdir</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>  <span class="c1"># open pic as document</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rect</span>  <span class="c1"># pic dimension</span>
    <span class="n">pdfbytes</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">convert_to_pdf</span><span class="p">()</span>  <span class="c1"># make a PDF stream</span>
    <span class="n">img</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># no longer needed</span>
    <span class="n">imgPDF</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">pdfbytes</span><span class="p">)</span>  <span class="c1"># open stream as PDF</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>  <span class="c1"># new page with ...</span>
                       <span class="n">height</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>  <span class="c1"># pic dimension</span>
    <span class="n">page</span><span class="o">.</span><span class="n">show_pdf_page</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="n">imgPDF</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># image fills the page</span>
    <span class="n">psg</span><span class="o">.</span><span class="n">EasyProgressMeter</span><span class="p">(</span><span class="s2">&quot;Import Images&quot;</span><span class="p">,</span>  <span class="c1"># show our progress</span>
        <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">imgcount</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;all-my-pics.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will generate a PDF only marginally larger than the combined pictures’ size. Some numbers on performance:</p>
<p>The above script needed about 1 minute on my machine for 149 pictures with a total size of 514 MB (and about the same resulting PDF size).</p>
<a class="reference internal image-reference" href="_images/img-import-progress.jpg"><img alt="_images/img-import-progress.jpg" src="_images/img-import-progress.jpg" style="width: 264.0px; height: 217.60000000000002px;" />
</a>
<p>Look <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/insert-images/insert.py">here</a> for a more complete source code: it offers a directory selection dialog and skips unsupported files and non-file entries.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We might have used <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> instead of <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>, and the result would have been a similar looking file. However, depending on the image type, it may store <strong>images uncompressed</strong>. Therefore, the save option <em>deflate = True</em> must be used to achieve a reasonable file size, which hugely increases the runtime for large numbers of images. So this alternative <strong>cannot be recommended</strong> here.</p>
</div>
<p><strong>Method 2: Embedding Files</strong></p>
<p>The second script <strong>embeds</strong> arbitrary files – not only images. The resulting PDF will have just one (empty) page, required for technical reasons. To later access the embedded files again, you would need a suitable PDF viewer that can display and / or extract embedded files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">pymupdf</span>
<span class="kn">import</span> <span class="nn">PySimpleGUI</span> <span class="k">as</span> <span class="nn">psg</span>  <span class="c1"># for showing progress bar</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>  <span class="c1"># PDF with the pictures</span>
<span class="n">imgdir</span> <span class="o">=</span> <span class="s2">&quot;D:/2012_10_05&quot;</span>  <span class="c1"># where my files are</span>

<span class="n">imglist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">imgdir</span><span class="p">)</span>  <span class="c1"># list of pictures</span>
<span class="n">imgcount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">imglist</span><span class="p">)</span>  <span class="c1"># pic count</span>
<span class="n">imglist</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>  <span class="c1"># nicely sort them</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">imglist</span><span class="p">):</span>
    <span class="n">img</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">imgdir</span><span class="p">,</span><span class="n">f</span><span class="p">),</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># make pic stream</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">embfile_add</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">f</span><span class="p">,</span>  <span class="c1"># and embed it</span>
                        <span class="n">ufilename</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
    <span class="n">psg</span><span class="o">.</span><span class="n">EasyProgressMeter</span><span class="p">(</span><span class="s2">&quot;Embedding Files&quot;</span><span class="p">,</span>  <span class="c1"># show our progress</span>
        <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">imgcount</span><span class="p">)</span>

<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>  <span class="c1"># at least 1 page is needed</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;all-my-pics-embedded.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/img-embed-progress.jpg"><img alt="_images/img-embed-progress.jpg" src="_images/img-embed-progress.jpg" style="width: 265.6px; height: 219.20000000000002px;" />
</a>
<p>This is by far the fastest method, and it also produces the smallest possible output file size. The above pictures needed 20 seconds on my machine and yielded a PDF size of 510 MB. Look <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/embed-images/embed.py">here</a> for a more complete source code: it offers a directory selection dialog and skips non-file entries.</p>
<p><strong>Method 3: Attaching Files</strong></p>
<p>A third way to achieve this task is <strong>attaching files</strong> via page annotations see <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/attach-images/attach.py">here</a> for the complete source code.</p>
<p>This has a similar performance as the previous script and it also produces a similar file size. It will produce PDF pages which show a ‘FileAttachment’ icon for each attached file.</p>
<img alt="_images/img-attach-result.jpg" src="_images/img-attach-result.jpg" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both, the <strong>embed</strong> and the <strong>attach</strong> methods can be used for <strong>arbitrary files</strong> – not just images.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We strongly recommend using the awesome package <a class="reference external" href="https://pypi.org/project/PySimpleGUI/">PySimpleGUI</a> to display a progress meter for tasks that may run for an extended time span. It’s pure Python, uses Tkinter (no additional GUI package) and requires just one more line of code!</p>
</div>
<hr class="docutils" />
</section>
<section id="how-to-create-vector-images">
<span id="recipesimages-j"></span><span id="index-7"></span><h2>How to Create Vector Images<a class="headerlink" href="#how-to-create-vector-images" title="Link to this heading">¶</a></h2>
<p>The usual way to create an image from a document page is <a class="reference internal" href="page.html#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a>. A pixmap represents a raster image, so you must decide on its quality (i.e. resolution) at creation time. It cannot be changed later.</p>
<p>PyMuPDF also offers a way to create a <strong>vector image</strong> of a page in SVG format (scalable vector graphics, defined in XML syntax). SVG images remain precise across zooming levels (of course with the exception of any raster graphic elements embedded therein).</p>
<p>Instruction <em>svg = page.get_svg_image(matrix=pymupdf.Identity)</em> delivers a UTF-8 string <em>svg</em> which can be stored with extension “.svg”.</p>
<hr class="docutils" />
</section>
<section id="how-to-convert-images">
<span id="recipesimages-k"></span><span id="index-8"></span><h2>How to Convert Images<a class="headerlink" href="#how-to-convert-images" title="Link to this heading">¶</a></h2>
<p>Just as a feature among others, PyMuPDF’s image conversion is easy. It may avoid using other graphics packages like PIL/Pillow in many cases.</p>
<p>Notwithstanding that interfacing with Pillow is almost trivial.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Input Formats</strong></p></th>
<th class="head"><p><strong>Output Formats</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BMP</p></td>
<td><p>.</p></td>
<td><p>Windows Bitmap</p></td>
</tr>
<tr class="row-odd"><td><p>JPEG</p></td>
<td><p>JPEG</p></td>
<td><p>Joint Photographic Experts Group</p></td>
</tr>
<tr class="row-even"><td><p>JXR</p></td>
<td><p>.</p></td>
<td><p>JPEG Extended Range</p></td>
</tr>
<tr class="row-odd"><td><p>JPX/JP2</p></td>
<td><p>.</p></td>
<td><p>JPEG 2000</p></td>
</tr>
<tr class="row-even"><td><p>GIF</p></td>
<td><p>.</p></td>
<td><p>Graphics Interchange Format</p></td>
</tr>
<tr class="row-odd"><td><p>TIFF</p></td>
<td><p>.</p></td>
<td><p>Tagged Image File Format</p></td>
</tr>
<tr class="row-even"><td><p>PNG</p></td>
<td><p>PNG</p></td>
<td><p>Portable Network Graphics</p></td>
</tr>
<tr class="row-odd"><td><p>PNM</p></td>
<td><p>PNM</p></td>
<td><p>Portable Anymap</p></td>
</tr>
<tr class="row-even"><td><p>PGM</p></td>
<td><p>PGM</p></td>
<td><p>Portable Graymap</p></td>
</tr>
<tr class="row-odd"><td><p>PBM</p></td>
<td><p>PBM</p></td>
<td><p>Portable Bitmap</p></td>
</tr>
<tr class="row-even"><td><p>PPM</p></td>
<td><p>PPM</p></td>
<td><p>Portable Pixmap</p></td>
</tr>
<tr class="row-odd"><td><p>PAM</p></td>
<td><p>PAM</p></td>
<td><p>Portable Arbitrary Map</p></td>
</tr>
<tr class="row-even"><td><p>.</p></td>
<td><p>PSD</p></td>
<td><p>Adobe Photoshop Document</p></td>
</tr>
<tr class="row-odd"><td><p>.</p></td>
<td><p>PS</p></td>
<td><p>Adobe Postscript</p></td>
</tr>
</tbody>
</table>
</div>
<p>The general scheme is just the following two lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="s2">&quot;input.xxx&quot;</span><span class="p">)</span>  <span class="c1"># any supported input format</span>
<span class="n">pix</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;output.yyy&quot;</span><span class="p">)</span>  <span class="c1"># any supported output format</span>
</pre></div>
</div>
<p><strong>Remarks</strong></p>
<ol class="arabic simple">
<li><p>The <strong>input</strong> argument of <em>pymupdf.Pixmap(arg)</em> can be a file or a bytes / io.BytesIO object containing an image.</p></li>
<li><p>Instead of an output <strong>file</strong>, you can also create a bytes object via <em>pix.tobytes(“yyy”)</em> and pass this around.</p></li>
<li><p>As a matter of course, input and output formats must be compatible in terms of colorspace and transparency. The <em>Pixmap</em> class has batteries included if adjustments are needed.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Convert JPEG to Photoshop</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="s2">&quot;myfamily.jpg&quot;</span><span class="p">)</span>
<span class="n">pix</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;myfamily.psd&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Convert <strong>JPEG to Tkinter PhotoImage</strong>. Any <strong>RGB / no-alpha</strong> image works exactly the same. Conversion to one of the <strong>Portable Anymap</strong> formats (PPM, PGM, etc.) does the trick, because they are supported by all Tkinter versions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="s2">&quot;input.jpg&quot;</span><span class="p">)</span>  <span class="c1"># or any RGB / no-alpha image</span>
<span class="n">tkimg</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pix</span><span class="o">.</span><span class="n">tobytes</span><span class="p">(</span><span class="s2">&quot;ppm&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Convert <strong>PNG with alpha</strong> to Tkinter PhotoImage. This requires <strong>removing the alpha bytes</strong>, before we can do the PPM conversion:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="s2">&quot;input.png&quot;</span><span class="p">)</span>  <span class="c1"># may have an alpha channel</span>
<span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span><span class="p">:</span>  <span class="c1"># we have an alpha channel!</span>
    <span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">pix</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># remove it</span>
<span class="n">tkimg</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pix</span><span class="o">.</span><span class="n">tobytes</span><span class="p">(</span><span class="s2">&quot;ppm&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="how-to-use-pixmaps-gluing-images">
<span id="recipesimages-l"></span><span id="index-9"></span><h2>How to Use Pixmaps: Gluing Images<a class="headerlink" href="#how-to-use-pixmaps-gluing-images" title="Link to this heading">¶</a></h2>
<p>This shows how pixmaps can be used for purely graphical, non-document purposes. The script reads an image file and creates a new image which consist of 3 * 4 tiles of the original:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="s2">&quot;img-7edges.png&quot;</span><span class="p">)</span>      <span class="c1"># create pixmap from a picture</span>
<span class="n">col</span> <span class="o">=</span> <span class="mi">3</span>                                  <span class="c1"># tiles per row</span>
<span class="n">lin</span> <span class="o">=</span> <span class="mi">4</span>                                  <span class="c1"># tiles per column</span>
<span class="n">tar_w</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">col</span>                  <span class="c1"># width of target</span>
<span class="n">tar_h</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">lin</span>                 <span class="c1"># height of target</span>

<span class="c1"># create target pixmap</span>
<span class="n">tar_pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">colorspace</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tar_w</span><span class="p">,</span> <span class="n">tar_h</span><span class="p">),</span> <span class="n">src</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>

<span class="c1"># now fill target with the tiles</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lin</span><span class="p">):</span>
        <span class="n">src</span><span class="o">.</span><span class="n">set_origin</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">j</span><span class="p">)</span>
        <span class="n">tar_pix</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">irect</span><span class="p">)</span> <span class="c1"># copy input to new loc</span>

<span class="n">tar_pix</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;tar.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is the input picture:</p>
<a class="reference internal image-reference" href="_images/img-7edges.png"><img alt="_images/img-7edges.png" src="_images/img-7edges.png" style="width: 66.0px; height: 60.06px;" />
</a>
<p>Here is the output:</p>
<a class="reference internal image-reference" href="_images/img-target.png"><img alt="_images/img-target.png" src="_images/img-target.png" style="width: 198.0px; height: 240.24px;" />
</a>
<hr class="docutils" />
</section>
<section id="how-to-use-pixmaps-making-a-fractal">
<span id="recipesimages-m"></span><span id="index-10"></span><h2>How to Use Pixmaps: Making a Fractal<a class="headerlink" href="#how-to-use-pixmaps-making-a-fractal" title="Link to this heading">¶</a></h2>
<p>Here is another Pixmap example that creates <strong>Sierpinski’s Carpet</strong> – a fractal generalizing the <strong>Cantor Set</strong> to two dimensions. Given a square carpet, mark its 9 sub-suqares (3 times 3) and cut out the one in the center. Treat each of the remaining eight sub-squares in the same way, and continue <em>ad infinitum</em>. The end result is a set with area zero and fractal dimension 1.8928…</p>
<p>This script creates an approximate image of it as a PNG, by going down to one-pixel granularity. To increase the image precision, change the value of n (precision):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymupdf</span><span class="o">,</span> <span class="nn">time</span>
<span class="k">if</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">VersionBind</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)))</span> <span class="o">&gt;=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
    <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="s2">&quot;need PyMuPDF v1.14.8 for this script&quot;</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">6</span>                             <span class="c1"># depth (precision)</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">3</span><span class="o">**</span><span class="n">n</span>                          <span class="c1"># edge length</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">ir</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>                 <span class="c1"># the pixmap rectangle</span>

<span class="n">pm</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">csRGB</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">pm</span><span class="o">.</span><span class="n">set_rect</span><span class="p">(</span><span class="n">pm</span><span class="o">.</span><span class="n">irect</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="c1"># fill it with some background color</span>

<span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>               <span class="c1"># color to fill the punch holes</span>

<span class="c1"># alternatively, define a &#39;fill&#39; pixmap for the punch holes</span>
<span class="c1"># this could be anything, e.g. some photo image ...</span>
<span class="n">fill</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">csRGB</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="c1"># same size as &#39;pm&#39;</span>
<span class="n">fill</span><span class="o">.</span><span class="n">set_rect</span><span class="p">(</span><span class="n">fill</span><span class="o">.</span><span class="n">irect</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>   <span class="c1"># put some color in</span>

<span class="k">def</span> <span class="nf">punch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursively &quot;punch a hole&quot; in the central square of a pixmap.</span>

<span class="sd">    Arguments are top-left coords and the step width.</span>

<span class="sd">    Some alternative punching methods are commented out.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">step</span> <span class="o">//</span> <span class="mi">3</span>                 <span class="c1"># the new step</span>
    <span class="c1"># iterate through the 9 sub-squares</span>
    <span class="c1"># the central one will be filled with the color</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># this is not the central cube</span>
                <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>        <span class="c1"># recursing needed?</span>
                    <span class="n">punch</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">j</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>       <span class="c1"># recurse</span>
            <span class="k">else</span><span class="p">:</span>                 <span class="c1"># punching alternatives are:</span>
                <span class="n">pm</span><span class="o">.</span><span class="n">set_rect</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="p">),</span> <span class="n">color</span><span class="p">)</span>     <span class="c1"># fill with a color</span>
                <span class="c1">#pm.copy(fill, (x+s, y+s, x+2*s, y+2*s))  # copy from fill</span>
                <span class="c1">#pm.invert_irect((x+s, y+s, x+2*s, y+2*s))       # invert colors</span>

    <span class="k">return</span>

<span class="c1">#==============================================================================</span>
<span class="c1"># main program</span>
<span class="c1">#==============================================================================</span>
<span class="c1"># now start punching holes into the pixmap</span>
<span class="n">punch</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">pm</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;sierpinski-punch.png&quot;</span><span class="p">)</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%g</span><span class="s2"> sec to create / fill the pixmap&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">t1</span><span class="o">-</span><span class="n">t0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%g</span><span class="s2"> sec to save the image&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">t2</span><span class="o">-</span><span class="n">t1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p>The result should look something like this:</p>
<a class="reference internal image-reference" href="_images/img-sierpinski.png"><img alt="_images/img-sierpinski.png" src="_images/img-sierpinski.png" style="width: 240.57000000000002px; height: 240.57000000000002px;" />
</a>
<hr class="docutils" />
</section>
<section id="how-to-interface-with-numpy">
<span id="recipesimages-n"></span><h2>How to Interface with NumPy<a class="headerlink" href="#how-to-interface-with-numpy" title="Link to this heading">¶</a></h2>
<p>This shows how to create a PNG file from a numpy array (several times faster than most other methods):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pymupdf</span>
<span class="c1">#==============================================================================</span>
<span class="c1"># create a fun-colored width * height PNG with pymupdf and numpy</span>
<span class="c1">#==============================================================================</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">width</span>  <span class="o">=</span> <span class="mi">100</span>
<span class="n">bild</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
        <span class="c1"># one pixel (some fun coloring)</span>
        <span class="n">bild</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">256</span><span class="p">,</span> <span class="n">i</span><span class="o">%</span><span class="mi">256</span><span class="p">,</span> <span class="n">j</span><span class="o">%</span><span class="mi">256</span><span class="p">]</span>

<span class="n">samples</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">bild</span><span class="o">.</span><span class="n">tostring</span><span class="p">())</span>    <span class="c1"># get plain pixel data from numpy array</span>
<span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">csRGB</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pix</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<hr class="docutils" />
</section>
<section id="how-to-add-images-to-a-pdf-page">
<span id="recipesimages-o"></span><h2>How to Add Images to a PDF Page<a class="headerlink" href="#how-to-add-images-to-a-pdf-page" title="Link to this heading">¶</a></h2>
<p>There are two methods to add images to a PDF page: <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> and <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>. Both methods have things in common, but there are also differences.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Criterion</strong></p></th>
<th class="head"><p><a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a></p></th>
<th class="head"><p><a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>displayable content</p></td>
<td><p>image file, image in memory, pixmap</p></td>
<td><p>PDF page</p></td>
</tr>
<tr class="row-odd"><td><p>display resolution</p></td>
<td><p>image resolution</p></td>
<td><p>vectorized (except raster page content)</p></td>
</tr>
<tr class="row-even"><td><p>rotation</p></td>
<td><p>0, 90, 180 or 270 degrees</p></td>
<td><p>any angle</p></td>
</tr>
<tr class="row-odd"><td><p>clipping</p></td>
<td><p>no (full image only)</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-even"><td><p>keep aspect ratio</p></td>
<td><p>yes (default option)</p></td>
<td><p>yes (default option)</p></td>
</tr>
<tr class="row-odd"><td><p>transparency (water marking)</p></td>
<td><p>depends on the image</p></td>
<td><p>depends on the page</p></td>
</tr>
<tr class="row-even"><td><p>location / placement</p></td>
<td><p>scaled to fit target rectangle</p></td>
<td><p>scaled to fit target rectangle</p></td>
</tr>
<tr class="row-odd"><td><p>performance</p></td>
<td><p>automatic prevention of duplicates;</p></td>
<td><p>automatic prevention of duplicates;</p></td>
</tr>
<tr class="row-even"><td><p>multi-page image support</p></td>
<td><p>no</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>ease of use</p></td>
<td><p>simple, intuitive;</p></td>
<td><p>simple, intuitive;
<strong>usable for all document types</strong>
(including images!) after conversion to
PDF via <a class="reference internal" href="document.html#Document.convert_to_pdf" title="Document.convert_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<p>Basic code pattern for <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a>. <strong>Exactly one</strong> of the parameters <strong>filename / stream / pixmap</strong> must be given, if not re-inserting an existing image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">page</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span>
    <span class="n">rect</span><span class="p">,</span>                  <span class="c1"># where to place the image (rect-like)</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>         <span class="c1"># image in a file</span>
    <span class="n">stream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>           <span class="c1"># image in memory (bytes)</span>
    <span class="n">pixmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>           <span class="c1"># image from pixmap</span>
    <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>             <span class="c1"># specify alpha channel separately</span>
    <span class="n">rotate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>              <span class="c1"># rotate (int, multiple of 90)</span>
    <span class="n">xref</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>                <span class="c1"># re-use existing image</span>
    <span class="n">oc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>                  <span class="c1"># control visibility via OCG / OCMD</span>
    <span class="n">keep_proportion</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># keep aspect ratio</span>
    <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>          <span class="c1"># put in foreground</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Basic code pattern for <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>. Source and target PDF must be different <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> objects (but may be opened from the same file):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">page</span><span class="o">.</span><span class="n">show_pdf_page</span><span class="p">(</span>
    <span class="n">rect</span><span class="p">,</span>                  <span class="c1"># where to place the image (rect-like)</span>
    <span class="n">src</span><span class="p">,</span>                   <span class="c1"># source PDF</span>
    <span class="n">pno</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>                 <span class="c1"># page number in source PDF</span>
    <span class="n">clip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>             <span class="c1"># only display this area (rect-like)</span>
    <span class="n">rotate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>              <span class="c1"># rotate (float, any value)</span>
    <span class="n">oc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>                  <span class="c1"># control visibility via OCG / OCMD</span>
    <span class="n">keep_proportion</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># keep aspect ratio</span>
    <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>          <span class="c1"># put in foreground</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="how-to-use-pixmaps-checking-text-visibility">
<span id="recipesimages-p"></span><h2>How to Use Pixmaps: Checking Text Visibility<a class="headerlink" href="#how-to-use-pixmaps-checking-text-visibility" title="Link to this heading">¶</a></h2>
<p>Whether or not a given piece of text is actually visible on a page depends on a number of factors:</p>
<ol class="arabic simple">
<li><p>Text is not covered by another object but may have the same color as the background i.e., white-on-white etc.</p></li>
<li><p>Text may be covered by an image or vector graphics. Detecting this is an important capability, for example to uncover badly anonymized legal documents.</p></li>
<li><p>Text is created hidden. This technique is usually used by OCR tools to store the recognized text in an invisible layer on the page.</p></li>
</ol>
<p>The following shows how to detect situation 1. above, or situation 2. if the covering object is unicolor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pix</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_pixmap</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>  <span class="c1"># make page image with a decent resolution</span>

<span class="c1"># the following matrix transforms page to pixmap coordinates</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">torect</span><span class="p">(</span><span class="n">pix</span><span class="o">.</span><span class="n">irect</span><span class="p">)</span>

<span class="c1"># search for some string &quot;needle&quot;</span>
<span class="n">rlist</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">search_for</span><span class="p">(</span><span class="s2">&quot;needle&quot;</span><span class="p">)</span>
<span class="c1"># check the visibility for each hit rectangle</span>
<span class="k">for</span> <span class="n">rect</span> <span class="ow">in</span> <span class="n">rlist</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">color_topusage</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="n">rect</span> <span class="o">*</span> <span class="n">mat</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.95</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;needle&#39; is invisible here:&quot;</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
</pre></div>
</div>
<p>Method <a class="reference internal" href="pixmap.html#Pixmap.color_topusage" title="Pixmap.color_topusage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.color_topusage()</span></code></a> returns a tuple <code class="xref any docutils literal notranslate"><span class="pre">(ratio,</span> <span class="pre">pixel)</span></code> where 0 &lt; ratio &lt;= 1 and <em>pixel</em> is the pixel value of the color. Please note that we create a <strong>pixmap only once</strong>. This can save a lot of processing time if there are multiple hit rectangles.</p>
<p>The logic of the above code is: If the needle’s rectangle is (“almost”: &gt; 95%) unicolor, then the text cannot be visible. A typical result for visible text returns the color of the background (mostly white) and a ratio around 0.7 to 0.8, for example <code class="xref any docutils literal notranslate"><span class="pre">(0.685,</span> <span class="pre">b'xffxffxff')</span></code>.</p>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>Do you have any feedback on this page?</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.3.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="recipes-annotations.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Annotations</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="recipes-text.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Text</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 10. Mar 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Images</a><ul>
<li><a class="reference internal" href="#how-to-make-images-from-document-pages">How to Make Images from Document Pages</a></li>
<li><a class="reference internal" href="#how-to-increase-image-resolution">How to Increase Image Resolution</a></li>
<li><a class="reference internal" href="#how-to-create-partial-pixmaps-clips">How to Create Partial Pixmaps (Clips)</a></li>
<li><a class="reference internal" href="#how-to-zoom-a-clip-to-a-gui-window">How to Zoom a Clip to a GUI Window</a></li>
<li><a class="reference internal" href="#how-to-create-or-suppress-annotation-images">How to Create or Suppress Annotation Images</a></li>
<li><a class="reference internal" href="#how-to-extract-images-non-pdf-documents">How to Extract Images: Non-PDF Documents</a></li>
<li><a class="reference internal" href="#how-to-extract-images-pdf-documents">How to Extract Images: PDF Documents</a></li>
<li><a class="reference internal" href="#how-to-handle-image-masks">How to Handle Image Masks</a></li>
<li><a class="reference internal" href="#how-to-make-one-pdf-of-all-your-pictures-or-files">How to Make one PDF of all your Pictures (or Files)</a></li>
<li><a class="reference internal" href="#how-to-create-vector-images">How to Create Vector Images</a></li>
<li><a class="reference internal" href="#how-to-convert-images">How to Convert Images</a></li>
<li><a class="reference internal" href="#how-to-use-pixmaps-gluing-images">How to Use Pixmaps: Gluing Images</a></li>
<li><a class="reference internal" href="#how-to-use-pixmaps-making-a-fractal">How to Use Pixmaps: Making a Fractal</a></li>
<li><a class="reference internal" href="#how-to-interface-with-numpy">How to Interface with NumPy</a></li>
<li><a class="reference internal" href="#how-to-add-images-to-a-pdf-page">How to Add Images to a PDF Page</a></li>
<li><a class="reference internal" href="#how-to-use-pixmaps-checking-text-visibility">How to Use Pixmaps: Checking Text Visibility</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=9ddcf537"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    </body>
</html>